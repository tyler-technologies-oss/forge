import{C as B,j as k,B as W,l as S,a as F,m as w,k as tt,d as et,s as H,b as it,i as G,e as st}from"./constants-DzQy6WDX.js";import{B as z,c as r}from"./base-adapter-C8aSF3nG.js";import"./service-adapter-CffG5Lhq.js";import{c as b,j as E,D as M,r as q,n as lt,C as ot,t as N}from"./feature-detection-B-sRDmdg.js";import{I as nt,Q as rt,R as at,G as pt}from"./icon-kuXwuZAY.js";import{C as dt}from"./circular-progress-_RSm0FGC.js";import{W as ht,a as ct}from"./with-form-associated-DNJXxTFO.js";import{W as _t,a as ut}from"./with-default-aria-6GN_uk1I.js";import{W as bt}from"./with-label-aware-C7up74QW.js";import{B as _,F as c,a as mt}from"./base-field-BKF12k1t.js";import"./focus-indicator-Cy1dlEJL.js";import"./index-5CPwzmQS.js";import{I as ft}from"./icon-button-DGwaBkgs.js";import"./state-layer-gAgMwMHF.js";import{L as gt,a as At}from"./list-Dj0hUQkq.js";import{a as Lt,P as Et}from"./popover-BWVazmya.js";import"./overlay-B5pGv-rV.js";import{S as It}from"./scaffold-BrokB2Ba.js";import{T as Ot}from"./toolbar-U0axkpKl.js";import"./linear-progress-r0Hzg69v.js";import"./skeleton-BSiuL_ME.js";import{L as Ct,a as Y}from"./list-dropdown-aware-core-CVSDpfRx.js";import{d as yt,s as U}from"./utils-Bd6MGx91.js";import{a as St,L as Dt}from"./list-dropdown-DhvhGDaC.js";import{D as Tt}from"./divider-NNdF1g4c.js";function vt(l){class t extends l{constructor(...i){super(...i)}initializeFieldInstance(i){this._fieldElement=i,this._fieldElement.shadowRoot||window.customElements.upgrade(this._fieldElement)}attributeChangedCallback(i,s,n){switch(i){case _.observedAttributes.LABEL_POSITION:this.labelPosition=n;return;case _.observedAttributes.LABEL_ALIGNMENT:this.labelAlignment=n;return;case _.observedAttributes.INVALID:this.invalid=b(n);return;case _.observedAttributes.REQUIRED:this.required=b(n);return;case _.observedAttributes.OPTIONAL:this.optional=b(n);return;case _.observedAttributes.DISABLED:this.disabled=b(n);return;case _.observedAttributes.FLOAT_LABEL:this.floatLabel=b(n);return;case _.observedAttributes.VARIANT:this.variant=n;return;case _.observedAttributes.THEME:this.theme=n;return;case _.observedAttributes.SHAPE:this.shape=n;return;case _.observedAttributes.DENSITY:this.density=n;return;case _.observedAttributes.DENSE:this.dense=b(n);return;case _.observedAttributes.POPOVER_ICON:this.popoverIcon=b(n);return;case _.observedAttributes.SUPPORT_TEXT_INSET:this.supportTextInset=n;return}super.attributeChangedCallback?.(i,s,n)}get labelPosition(){return this._fieldElement.labelPosition}set labelPosition(i){this._fieldElement.labelPosition!==i&&(this._fieldElement.labelPosition=i,this.setAttribute(c.attributes.LABEL_POSITION,i))}get labelAlignment(){return this._fieldElement.labelAlignment}set labelAlignment(i){this._fieldElement.labelAlignment!==i&&(this._fieldElement.labelAlignment=i,this.setAttribute(c.attributes.LABEL_ALIGNMENT,i))}get invalid(){return this._fieldElement.invalid}set invalid(i){this._fieldElement.invalid!==i&&(this._fieldElement.invalid=i,this.toggleAttribute(c.attributes.INVALID,i))}get required(){return this._fieldElement.required}set required(i){this._fieldElement.required!==i&&(this._fieldElement.required=i,this.toggleAttribute(c.attributes.REQUIRED,i))}get optional(){return this._fieldElement.optional}set optional(i){this._fieldElement.optional!==i&&(this._fieldElement.optional=i,this.toggleAttribute(c.attributes.OPTIONAL,i))}get disabled(){return this._fieldElement.disabled}set disabled(i){this._fieldElement.disabled!==i&&(this._fieldElement.disabled=i,this.toggleAttribute(c.attributes.DISABLED,i))}get floatLabel(){return this._fieldElement.floatLabel}set floatLabel(i){this._fieldElement.floatLabel!==i&&(this._fieldElement.floatLabel=i,this.toggleAttribute(c.attributes.FLOAT_LABEL,i))}get variant(){return this._fieldElement.variant}set variant(i){this._fieldElement.variant!==i&&(this._fieldElement.variant=i,this.setAttribute(c.attributes.VARIANT,i))}get theme(){return this._fieldElement.theme}set theme(i){this._fieldElement.theme!==i&&(this._fieldElement.theme=i,this.setAttribute(c.attributes.THEME,i))}get shape(){return this._fieldElement.shape}set shape(i){this._fieldElement.shape!==i&&(this._fieldElement.shape=i,this.setAttribute(c.attributes.SHAPE,i))}get density(){return this._fieldElement.density}set density(i){this._fieldElement.density!==i&&(this._fieldElement.density=i,this.setAttribute(c.attributes.DENSITY,i))}get dense(){return this._fieldElement.dense}set dense(i){this._fieldElement.dense!==i&&(this._fieldElement.dense=i,this.toggleAttribute(c.attributes.DENSE,i))}get popoverIcon(){return this._fieldElement.popoverIcon}set popoverIcon(i){this._fieldElement.popoverIcon!==i&&(this._fieldElement.popoverIcon=i,this.toggleAttribute(c.attributes.POPOVER_ICON,i))}get supportTextInset(){return this._fieldElement.supportTextInset}set supportTextInset(i){this._fieldElement.supportTextInset!==i&&(this._fieldElement.supportTextInset=i,this.setAttribute(c.attributes.SUPPORT_TEXT_INSET,i))}floatLabelWithoutAnimation(i){this._fieldElement.floatLabelWithoutAnimation(i)}}return t}class Nt extends z{constructor(t){super(t)}}const $=`${B}option`,wt={DISABLED:"disabled",DIVIDER:"divider",LABEL:"label",SECONDARY_LABEL:"secondary-label",LEADING_ICON_CLASS:"leading-icon-class",LEADING_ICON_TYPE:"leading-icon-type",LEADING_ICON:"leading-icon",OPTION_CLASS:"option-class",TRAILING_ICON_CLASS:"trailing-icon-class",TRAILING_ICON_TYPE:"trailing-icon-type",TRAILING_ICON:"trailing-icon",TOOLTIP:"tooltip",VALUE:"value"},Pt={VALUE_CHANGE:`${$}-value-change`},o={elementName:$,attributes:wt,events:Pt};class xt{constructor(t){this._adapter=t,this._disabled=!1,this._divider=!1,this._optionClass=[]}get value(){return this._value}set value(t){this._value!==t&&(this._value=t,this._adapter.emitHostEvent(o.events.VALUE_CHANGE,this._value))}get label(){return this._label}set label(t){this._label!==t&&(this._label=t,this._adapter.toggleHostAttribute(o.attributes.LABEL,!!this._label,this._label))}get secondaryLabel(){return this._secondaryLabel}set secondaryLabel(t){this._secondaryLabel!==t&&(this._secondaryLabel=t,this._adapter.toggleHostAttribute(o.attributes.SECONDARY_LABEL,!!this._secondaryLabel,this._secondaryLabel))}get disabled(){return this._disabled}set disabled(t){this._disabled!==t&&(this._disabled=t,this._adapter.toggleHostAttribute(o.attributes.DISABLED,this._disabled))}get divider(){return this._divider}set divider(t){this._divider!==t&&(this._divider=t,this._adapter.toggleHostAttribute(o.attributes.DIVIDER,this._divider))}get optionClass(){return this._optionClass}set optionClass(t){t?typeof t=="string"&&(t=t.split(" ")):t=[],t=t.filter(e=>e&&!/\s+/.test(e)),this._optionClass.toString()!==t.toString()&&(this._optionClass=t,this._adapter.toggleHostAttribute(o.attributes.OPTION_CLASS,this._optionClass&&!!this._optionClass.length,this._optionClass.join(" ")))}get leadingIcon(){return this._leadingIcon}set leadingIcon(t){this._leadingIcon!==t&&(this._leadingIcon=t,this._adapter.toggleHostAttribute(o.attributes.LEADING_ICON,!!this._leadingIcon,this._leadingIcon))}get leadingIconClass(){return this._leadingIconClass}set leadingIconClass(t){this._leadingIconClass!==t&&(this._leadingIconClass=t,this._adapter.toggleHostAttribute(o.attributes.LEADING_ICON_CLASS,!!this._leadingIconClass,this._leadingIconClass))}get leadingIconType(){return this._leadingIconType}set leadingIconType(t){this._leadingIconType!==t&&(this._leadingIconType=t,this._adapter.toggleHostAttribute(o.attributes.LEADING_ICON_TYPE,!!this._leadingIconType,this._leadingIconType))}get leadingIconComponentProps(){return this._leadingIconComponentProps}set leadingIconComponentProps(t){this._leadingIconComponentProps!==t&&(this._leadingIconComponentProps=t)}get trailingIcon(){return this._trailingIcon}set trailingIcon(t){this._trailingIcon!==t&&(this._trailingIcon=t,this._adapter.toggleHostAttribute(o.attributes.TRAILING_ICON,!!this._trailingIcon,this._trailingIcon))}get trailingIconClass(){return this._trailingIconClass}set trailingIconClass(t){this._trailingIconClass!==t&&(this._trailingIconClass=t,this._adapter.toggleHostAttribute(o.attributes.TRAILING_ICON_CLASS,!!this._trailingIconClass,this._trailingIconClass))}get trailingIconType(){return this._trailingIconType}set trailingIconType(t){this._trailingIconType!==t&&(this._trailingIconType=t,this._adapter.toggleHostAttribute(o.attributes.TRAILING_ICON_TYPE,!!this._trailingIconType,this._trailingIconType))}get trailingIconComponentProps(){return this._trailingIconComponentProps}set trailingIconComponentProps(t){this._trailingIconComponentProps!==t&&(this._trailingIconComponentProps=t)}get leadingBuilder(){return this._leadingBuilder}set leadingBuilder(t){this._leadingBuilder!==t&&(this._leadingBuilder=t)}get trailingBuilder(){return this._trailingBuilder}set trailingBuilder(t){this._trailingBuilder!==t&&(this._trailingBuilder=t)}get tooltip(){return this._tooltip}set tooltip(t){this._tooltip!==t&&(this._tooltip=t)}}var Bt=Object.defineProperty,kt=Object.getOwnPropertyDescriptor,h=(l,t,e,i)=>{for(var s=i>1?void 0:i?kt(t,e):t,n=l.length-1,a;n>=0;n--)(a=l[n])&&(s=(i?a(t,e,s):a(s))||s);return i&&s&&Bt(t,e,s),s};let p=class extends W{static get observedAttributes(){return[o.attributes.VALUE,o.attributes.LABEL,o.attributes.SECONDARY_LABEL,o.attributes.DISABLED,o.attributes.DIVIDER,o.attributes.OPTION_CLASS,o.attributes.LEADING_ICON,o.attributes.LEADING_ICON_CLASS,o.attributes.LEADING_ICON_TYPE,o.attributes.TRAILING_ICON,o.attributes.TRAILING_ICON_CLASS,o.attributes.TRAILING_ICON_TYPE,o.attributes.TOOLTIP]}constructor(){super(),this._core=new xt(new Nt(this))}attributeChangedCallback(l,t,e){switch(l){case o.attributes.VALUE:this.value=e;break;case o.attributes.LABEL:this.label=e;break;case o.attributes.SECONDARY_LABEL:this.secondaryLabel=e;break;case o.attributes.DISABLED:this.disabled=b(e);break;case o.attributes.DIVIDER:this.divider=this.hasAttribute(o.attributes.DIVIDER);break;case o.attributes.OPTION_CLASS:this.optionClass=e;break;case o.attributes.LEADING_ICON:this.leadingIcon=e;break;case o.attributes.LEADING_ICON_CLASS:this.leadingIconClass=e;break;case o.attributes.LEADING_ICON_TYPE:this.leadingIconType=e;break;case o.attributes.TRAILING_ICON:this.trailingIcon=e;break;case o.attributes.TRAILING_ICON_CLASS:this.trailingIconClass=e;break;case o.attributes.TRAILING_ICON_TYPE:this.trailingIconType=e;break;case o.attributes.TOOLTIP:this.tooltip=e?{text:e}:void 0;break}}};h([r()],p.prototype,"value",2);h([r()],p.prototype,"label",2);h([r()],p.prototype,"secondaryLabel",2);h([r()],p.prototype,"disabled",2);h([r()],p.prototype,"divider",2);h([r()],p.prototype,"optionClass",2);h([r()],p.prototype,"leadingIcon",2);h([r()],p.prototype,"leadingIconClass",2);h([r()],p.prototype,"leadingIconType",2);h([r()],p.prototype,"leadingIconComponentProps",2);h([r()],p.prototype,"trailingIcon",2);h([r()],p.prototype,"trailingIconClass",2);h([r()],p.prototype,"trailingIconType",2);h([r()],p.prototype,"trailingIconComponentProps",2);h([r()],p.prototype,"leadingBuilder",2);h([r()],p.prototype,"trailingBuilder",2);h([r()],p.prototype,"tooltip",2);p=h([k({name:o.elementName})],p);const Rt=`${B}option-group`,Vt={LABEL:"label"},L={elementName:Rt,attributes:Vt};var Ft=Object.getOwnPropertyDescriptor,Ht=(l,t,e,i)=>{for(var s=i>1?void 0:i?Ft(t,e):t,n=l.length-1,a;n>=0;n--)(a=l[n])&&(s=a(s)||s);return s};let P=class extends W{static get observedAttributes(){return[L.attributes.LABEL]}constructor(){super()}attributeChangedCallback(l,t,e){switch(l){case L.attributes.LABEL:this.label=e;break}}get label(){return this._label}set label(l){this._label!==l&&(this._label=l||"",this.setAttribute(L.attributes.LABEL,this._label))}get text(){return this._label}set text(l){this.label=l}};P=Ht([k({name:L.elementName})],P);var x=(l=>(l[l.Option=0]="Option",l[l.Group=1]="Group",l))(x||{});function j(l,t){const e=l.some(s=>K(s)),i=l.some(s=>Gt(s));return e&&t===1||i&&t===0}function K(l){return E(l)&&M(l)&&Object.prototype.hasOwnProperty.call(l,"options")}function Gt(l){return E(l)&&M(l)&&Object.prototype.hasOwnProperty.call(l,"label")&&Object.prototype.hasOwnProperty.call(l,"value")}class qt extends z{constructor(t){super(t)}get popupElement(){return this._listDropdown?.dropdownElement}getOptions(){const t=Array.from(this._component.querySelectorAll(L.elementName));if(t.length)return t.map(e=>{const i=Array.from(e.querySelectorAll(o.elementName)),s=this._createOptionsFromElements(i);return{text:e.label,builder:e.builder,value:e.value,options:s}});{const e=Array.from(this._component.querySelectorAll(o.elementName));return this._createOptionsFromElements(e)}}_createOptionsFromElements(t){return t.map(e=>{let i=e.hasAttribute(o.attributes.OPTION_CLASS)?e.getAttribute(o.attributes.OPTION_CLASS):e.optionClass;return typeof i=="string"&&(i=i.split(" ")),{label:e.hasAttribute(o.attributes.LABEL)?e.getAttribute(o.attributes.LABEL):E(e.label)?e.label:e.innerText,secondaryLabel:e.hasAttribute(o.attributes.SECONDARY_LABEL)?e.getAttribute(o.attributes.SECONDARY_LABEL):E(e.secondaryLabel)?e.secondaryLabel:void 0,value:e.hasAttribute(o.attributes.VALUE)?e.getAttribute(o.attributes.VALUE):e.value,disabled:e.hasAttribute(o.attributes.DISABLED),divider:e.hasAttribute(o.attributes.DIVIDER),optionClass:i,leadingIcon:e.hasAttribute(o.attributes.LEADING_ICON)?e.getAttribute(o.attributes.LEADING_ICON):e.leadingIcon,leadingIconClass:e.hasAttribute(o.attributes.LEADING_ICON_CLASS)?e.getAttribute(o.attributes.LEADING_ICON_CLASS):e.leadingIconClass,leadingIconType:e.hasAttribute(o.attributes.LEADING_ICON_TYPE)?e.getAttribute(o.attributes.LEADING_ICON_TYPE):e.leadingIconType,leadingIconComponentProps:e.leadingIconComponentProps,trailingIcon:e.hasAttribute(o.attributes.TRAILING_ICON)?e.getAttribute(o.attributes.TRAILING_ICON):e.trailingIcon,trailingIconClass:e.hasAttribute(o.attributes.TRAILING_ICON_CLASS)?e.getAttribute(o.attributes.TRAILING_ICON_CLASS):e.trailingIconClass,trailingIconType:e.hasAttribute(o.attributes.TRAILING_ICON_TYPE)?e.getAttribute(o.attributes.TRAILING_ICON_TYPE):e.trailingIconType,trailingIconComponentProps:e.trailingIconComponentProps,leadingBuilder:e.leadingBuilder,trailingBuilder:e.trailingBuilder,tooltip:e.tooltip}})}open(t){this._listDropdown=new St(this._targetElement,t),this._listDropdown.open(),this._component.id&&this._listDropdown.dropdownElement?.querySelector("forge-list")?.setAttribute("aria-labelledby",this._component.id)}async close(){this._listDropdown&&(await this._listDropdown.close(),this.destroyListDropdown())}destroyListDropdown(){this._listDropdown?.destroy(),this._listDropdown=void 0}setDismissListener(t){!this._listDropdown||!this._listDropdown.dropdownElement||this._listDropdown.dropdownElement.addEventListener(Lt.events.TOGGLE,t)}toggleOptionMultiple(t,e){this._listDropdown?.toggleOptionMultiple(t,e)}getActiveOptionIndex(){return this._listDropdown?.getActiveOptionIndex()??-1}activateSelectedOption(){this._listDropdown?.activateSelectedOption()}activateFirstOption(){this._listDropdown?.activateFirstOption()}highlightActiveOption(t){this._listDropdown?.activateOption(t)}patchSelectedValues(t){this._listDropdown?.setSelectedValues(t)}setOptionsListener(t){const e=s=>{s.stopPropagation(),t(this.getOptions())};this._component.addEventListener(o.events.VALUE_CHANGE,e);const i=new MutationObserver(()=>t(this.getOptions()));return i.observe(this._component,{childList:!0,subtree:!0}),()=>{this._component.removeEventListener(o.events.VALUE_CHANGE,e),i.disconnect()}}setOptions(t,e=!0){e&&this._clearOptions();for(const i of t)if(K(i)){const s=this._createOptionGroupElement(i);for(const n of i.options){const a=this._createOptionElement(n);s.appendChild(a)}this._component.appendChild(s)}else{const s=this._createOptionElement(i);this._component.appendChild(s)}}appendDropdownOptions(t){this._listDropdown?.appendOptions(t)}setDropdownOptions(t){this._listDropdown?.setOptions(t)}scrollSelectedOptionIntoView(){this._listDropdown?.scrollSelectedOptionIntoView()}isFocusWithinPopup(t){return!this._listDropdown||!this._listDropdown.dropdownElement?!1:this._listDropdown.dropdownElement.contains(t)}queueDropdownPositionUpdate(){this.popupElement&&window.requestAnimationFrame(()=>{this.popupElement?.position()})}_clearOptions(){Array.from(this._component.querySelectorAll(L.elementName)).forEach(i=>q(i)),Array.from(this._component.querySelectorAll(o.elementName)).forEach(i=>q(i))}_createOptionGroupElement(t){const e=document.createElement("forge-option-group");return Object.assign(e,t),e}_createOptionElement(t){const e=document.createElement("forge-option");return Object.assign(e,t),e.textContent=t.label,t.elementAttributes&&t.elementAttributes.forEach((i,s)=>{e.setAttribute(s,i)}),e}}const X={VALUE:"value",MULTIPLE:"multiple",OBSERVE_SCROLL:"observe-scroll",OBSERVE_SCROLL_THRESHOLD:"observe-scroll-threshold",POPUP_CLASSES:"popup-classes",OPTION_LIMIT:"option-limit",SYNC_POPUP_WIDTH:"sync-popup-width",CONSTRAIN_POPUP_WIDTH:"constrain-popup-width",WRAP_OPTION_TEXT:"wrap-option-text"},Ut={...X},jt={CHANGE:"change"},C={observedAttributes:X,attributes:Ut,events:jt};class Wt extends Ct{constructor(t){super(),this._adapter=t,this._options=[],this._value=[],this._multiple=!1,this._open=!1,this._showSelectAll=!1,this._selectedValues=[],this._selectedLabels=[],this._selectedIndexes=[],this._filterString="",this._focusListener=e=>this._onFocus(e),this._blurListener=e=>this._onBlur(e),this._clickListener=e=>this._onClick(e),this._keydownListener=e=>this._onKeydown(e),this._optionsChangedListener=e=>this._onOptionsChanged(e),this._activeChangeListener=e=>this._onActiveOptionChanged(e),this._dropdownScrollEndListener=()=>this._onDropdownScrollEnd(),this._dismissListener=()=>this._onDismiss(),this._identifier=lt()}_onFocus(t){}_onSelectAll(){if(!this._multiple)return;const e=!(this._selectedValues.length===this._nonDividerOptions.length),i=e?this._nonDividerOptions.map(n=>n.value):[];if(!!this._adapter.emitHostEvent("forge-select-all",{value:i,isAllSelected:e},!0,!0)){e?this.selectAll():this.deselectAll();const n=this._multiple?[...this._selectedValues]:this._selectedValues[0];if(this._adapter.emitHostEvent(C.events.CHANGE,n,!0,!0),this._open){const a=this._adapter.getActiveOptionIndex();this._adapter.patchSelectedValues(this._selectedValues),this._updateSelectAllState(),a>=0&&this._adapter.highlightActiveOption(a)}}}_updateSelectAllState(){if(!this._showSelectAll||!this._multiple||!this._open)return;const t=this._selectedValues.length===this._nonDividerOptions.length;this._adapter.toggleOptionMultiple(0,t)}initialize(){this._optionListenerDestructor&&this._optionListenerDestructor(),this._optionListenerDestructor=this._adapter.setOptionsListener(this._optionsChangedListener),this._initializeValue()}initializeTarget(){this._adapter.initializeAccessibility(),this._adapter.addClickListener(this._clickListener),this._adapter.addTargetListener("blur",this._blurListener),this._adapter.addTargetListener("focus",this._focusListener),this._adapter.addTargetListener("keydown",this._keydownListener)}destroy(){this._adapter.removeClickListener(this._clickListener),this._adapter.removeTargetListener("blur",this._blurListener),this._adapter.removeTargetListener("focus",this._focusListener),this._adapter.removeTargetListener("keydown",this._keydownListener),this._optionListenerDestructor&&this._optionListenerDestructor(),this._open=!1,this._adapter.destroyListDropdown()}appendOptions(t){this._adapter.setOptions(t,!1),this._open&&this._adapter.appendDropdownOptions(t)}selectAll(){this._multiple&&(this.value=this._flatOptions.map(t=>t.value))}deselectAll(){this._multiple&&(this.value=[])}get _flatOptions(){return j(this._options,x.Group)?this._options.flatMap(t=>t.options):this._options}get _nonDividerOptions(){return this._flatOptions.filter(t=>!t.divider)}_adjustIndexFromDropdown(t){return this._showSelectAll&&this._multiple&&t>0?t-1:t}_adjustIndexToDropdown(t){return this._showSelectAll&&this._multiple?t+1:t}_initializeValue(){const t=this._options.length&&this._options||this._adapter.getOptions();E(this._value)&&t.length&&this._applyValue(this._value)}_onClick(t){t.button===0&&(this._open?this._closeDropdown():this._openDropdown())}_onBlur(t){this._adapter.isFocusWithinPopup(t.relatedTarget)||this._open&&this._closeDropdown()}_openDropdown(){if(this._options=this._adapter.getOptions(),!this._flatOptions.length)return;this._open=!0;const t={options:this._options,referenceElement:this._adapter.hostElement,multiple:this._multiple,selectedValues:[...this._selectedValues],id:this._identifier,optionBuilder:this._optionBuilder,syncWidth:this._syncPopupWidth,constrainViewportWidth:this._constrainPopupWidth,wrapOptionText:this._wrapOptionText,observeScroll:this._observeScroll,observeScrollThreshold:this._observeScrollThreshold,scrollEndListener:this._dropdownScrollEndListener,activeChangeCallback:this._activeChangeListener,targetWidthCallback:this._targetWidthCallback,popupPlacement:this._popoverPlacement,popupOffset:this._popoverOffset,popupFlip:this._popoverFlip,popupShift:this._popoverShift,popupFallbackPlacements:this._popoverFallbackPlacements,popupClasses:this._popupClasses,optionLimit:this._optionLimit,headerBuilder:this._popupHeaderBuilder,footerBuilder:this._popupFooterBuilder,showSelectAll:this._showSelectAll&&this._multiple,selectAllLabel:this._selectAllLabel,closeCallback:()=>this._closeDropdown(),selectCallback:e=>{if(e===Dt.selectAllOption.VALUE){this._onSelectAll();return}const i=this._flatOptions,s=i.find(n=>n.value===e);if(s){const n=i.indexOf(s);this._onSelect(s,n,!0)}}};this._adapter.open(t),this._adapter.setDismissListener(this._dismissListener),this._updateSelectAllState()}_closeDropdown(){this._open=!1,this._adapter.close()}async _onSelect(t,e,i=!0){if(this._valueChanging)return!1;const s=t?t.value:"",n=t?t.label:"",a=[...this._value],y=[...this._selectedValues],D=[...this._selectedLabels],T=[...this._selectedIndexes];if(this._multiple)if(this._selectedValues.includes(s)){const g=this._selectedValues.indexOf(s);this._selectedValues.splice(g,1),this._selectedLabels.splice(g,1),this._selectedIndexes.splice(g,1)}else this._selectedValues.push(s),this._selectedLabels.push(n),this._selectedIndexes.push(e);else E(s)?(this._selectedValues[0]=s,this._selectedLabels[0]=n,this._selectedIndexes[0]=e):(this._selectedValues=[],this._selectedLabels=[],this._selectedIndexes=[]);this._value=[...this._selectedValues];const v=()=>{this._selectedValues=[...y],this._selectedLabels=[...D],this._selectedIndexes=[...T],this._value=[...a]},d=()=>{if(this._multiple){const g=this._selectedIndexes.includes(e),Z=this._adjustIndexToDropdown(e);if(this._adapter.toggleOptionMultiple(Z,g),this._showSelectAll&&this._open){const V=this._adapter.getActiveOptionIndex();this._updateSelectAllState(),V>=0&&this._adapter.highlightActiveOption(V)}}this._applySelection()},O=this.multiple?[...this._selectedValues]:this._selectedValues[0];if(this._open&&i&&!this._multiple&&this._closeDropdown(),typeof this._beforeValueChange=="function"){this._valueChanging=Promise.resolve(this._beforeValueChange.call(null,O));const g=await this._valueChanging;if(this._valueChanging=void 0,!g)return v(),this._tryUpdateDropdownPosition(),!1}const R=!this._adapter.emitHostEvent(C.events.CHANGE,O,!0,!0);return R?v():d(),this._tryUpdateDropdownPosition(),!R}_selectActiveOption(){const t=this._adapter.getActiveOptionIndex();if(t>=0){if(this._showSelectAll&&this._multiple&&t===0){this._onSelectAll();return}const e=this._adjustIndexFromDropdown(t);this._nonDividerOptions[e]&&this._onSelect(this._nonDividerOptions[e],e)}}_tryUpdateDropdownPosition(){this._open&&this._adapter.queueDropdownPositionUpdate()}_reset(){this._selectedValues=[],this._selectedLabels=[],this._selectedIndexes=[]}_applyValue(t){this._selectedValues=[],this._selectedLabels=[],this._options=this._adapter.getOptions(),Array.isArray(t)||(t=[t]),this._value=[];for(const e of t){this._value.includes(e)||this._value.push(e);const i=this._flatOptions.find(s=>ot(s.value,e));i&&(this._selectedValues.push(i.value),this._selectedLabels.push(i.label))}this._selectedIndexes=this._selectedValues.map(e=>this._flatOptions.findIndex(i=>i.value===e)),this._adapter.patchSelectedValues(this._selectedValues)}_onDismiss(){this._closeDropdown()}_getSelectedText(){if(typeof this._selectedTextBuilder=="function"){const t=this._flatOptions.filter(e=>this._selectedValues.includes(e.value));return this._selectedTextBuilder(t)}return this._multiple?this._selectedLabels.length?this._selectedLabels.length===1?this._selectedLabels[0]:`${this._selectedLabels.length} options selected`:"":this._selectedLabels.filter(t=>t&&t.length).join(" ").trim()}_onKeydown(t){const e=t.key==="Escape"||t.keyCode===27,i=t.key==="Enter"||t.keyCode===13,s=t.key==="Space"||t.keyCode===32,n=t.key==="ArrowDown"||t.keyCode===40,a=t.key==="ArrowUp"||t.keyCode===38,y=t.keyCode>=48&&t.keyCode<=90,D=t.key==="Home"||t.keyCode===36,T=t.key==="End"||t.keyCode===35;if(t.key==="Tab"&&this._open&&!this._multiple){this._selectActiveOption();return}if(!y&&this._filterTimeout&&(window.clearTimeout(this._filterTimeout),this._filterString="",this._filterTimeout=void 0),e&&(t.preventDefault(),t.stopPropagation(),this._open)){this._closeDropdown();return}if(s)t.preventDefault(),t.stopPropagation(),this._open?this._closeDropdown():this._openDropdown();else if(i)this._open&&(t.stopPropagation(),t.preventDefault(),this._options=this._adapter.getOptions(),this._selectActiveOption());else if(a||n){if(t.preventDefault(),!this._open){this._openDropdown(),this._adapter.activateFirstOption();return}if(this._flatOptions.length===0)return;let d=0;if(this._open)d=this._adapter.getActiveOptionIndex(),d===-1?a?d=this._getLastHighlightableDropdownIndex():d=this._getFirstHighlightableDropdownIndex():a?d=this._getPreviousHighlightableDropdownIndex(d):d=this._getNextHighlightableDropdownIndex(d);else{const O=this._getFirstSelectedOptionIndex();d=O>=0?this._adjustIndexToDropdown(O):0}this._adapter.highlightActiveOption(d)}else if(D){if(this._open){t.preventDefault();const d=this._getFirstHighlightableDropdownIndex();d>=0&&this._adapter.highlightActiveOption(d)}}else if(T){if(this._open){t.preventDefault();const d=this._getLastHighlightableDropdownIndex();d>=0&&this._adapter.highlightActiveOption(d)}}else y&&this._filter(t.key)}_getFirstSelectedOptionIndex(){return this._nonDividerOptions.findIndex(t=>this._selectedValues.includes(t.value))}_getPreviousHighlightableDropdownIndex(t){if(!this._adapter.popupElement)return t;const e=this._adapter.popupElement.querySelectorAll("forge-list-item"),i=e.length;if(i===0)return t;let s=t;do{s<=0?s=i-1:s--;const n=e[s];if(n&&!this._isDropdownOptionDisabled(n))return s}while(s!==t);return t}_getNextHighlightableDropdownIndex(t){if(!this._adapter.popupElement)return t;const e=this._adapter.popupElement.querySelectorAll("forge-list-item"),i=e.length;if(i===0)return t;let s=t;do{s===i-1?s=0:s++;const n=e[s];if(n&&!this._isDropdownOptionDisabled(n))return s}while(s!==t);return t}_getFirstHighlightableDropdownIndex(){if(!this._adapter.popupElement)return 0;const t=this._adapter.popupElement.querySelectorAll("forge-list-item");for(let e=0;e<t.length;e++){const i=t[e];if(i&&!this._isDropdownOptionDisabled(i))return e}return 0}_getLastHighlightableDropdownIndex(){if(!this._adapter.popupElement)return 0;const t=this._adapter.popupElement.querySelectorAll("forge-list-item");for(let e=t.length-1;e>=0;e--){const i=t[e];if(i&&!this._isDropdownOptionDisabled(i))return e}return 0}_isDropdownOptionDisabled(t){if(t.querySelector&&t.querySelector("forge-divider"))return!0;const e=t.querySelector("button");return!!(e&&e.disabled)}_filter(t){this._filterTimeout&&(window.clearTimeout(this._filterTimeout),this._filterTimeout=void 0),this._filterString+=t,this._filterTimeout=window.setTimeout(()=>{this._filterString="",this._filterTimeout=void 0},300),this._options=this._adapter.getOptions();const e=this._flatOptions.find(({disabled:i,label:s})=>!i&&s.trim().toLowerCase().startsWith(this._filterString.trim().toLowerCase()));if(e){const i=this._flatOptions.indexOf(e);this._open?this._adapter.highlightActiveOption(i):this._multiple||this._onSelect(e,i,!1)}}_onOptionsChanged(t){this._options=t,this._applyValue(this._value)}_onActiveOptionChanged(t){this._adapter.updateActiveDescendant(t)}get value(){return this._multiple?[...this._value]:this._value[0]}set value(t){let e;Array.isArray(t)?e=[...t]:e=t,this._applyValue(e)}get selectedIndex(){return this._multiple?[...this._selectedIndexes]:this._selectedIndexes[0]}set selectedIndex(t){this._options=this._adapter.getOptions();let e;if(Array.isArray(t)?e=[...t]:e=[t],e.sort(),this.multiple)this.value=e.map(i=>this._flatOptions[i]).filter(i=>i).map(i=>i.value);else{const i=this._flatOptions[e[e.length-1]];if(!i)return;this.value=i.value}}get options(){return this._adapter.getOptions()}set options(t){let e;j(t,x.Group)?e=t.map(i=>({...i})):e=t.map(i=>({...i})),this._options=e,this._adapter.setOptions(e),this._initializeValue(),this._open&&this._adapter.setDropdownOptions(e)}get multiple(){return this._multiple}set multiple(t){this._multiple!==t&&(this._multiple=t,this._reset(),this._open&&this._closeDropdown())}get open(){return this._open}set open(t){this._open!==t&&(t?this._openDropdown():this._closeDropdown())}get optionBuilder(){return this._optionBuilder}set optionBuilder(t){this._optionBuilder=t}get selectedTextBuilder(){return this._selectedTextBuilder}set selectedTextBuilder(t){this._selectedTextBuilder=t}get optionLimit(){return this._optionLimit}set optionLimit(t){this._optionLimit=t}get popupClasses(){return this._popupClasses}set popupClasses(t){this._popupClasses=t}get popupHeaderBuilder(){return this._popupHeaderBuilder}set popupHeaderBuilder(t){this._popupHeaderBuilder=t}get popupFooterBuilder(){return this._popupFooterBuilder}set popupFooterBuilder(t){this._popupFooterBuilder=t}get popupElement(){return this._adapter.popupElement}get beforeValueChange(){return this._beforeValueChange}set beforeValueChange(t){this._beforeValueChange=t}get showSelectAll(){return this._showSelectAll}set showSelectAll(t){this._showSelectAll=t}get selectAllLabel(){return this._selectAllLabel}set selectAllLabel(t){this._selectAllLabel=t}}var zt=Object.defineProperty,f=(l,t,e,i)=>{for(var s=void 0,n=l.length-1,a;n>=0;n--)(a=l[n])&&(s=a(t,e,s)||s);return s&&zt(t,e,s),s};class m extends Y{constructor(){super()}attributeChangedCallback(t,e,i){switch(super.attributeChangedCallback(t,e,i),t){case C.attributes.MULTIPLE:this.multiple=b(i);break;case C.attributes.VALUE:this.value=i;break}}appendOptions(t){this._core.appendOptions(t)}selectAll(){this._core.selectAll()}deselectAll(){this._core.deselectAll()}connectedCallback(){this._core.initialize()}disconnectedCallback(){this._core.destroy()}}f([r()],m.prototype,"value");f([r()],m.prototype,"selectedIndex");f([r()],m.prototype,"options");f([r()],m.prototype,"multiple");f([r()],m.prototype,"open");f([r()],m.prototype,"optionBuilder");f([r()],m.prototype,"selectedTextBuilder");f([r()],m.prototype,"beforeValueChange");f([r({set:!1})],m.prototype,"popupElement");const Q=`${B}select`,Mt={FIELD:"#field",SELECTED_TEXT:"#selected-text",LABEL:"#select-label"},J={OPEN:"open",TYPE:"type",VALUE:"value",LABEL:"label",MULTIPLE:"multiple",DISABLED:"disabled",PLACEHOLDER:"placeholder",OBSERVE_SCROLL:"observe-scroll",OBSERVE_SCROLL_THRESHOLD:"observe-scroll-threshold",SHOW_SELECT_ALL:"show-select-all",SELECT_ALL_LABEL:"select-all-label"},Yt={...J},$t={SCROLLED_BOTTOM:`${Q}-scrolled-bottom`},u={elementName:Q,observedAttributes:J,attributes:Yt,selectors:Mt,events:$t};class Kt extends qt{constructor(t){super(t),this._fieldElement=S(t,u.selectors.FIELD),this._labelElement=S(t,u.selectors.LABEL),this._selectedTextElement=S(t,u.selectors.SELECTED_TEXT),this._fieldElement.setAttribute("exportparts",Object.values(c.parts).join(", ")),this._fieldElement.focusIndicatorTargetElement=this._component}get fieldElement(){return this._fieldElement}initializeAccessibility(){this._component.setAttribute("role","combobox"),this._component.setAttribute("aria-haspopup","true"),this._component.setAttribute("aria-expanded","false"),yt(),U(this._component),this.fieldElement.required&&this.setHostAttribute("aria-required","true"),this.fieldElement.disabled&&this.setHostAttribute("aria-disabled","true"),this.fieldElement.invalid&&this.setHostAttribute("aria-invalid","true"),this._component[F]=!this._component.disabled}setLabel(t){const i=!(this._fieldElement.labelPosition==="inset"&&(this._fieldElement.density==="extra-small"||this._fieldElement.dense))&&!!t?.trim();(!this._component.hasAttribute("aria-label")||this._component.getAttribute("aria-label")===this._labelElement.textContent)&&this._component.setAttribute("aria-label",t),i?(this._labelElement.isConnected||this._fieldElement.insertAdjacentElement("afterbegin",this._labelElement),this._labelElement.textContent=t):this._labelElement.remove()}setPlaceholderText(t){N(this._selectedTextElement,!!t?.trim(),"placeholder",t)}open(t){this._targetElement||(this._targetElement=S(this._fieldElement,c.selectors.POPOVER_TARGET)),super.open(t),this._component.setAttribute("aria-controls",`list-dropdown-popup-${t.id}`),this._component.setAttribute("aria-expanded","true"),this._fieldElement.popoverExpanded=!0}close(){return this._component.setAttribute("aria-expanded","false"),this._component.removeAttribute("aria-activedescendant"),U(this._component),this._fieldElement.popoverExpanded=!1,super.close()}floatLabel(t){this._fieldElement.floatLabel=t}updateActiveDescendant(t){N(this._component,!!t,"aria-activedescendant",t)}setSelectedText(t){this._selectedTextElement.textContent=t}setDisabled(t){this._component[F]=!t,N(this._component,t,"aria-disabled","true")}setRequired(){this._component[w]()}addClickListener(t){this._component.addEventListener("click",t)}removeClickListener(t){this._component.removeEventListener("click",t)}addTargetListener(t,e){this._component.addEventListener(t,e)}removeTargetListener(t,e){this._component.removeEventListener(t,e)}syncValue(t){const i=(Array.isArray(t)?!t.length||!t.some(n=>n!=null):t==null)?null:new FormData,s=JSON.stringify(t);i&&t&&i.append(this._component.name,s),this._component.setFormValue(i,s),this._component[w]()}}class Xt extends Wt{constructor(t){super(t),this._label="",this._required=!1,this._permanentlyFloatLabel=!1,this._mousedownListener=this._onMouseDown.bind(this)}initialize(){this._adapter.tryApplyGlobalConfiguration(["labelPosition","variant"]),super.initialize(),super.initializeTarget(),this._initializeLabel(),this._initializeAccessibility(),this._adapter.addTargetListener("mousedown",this._mousedownListener)}destroy(){super.destroy(),this._adapter.removeTargetListener("mousedown",this._mousedownListener)}syncFloatingLabelState({force:t}={}){t!==void 0&&(this._permanentlyFloatLabel=t),this._updateLabel(),this._tryFloatLabel()}setDisabled(t){this._adapter.setDisabled(t)}_initializeLabel(){this._updateLabel(),this._tryFloatLabel()}_initializeValue(){super._initializeValue(),this._tryFloatLabel()}_initializeAccessibility(){this._adapter.initializeAccessibility()}_onMouseDown(t){t.preventDefault()}_onClick(t){this._adapter.fieldElement.disabled||t.composedPath().find(i=>i.matches?.("slot[name=accessory]"))||(this._adapter.focusHost(),super._onClick(t))}_openDropdown(){super._openDropdown(),this._open&&this._adapter.toggleHostAttribute(u.attributes.OPEN,!0)}_closeDropdown(){super._closeDropdown(),this._open||this._adapter.toggleHostAttribute(u.attributes.OPEN,!1)}_onDismiss(){super._onDismiss()}_onDropdownScrollEnd(){this._adapter.emitHostEvent(u.events.SCROLLED_BOTTOM)}async _onSelect(t,e,i=!0){const s=await super._onSelect(t,e,i);return s&&(this._adapter.setSelectedText(this._getSelectedText()),i&&!this._multiple&&this._adapter.focusHost()),this._tryFloatLabel(),this._adapter.syncValue(this._value),s}_reset(){super._reset(),this._adapter.setSelectedText(""),this._tryFloatLabel()}_tryFloatLabel(){if(this._permanentlyFloatLabel){this._adapter.floatLabel(!0);return}const t=!!this._getSelectedText()||!!this._selectedValues.length,e=!!this._placeholder;this._adapter.floatLabel(t||e)}_updateLabel(){this._adapter.setLabel(this._label)}_applyValue(t){super._applyValue(t),this._adapter.syncValue(this._value);const e=this._getSelectedText();this._adapter.setSelectedText(e),this._tryFloatLabel()}get label(){return this._label}set label(t){this._label!==t&&(this._label=t,this._updateLabel(),this._label&&this._initializeLabel(),this._adapter.toggleHostAttribute(u.attributes.LABEL,!!this._label,this._label))}get placeholder(){return this._placeholder}set placeholder(t){this._placeholder!==t&&(this._placeholder=t,this._adapter.setPlaceholderText(this._placeholder),this._initializeLabel())}get multiple(){return super.multiple}set multiple(t){this._multiple!==t&&(super.multiple=t,this._adapter.toggleHostAttribute(u.attributes.MULTIPLE,t))}set required(t){this._required!==t&&this._adapter.setRequired()}}const Qt=`<template>
  <forge-field id="field" popover-icon focus-indicator-allow-focus focus-indicator-focus-mode="focus">
    <span id="select-label" slot="label"></span>
    <slot slot="start" name="start"></slot>
    <div data-forge-field-input class="selected-text-container" part="text-container" aria-live="assertive" aria-atomic="true">
      <slot name="value">
        <span id="selected-text" class="selected-text" part="text"></span>
      </slot>
    </div>
    <slot slot="end" name="end"></slot>
    <slot slot="accessory" name="accessory"></slot>
    <slot slot="support-text" name="support-text"></slot>
    <slot slot="support-text-end" name="support-text-end"></slot>

    <!-- Include deprecated leading alias -->
    <slot slot="start" name="leading"></slot>
    <!-- Include deprecated trailing alias -->
    <slot slot="end" name="trailing"></slot>
    <!-- Include deprecated addon-end alias -->
    <slot slot="accessory" name="addon-end"></slot>
    <!-- Include deprecated helper-text alias -->
    <slot slot="support-text" name="helper-text"></slot>
  </forge-field>
</template>
`,Jt=":host{display:block;outline:none}:host([hidden]){display:none}forge-field{--_select-placeholder-color: var(--forge-select-placeholder-color, var(--forge-field-placeholder-color, var(--forge-theme-text-medium, rgba(0, 0, 0, .6))))}.selected-text-container{display:grid;align-items:center;cursor:pointer}::slotted([slot=value]),.selected-text{white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.selected-text:empty:before{content:attr(placeholder);color:var(--_select-placeholder-color);font-size:inherit}:host([disabled]) .selected-text-container{cursor:not-allowed}forge-field{display:contents}";var Zt=Object.defineProperty,te=Object.getOwnPropertyDescriptor,I=(l,t,e,i)=>{for(var s=i>1?void 0:i?te(t,e):t,n=l.length-1,a;n>=0;n--)(a=l[n])&&(s=(i?a(t,e,s):a(s))||s);return i&&s&&Zt(t,e,s),s};let A=class extends ht(bt(ct(_t(ut(vt(m)))))){static get observedAttributes(){return[...Y.observedAttributes,...Object.values(_.observedAttributes),...Object.values(u.observedAttributes),...Object.values(C.observedAttributes)]}constructor(){super(),nt.define([rt,at]),tt(this,Qt,Jt);const l=this.shadowRoot?.querySelector(c.elementName);this.initializeFieldInstance(l),this[et]="select",this._core=new Xt(new Kt(this))}connectedCallback(){super.connectedCallback(),this[H]({role:"combobox",ariaDisabled:this.disabled?"true":"false",ariaRequired:this.required?"true":"false"})}attributeChangedCallback(l,t,e){switch(l){case u.observedAttributes.OPEN:this.open=b(e);return;case u.observedAttributes.LABEL:this.label=e;return;case u.observedAttributes.PLACEHOLDER:this.placeholder=e;return;case u.observedAttributes.SHOW_SELECT_ALL:this.showSelectAll=b(e);return;case u.observedAttributes.SELECT_ALL_LABEL:this.selectAllLabel=e;return}super.attributeChangedCallback(l,t,e)}[it](){return this.value}[w](){this[G].setValidity({valueMissing:this.required&&!this.value},this[st]({required:this.required,value:this.value}))}formResetCallback(){this.value=null}formStateRestoreCallback(l){this.value=JSON.parse(l)}labelClickedCallback(){this.click(),this.focus()}labelChangedCallback(l){this[H]({ariaLabel:l})}setFormValue(l,t){this[G].setFormValue(l,t)}get floatLabel(){return super.floatLabel}set floatLabel(l){this._core.syncFloatingLabelState({force:l})}get density(){return super.density}set density(l){super.density=l,this._core.syncFloatingLabelState()}get dense(){return super.dense}set dense(l){super.dense=l,this._core.syncFloatingLabelState()}get disabled(){return super.disabled}set disabled(l){super.disabled=l,this._core.setDisabled(l)}get required(){return super.required}set required(l){super.required=l,this._core.required=l}get labelPosition(){return super.labelPosition}set labelPosition(l){super.labelPosition=l,this._core.syncFloatingLabelState()}};I([r()],A.prototype,"label",2);I([r()],A.prototype,"placeholder",2);I([r()],A.prototype,"readonly",2);I([r()],A.prototype,"showSelectAll",2);I([r()],A.prototype,"selectAllLabel",2);A=I([k({name:u.elementName,dependencies:[mt,p,P,Et,gt,At,dt,pt,It,Ot,ft,Tt]})],A);export{Wt as B,p as O,A as S,qt as a,P as b,m as c,C as d};
