import{a as d}from"./utils-DY0XlZdW.js";class a{constructor(){this.promise=new Promise((s,e)=>{this._resolveFn=s,this._rejectFn=e})}resolve(s){this._resolveFn(s)}reject(s){this._rejectFn(s)}}const o=Symbol("tryDismiss"),n=Symbol("forgeDismissibleStack");class m{constructor(){this._dismissibleElements=new Set,this._elementsRequestingDismiss=new Map}get dismissing(){var s;return((s=this._deferredDismiss)==null?void 0:s.promise)??Promise.resolve()}static get instance(){return window[n]||(window[n]=new m),window[n]}async dismiss(s,e){const t=m.instance.getAll(),r=t.slice(t.indexOf(s)).filter(i=>i===s||i.contains(s)).reverse();for(const i of r)if(!i[o](e))break}async requestDismiss(s,e){var r;if(this._deferredDismiss||(this._deferredDismiss=new a),this._elementsRequestingDismiss.set(s,e),await d(),!this.isRequestingLightDismiss(s))return;const t=Array.from(this._elementsRequestingDismiss).reverse();this._elementsRequestingDismiss.clear();try{for(const[i,l]of t)if(!i[o](l))break}finally{(r=this._deferredDismiss)==null||r.resolve(),this._deferredDismiss=void 0}}add(s){this._dismissibleElements.add(s)}remove(s){this._dismissibleElements.delete(s),this._elementsRequestingDismiss.delete(s)}has(s){return this._dismissibleElements.has(s)}isRequestingLightDismiss(s){return this._elementsRequestingDismiss.has(s)}isMostRecent(s){const e=Array.from(this._dismissibleElements);return e[e.length-1]===s}getAll(){return Array.from(this._dismissibleElements)}}export{m as D,o as t};
