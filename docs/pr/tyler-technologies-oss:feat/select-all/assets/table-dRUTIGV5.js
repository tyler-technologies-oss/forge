import{C as Y,j as G,B as Z}from"./constants-DzQy6WDX.js";import{B as $,c as L}from"./base-adapter-C8aSF3nG.js";import{d as I,a as B,h as p,j as R,J as x,D as O,g as P,p as j,r as N,E as y,B as W,l as q,o as V,c as A,b as J}from"./feature-detection-B-sRDmdg.js";import"./service-adapter-CffG5Lhq.js";import{S as Q,G as U,I as ee,W as te}from"./icon-kuXwuZAY.js";import{E as D,a as se}from"./expansion-panel-CtPm9dI4.js";import"./index-5CPwzmQS.js";import{C as ie,a as oe}from"./checkbox-Bau9iA2W.js";import{f as z,c as g,g as le,m as H}from"./text-field-Cw4Jb27S.js";import{B as F}from"./base-component-delegate-Dh4VElUy.js";import{g as b}from"./event-utils-C1SDeUaq.js";import{a as re}from"./tooltip-B59ljHGY.js";import"./overlay-B5pGv-rV.js";import{F as ne}from"./focus-indicator-Bg6HJ9xm.js";class k{constructor(e){this._key=e,this._items=[]}getItems(){return[...this._items]}count(){return this._items.length}setKey(e){this._key=e}add(e){return e instanceof Array||(e=[e]),e.forEach(t=>{this.exists(t)||this._items.push(t)}),this}remove(e){e instanceof Array||(e=[e]);for(let t=e.length-1;t>=0;t--)this.exists(e[t])&&this._items.splice(this._items.indexOf(this._getItem(e[t])),1);return this}clear(){return this._items=[],this}exists(e){return this._getItem(e)!==null}_getItem(e){return this._key?z(this._items,g(this._key,e))||null:this._items.find(t=>t===e)||null}}class M extends F{constructor(e){super(e)}}const S=`${Y}table`,ae={TABLE:"forge-table",TABLE_DENSE:"forge-table--dense",TABLE_ROOMY:"forge-table--roomy",TABLE_RESIZABLE:"forge-table--resizable",TABLE_RESIZING:"forge-table--resizing",TABLE_RESIZE_HANDLE:"forge-table__resize-handle",TABLE_NO_WRAP_CONTENT:"forge-table--no-wrap-content",TABLE_LAYOUT_FIXED:"forge-table--layout-fixed",TABLE_FILTER_VISIBLE:"forge-table--filter-visible",TABLE_FIXED:"forge-table--fixed",TABLE_HEAD_ROW:"forge-table-head__row",TABLE_HEAD_ROW_FILTER:"forge-table-head__row__filter",TABLE_HEAD_CELL:"forge-table-head__cell",TABLE_HEAD_CELL_CONTAINER:"forge-table-head__cell-container",TABLE_HEAD_CELL_SORTABLE:"forge-table-head__cell--sortable",TABLE_HEAD_CELL_SORT_ICON:"forge-table-head__cell-sort-icon",TABLE_HEAD_CELL_TEXT:"forge-table-head__cell-text",TABLE_HEAD_CELL_SORT_ICON_ACTIVE:"forge-table-head__cell-sort-icon--active",TABLE_HEAD_CELL_SORTED_ASCENDING:"forge-table-head__cell--sorted-ascending",TABLE_HEAD_CELL_SORTED_DESCENDING:"forge-table-head__cell--sorted-descending",TABLE_HEAD_CELL_SORT_ORDER:"forge-table-head__cell__sort-order",TABLE_HEAD_CELL_SORT_ORDER_HIDDEN:"forge-table-head__cell__sort-order--hidden",TABLE_BODY_ROW:"forge-table-body__row",TABLE_BODY_ROW_SELECTED:"forge-table-body__row--selected",TABLE_BODY_ROW_CLICKABLE:"forge-table-body__row--clickable",TABLE_BODY_CELL:"forge-table-body__cell",TABLE_ROW:"forge-table-row",TABLE_ROW_EXPANDED:"forge-table-row--expanded",TABLE_ROW_EXPANDABLE_CONTENT:"forge-table-row__expandable-content",TABLE_ROW_EXPANDABLE_CONTENT_CELL:"forge-table-row__expandable-content-cell",TABLE_CELL:"forge-table-cell",TABLE_CELL_SELECT:"forge-table-cell__select",TABLE_CELL_SELECT_CHECKBOX_CONTAINER:"forge-table-cell__select-checkbox-container",TABLE_CELL_SELECT_CHECKBOX_CONTAINER_ALIGN_RIGHT:"forge-table-cell__select-checkbox-container--align-right",TABLE_CELL_SELECT_CHECKBOX_CONTAINER_ALIGN_LEFT:"forge-table-cell__select-checkbox-container--align-left",TABLE_CELL_SELECT_CHECKBOX_CONTAINER_ALIGN_CENTER:"forge-table-cell__select-checkbox-container--align-center",TABLE_CELL_CONTAINER:"forge-table-cell__container",TABLE_CELL_CONTAINER_TEXT:"forge-table-cell__container-text",TABLE_CELL_CENTER:"forge-table-cell--center",TABLE_CELL_RIGHT:"forge-table-cell--right",TABLE_CELL_RESIZABLE:"forge-table-cell--resizing"},ce={CHECKBOX_INPUT:":is(forge-checkbox,input[type=checkbox]):not([forge-ignore])",SELECT_ALL_TEMPLATE_CHECKBOX_INPUT:":is(forge-checkbox,input[type=checkbox]):not([forge-ignore])"},de={SELECT:"select",MULTISELECT:"multiselect",SELECT_KEY:"select-key",DENSE:"dense",ROOMY:"roomy",FILTER:"filter",FIXED_HEADERS:"fixed-headers",LAYOUT_TYPE:"layout-type",WRAP_CONTENT:"wrap-content",RESIZABLE:"resizable",MIN_RESIZE_WIDTH:"min-resize-width",ALLOW_ROW_CLICK:"allow-row-click",MULTI_COLUMN_SORT:"multi-column-sort",SELECT_CHECKBOX_ALIGNMENT:"select-checkbox-alignment",TOOLTIP_SELECT:"tooltip-select",TOOLTIP_SELECT_ALL:"tooltip-select-all",CUSTOM_CELL_TEMPLATE:"data-cell-template",CUSTOM_CELL_TEMPLATE_STOP_PROPAGATION:"data-cell-template-stop-propagation",SELECT_CHECKBOX:"forge-table-row-select-checkbox"},_e={ROW_CLICK:`${S}-row-click`,SELECT:`${S}-select`,SELECT_DOUBLE:`${S}-select-double`,SELECT_ALL:`${S}-select-all`,SORT:`${S}-sort`,FILTER:`${S}-filter`,INITIALIZED:`${S}-initialized`,COLUMN_RESIZE:`${S}-column-resize`,BEFORE_BODY_RENDERED:`${S}-before-body-rendered`,BODY_RENDERED:`${S}-body-rendered`},he={DEFAULT_LAYOUT_TYPE:"auto"},Ee={SORT_DOWN:"arrow_downward"},me={DEFAULT_FILTER_DEBOUNCE_TIME:750,MIN_RESIZE_WIDTH:100},o={elementName:S,classes:ae,selectors:ce,attributes:de,events:_e,strings:he,icons:Ee,numbers:me};var T=(h=>(h.Left="left",h.Right="right",h.Center="center",h))(T||{}),u=(h=>(h.Ascending="ASC",h.Descending="DESC",h.Unset="UNSET",h))(u||{});function v(h){return h&&typeof h=="object"&&"content"in h}class n{static createTable(e){n._resetTable(e.tableElement);const t=n._createTableHead(e),s=n._createTableBody(e);e.clickListener&&(n._attachRowClickListeners(s,e.clickListener,e.doubleClickListener),n._addRowClickAttributes(s)),e.fixedHeaders&&n.setFixedHeaders(e),e.resizable&&n.setResizable(e),e.dense&&n.setDenseState(e.tableElement,e.dense),e.wrapContent&&n.setWrapContentState(e.tableElement,e.wrapContent),e.selectListener&&n._addSelectColumn(t,s,e.selectListener,e.selectAllListener,e.selectAllTemplate,e.selectCheckboxAlignment,e.data,e.tooltipSelect,e.tooltipSelectAll),(e.resizable||e.columnConfigurations.some(i=>!!i.sortable))&&(n._attachHeadRowMouseDownListener(t,e.headRowMouseDownListener),n._isMac()&&n._attachHeadRowContextMenuListener(t,e.headRowContextMenuListener)),n.setLayoutType(e),n._setTableHead(e.tableElement,t),e.filter&&n.setFilterRow(e),n._setTableBody(e.tableElement,s)}static _setTableHead(e,t){e.tHead?I(t,e.tHead):e.appendChild(t)}static _setTableBody(e,t){e.tBodies.length?I(t,e.tBodies[0]):e.appendChild(t)}static recreateTableBody(e){const t=n._createTableBody(e);e.clickListener&&(n._attachRowClickListeners(t,e.clickListener,e.doubleClickListener),n._addRowClickAttributes(t)),e.selectListener&&(n._createBodySelectColumn(t,e.selectCheckboxAlignment,e.data,e.tooltipSelect,e.tooltipSelectAll),n._attachRowSelectListeners(t,e.selectListener)),n._setTableBody(e.tableElement,t)}static _resetTable(e){B(e)}static _createMultisortTooltip(){const e=document.createElement("forge-tooltip");return e.textContent="Ctrl + click to sort multiple columns",e.placement="bottom",e.delay=0,e}static _createTableHead(e){const t=document.createElement("thead"),s=t.insertRow();p([o.classes.TABLE_ROW,o.classes.TABLE_HEAD_ROW],s);let i=!1;for(let l=0;l<e.columnConfigurations.length;l++){const r=e.columnConfigurations[l],a=document.createElement("th");a.scope="col",p([o.classes.TABLE_CELL,o.classes.TABLE_HEAD_CELL],a);let d;if(r.sortable){d=document.createElement("button"),d.type="button";const c=document.createElement("forge-focus-indicator");c.inward=!0,d.appendChild(c),d.addEventListener("keydown",e.sortableHeadCellKeydownListener)}else d=document.createElement("div");if(d.classList.add(o.classes.TABLE_HEAD_CELL_CONTAINER),e.multiColumnSort){const c=n._createMultisortTooltip();d.appendChild(c)}if(r.align&&n._setCellAlignmentClass(d,r.align),R(r.width)){const c=x(r.width);c&&(a.style.width=c)}if(e.resizable&&r.resizable!==!1){const c=document.createElement("div");c.classList.add(o.classes.TABLE_RESIZE_HANDLE),a.appendChild(c)}if(R(r.headerCellStyle)&&O(r.headerCellStyle)&&(Object.assign(a.style,r.headerCellStyle),Object.assign(d.style,r.headerCellStyle)),r.sortable){a.classList.add(o.classes.TABLE_HEAD_CELL_SORTABLE);const c=document.createElement("span");p([o.classes.TABLE_HEAD_CELL_SORT_ORDER_HIDDEN,o.classes.TABLE_HEAD_CELL_SORT_ORDER],c);const _=document.createElement(Q.elementName);_.name=o.icons.SORT_DOWN,p([o.classes.TABLE_HEAD_CELL_SORT_ICON],_),e.multiColumnSort?typeof r.initialSort=="object"&&r.initialSort.sortOrder&&(c.textContent=r.initialSort.sortOrder.toString(),e.columnConfigurations.filter(E=>typeof E.initialSort=="object").length>1&&P(o.classes.TABLE_HEAD_CELL_SORT_ORDER_HIDDEN,c),a.classList.add(o.classes.TABLE_HEAD_CELL_SORTED_DESCENDING),_.classList.add(o.classes.TABLE_HEAD_CELL_SORT_ICON_ACTIVE),n._setColumnSortDirection(a,r.initialSort.direction)):e.sortedColumn===l&&!i&&!e.multiColumnSort&&(a.classList.add(o.classes.TABLE_HEAD_CELL_SORTED_DESCENDING),_.classList.add(o.classes.TABLE_HEAD_CELL_SORT_ICON_ACTIVE),n._setColumnSortDirection(a,e.sortDirection),i=!0),d.appendChild(_),d.appendChild(c)}if(typeof r.headerTemplate=="function")Promise.resolve(r.headerTemplate(l,d,r)).then(c=>{if(c){const _=document.createElement("div");p(o.classes.TABLE_CELL_CONTAINER,_),typeof c=="string"?_.innerHTML=c:n._prepend(c,_),_.setAttribute(o.attributes.CUSTOM_CELL_TEMPLATE,""),n._prepend(_,d)}});else{const c=document.createElement("span");c.classList.add(o.classes.TABLE_HEAD_CELL_TEXT),c.textContent=r.header&&typeof r.header=="string"?r.header.trim():"",c.textContent.trim().length===0&&a.setAttribute("aria-hidden","true"),n._prepend(c,d)}a.appendChild(d),s.appendChild(a)}return t}static setSortDirection(e,t,s){const i=n._getHeaderCellByIndex(e,t);e.querySelectorAll("th[aria-sort]").forEach(l=>l.removeAttribute("aria-sort")),n._setColumnSortDirection(i,s)}static _setColumnSortDirection(e,t){e.classList.contains(o.classes.TABLE_HEAD_CELL_SORTED_ASCENDING)&&e.classList.remove(o.classes.TABLE_HEAD_CELL_SORTED_ASCENDING),e.classList.contains(o.classes.TABLE_HEAD_CELL_SORTED_DESCENDING)&&e.classList.remove(o.classes.TABLE_HEAD_CELL_SORTED_DESCENDING),!t||t===u.Descending?(e.setAttribute("aria-sort","descending"),e.classList.add(o.classes.TABLE_HEAD_CELL_SORTED_DESCENDING)):(e.setAttribute("aria-sort","ascending"),e.classList.add(o.classes.TABLE_HEAD_CELL_SORTED_ASCENDING))}static _createTableBody(e){const t=document.createElement("tbody");return n._getOrderedRowData(e.columnConfigurations,e.data).forEach((i,l)=>{const r=t.insertRow();p([o.classes.TABLE_ROW,o.classes.TABLE_BODY_ROW],r),n._populateRowCells(e,r,i,l),typeof e.rowCreatedCallback=="function"&&e.rowCreatedCallback(r,l,{...e.data[l].data})}),t}static _populateRowCells(e,t,s,i){for(let l=0;l<s.length;l++){const r=e.columnConfigurations[l],a=t.insertCell();if(p([o.classes.TABLE_CELL,o.classes.TABLE_BODY_CELL],a),R(r.width)){const c=x(r.width);c&&(a.style.width=c)}const d=document.createElement("div");if(d.classList.add(o.classes.TABLE_CELL_CONTAINER),R(r.cellStyle)&&O(r.cellStyle)&&(Object.assign(a.style,r.cellStyle),Object.assign(d.style,r.cellStyle)),r.template&&typeof r.template=="function"){const c=e.data[i]?e.data[i].data:void 0;Promise.resolve(r.template(i,d,c,l)).then(_=>{const E=v(_)?_:{content:_,stopClickPropagation:r.stopCellTemplateClickPropagation};E.content&&(typeof E.content=="string"?d.innerHTML=E.content:d.appendChild(E.content),d.setAttribute(o.attributes.CUSTOM_CELL_TEMPLATE,""),E.stopClickPropagation&&d.setAttribute(o.attributes.CUSTOM_CELL_TEMPLATE_STOP_PROPAGATION,""))})}else if(r.property){const c=document.createElement("span");c.classList.add(o.classes.TABLE_CELL_CONTAINER_TEXT),d.appendChild(c),r.transform&&typeof r.transform=="function"?Promise.resolve(r.transform(s[l])).then(_=>c.textContent=_):s[l]==null?c.textContent="":c.textContent=s[l].toString()}if(r.align&&n._setCellAlignmentClass(d,r.align),a.appendChild(d),R(r.columnSpan)){if(r.columnSpan==="all"){a.colSpan=s.length-l;break}else if(typeof r.columnSpan=="number"&&r.columnSpan>0){let c=r.columnSpan;r.columnSpan>s.length-l&&(c=s.length),a.colSpan=c,l=l+(c-1)}}typeof e.cellCreatedCallback=="function"&&e.cellCreatedCallback(a,i,l)}}static _setCellAlignmentClass(e,t){switch(t){case T.Center:e.classList.add(o.classes.TABLE_CELL_CENTER);break;case T.Right:e.classList.add(o.classes.TABLE_CELL_RIGHT);break}}static _getNonExpandedRows(e){return Array.from(e).filter(t=>!t.classList.contains(o.classes.TABLE_ROW_EXPANDABLE_CONTENT))}static _getExpandedRows(e){return Array.from(e).filter(t=>t.classList.contains(o.classes.TABLE_ROW_EXPANDABLE_CONTENT))}static _createColumnDataMap(e,t){return e.map(s=>({config:s,data:t.map(i=>{if(s.property){const l=le(i.data,s.property);return R(l)?l:null}return null})}))}static _getOrderedRowData(e,t){const s=n._createColumnDataMap(e,t),i=[];for(const l of s)for(let r=0;r<l.data.length;r++)i[r]||(i[r]=[]),i[r].push(l.data[r]);return i}static _attachRowClickListeners(e,t,s){n._getNonExpandedRows(e.rows).forEach(l=>{l.addEventListener("click",t),s&&l.addEventListener("dblclick",s)})}static _addRowClickAttributes(e){n._getNonExpandedRows(e.rows).forEach(s=>{s.classList.add(o.classes.TABLE_BODY_ROW_CLICKABLE)})}static _removeRowClickAttributes(e){n._getNonExpandedRows(e.rows).forEach(s=>{s.classList.remove(o.classes.TABLE_BODY_ROW_CLICKABLE)})}static _attachRowSelectListeners(e,t){n._getNonExpandedRows(e.rows).forEach(i=>n._attachRowSelectListener(i,t))}static _attachRowSelectListener(e,t){const s=n._getCheckboxElement(e);s?.addEventListener("change",t),s?.addEventListener("keydown",t),s?.addEventListener("pointerdown",t)}static _detachRowSelectListeners(e,t){Array.from(e.rows).forEach(s=>{const i=n._getCheckboxElement(s);i?.removeEventListener("change",t),i?.removeEventListener("keydown",t),i?.removeEventListener("pointerdown",t)})}static _detachRowClickListeners(e,t,s){Array.from(e.rows).forEach(i=>{i.removeEventListener("click",t),i.removeEventListener("dblclick",s)})}static _attachSelectAllListener(e,t){const s=e.rows[e.rows.length-1],i=n._getCheckboxElement(s);if(!i)throw new Error("Checkbox element not found.");i.addEventListener("change",t)}static _tryAttachSelectAllTemplateListener(e,t){const s=e.rows[e.rows.length-1],i=n._tryGetSelectAllCheckboxElement(s);i&&i.addEventListener("change",t)}static _detachSelectAllListener(e,t){const s=e.rows[e.rows.length-1],i=n._tryGetSelectAllCheckboxElement(s);i&&i.removeEventListener("change",t)}static _attachHeadRowMouseDownListener(e,t){const s=e.rows[0];if(!s)throw new Error("Missing table header row. Unable to attach sort listener.");s.addEventListener("mousedown",t)}static _attachHeadRowContextMenuListener(e,t){const s=e.rows[0];if(!s)throw new Error("Missing table header row. Unable to attach sort listener.");s.addEventListener("contextmenu",t)}static _createSelectColumn(e,t,s,i,l,r,a,d,c){e&&n._createHeadSelectColumn(e,s,i,l,r,c),t&&n._createBodySelectColumn(t,r,a,d,c)}static _createHeadSelectColumn(e,t,s,i,l,r){if(Array.from(e.rows).forEach(a=>{const d=document.createElement("th");p([o.classes.TABLE_CELL,o.classes.TABLE_HEAD_CELL],d),a.insertBefore(d,a.cells.item(0))}),t){const a=e.rows.item(e.rows.length-1)?.cells.item(0);a.classList.add(o.classes.TABLE_CELL_SELECT),typeof s=="function"?n._renderSelectAllTemplate(s,e).then(()=>{typeof i=="function"&&i()}):a?.appendChild(n._createCheckboxElement(!0,l,null,null,null,r))}}static _createBodySelectColumn(e,t,s,i,l){if(n._getNonExpandedRows(e.rows).forEach((a,d)=>n._addRowSelectColumn(a,t,d,s[d],i,l)),e.rows.length){const a=e.rows.item(0);a&&n._updateExpandedRowColspan(e.rows,a.cells.length)}}static _addRowSelectColumn(e,t,s,i,l,r){const a=e.insertCell(0);p([o.classes.TABLE_CELL,o.classes.TABLE_BODY_CELL,o.classes.TABLE_CELL_SELECT],a),a.appendChild(n._createCheckboxElement(!1,t,s,i,l,r))}static _destroySelectColumn(e,t){const s=n._getNonExpandedRows(t.rows);if(Array.from(e.rows).forEach(i=>i.removeChild(i.cells.item(0))),Array.from(s).forEach(i=>i.removeChild(i.cells.item(0))),t.rows.length){const i=t.rows.item(0);i&&n._updateExpandedRowColspan(t.rows,i.cells.length)}}static _hasSelectColumn(e,t){return[...Array.from(e.rows),...Array.from(t.rows)].some(i=>i.cells.item(0).classList.contains(o.classes.TABLE_CELL_SELECT))}static _createCheckboxElement(e,t,s,i,l,r){const a=document.createElement("div");if(a.classList.add(o.classes.TABLE_CELL_SELECT_CHECKBOX_CONTAINER),t)switch(t){case T.Center:a.classList.add(o.classes.TABLE_CELL_SELECT_CHECKBOX_CONTAINER_ALIGN_CENTER);break;case T.Left:a.classList.add(o.classes.TABLE_CELL_SELECT_CHECKBOX_CONTAINER_ALIGN_LEFT);break;case T.Right:a.classList.add(o.classes.TABLE_CELL_SELECT_CHECKBOX_CONTAINER_ALIGN_RIGHT);break}const d=document.createElement(ie.elementName);d.setAttribute(o.attributes.SELECT_CHECKBOX,""),a.appendChild(d);const c=_=>{const E=document.createElement("forge-tooltip");return E.placement="left",E.type="label",E.textContent=_,E};if(e)if(typeof r=="string"&&r.length){const E=c(r);a.appendChild(E)}else d.setAttribute("aria-label","Select all rows");else{let _=l||"";if(i&&typeof l=="function"&&(_=l.call(null,s,i.data)),typeof _=="string"&&_.length){const E=c(_);a.appendChild(E)}else d.setAttribute("aria-label","Select row")}return a}static _getCheckboxElement(e){const t=e.querySelector(`.${o.classes.TABLE_CELL_SELECT}`);return t?t.querySelector(o.selectors.CHECKBOX_INPUT):null}static _tryGetSelectAllCheckboxElement(e){const t=e.querySelector(`.${o.classes.TABLE_CELL_SELECT}`);return t?t.querySelector(o.selectors.CHECKBOX_INPUT)||t.querySelector(o.selectors.SELECT_ALL_TEMPLATE_CHECKBOX_INPUT):null}static _setSelectedCheckboxState(e,t){e&&(e.checked=t)}static _setIndeterminateCheckboxState(e,t){e&&(e.indeterminate=t)}static _setRowSelectedState(e,t){t?e.classList.contains(o.classes.TABLE_BODY_ROW_SELECTED)||e.classList.add(o.classes.TABLE_BODY_ROW_SELECTED):e.classList.remove(o.classes.TABLE_BODY_ROW_SELECTED)}static _updateExpandedRowColspan(e,t){n._getExpandedRows(e).forEach(i=>{const l=i.cells.item(0);l&&(l.colSpan=t)})}static updateSelectedState(e,t){n._setRowSelectedState(e,t);const s=n._getCheckboxElement(e);s&&n._setSelectedCheckboxState(s,t)}static getRowByIndex(e,t){return n._getNonExpandedRows(e.tBodies[0].rows)[t]}static updateSelectAllState(e,t,s){if(!e.tHead)return;const i=e.tHead.rows[e.tHead.rows.length-1],l=n._tryGetSelectAllCheckboxElement(i);l&&(n._setSelectedCheckboxState(l,t),n._setIndeterminateCheckboxState(l,!!s))}static setSelectedRows(e,t,s,i,l=!1){if(!e.tBodies.length)return;l||n.clearSelectedRows(e);const r=e.tBodies[0].rows;let a=0;i.length&&Array.from(r).forEach((d,c)=>{const _=s[c];if(z(i,g(t,_))){n._setRowSelectedState(d,!0);const f=n._getCheckboxElement(d);f&&n._setSelectedCheckboxState(f,!0),a++}}),n.updateSelectAllState(e,a>0&&r.length===a)}static clearSelectedRows(e){if(!e.tBodies.length)return;n._getNonExpandedRows(e.tBodies[0].rows).forEach(s=>{n._setRowSelectedState(s,!1);const i=n._getCheckboxElement(s);i&&n._setSelectedCheckboxState(i,!1)})}static setSortedColumn(e,t,s){const i=n._getHeaderCellByIndex(e,t);n._getSortIconElementFromHeaderCell(i).classList.add(o.classes.TABLE_HEAD_CELL_SORT_ICON_ACTIVE),n._setColumnSortDirection(i,s)}static setMultiSortColumnSortNumber(e,t,s,i){const a=n._getHeaderCellByIndex(e,s).querySelector(`.${o.classes.TABLE_HEAD_CELL_CONTAINER}`).querySelector(`.${o.classes.TABLE_HEAD_CELL_SORT_ORDER}`);a&&(j(a,typeof i!="number"||!t,o.classes.TABLE_HEAD_CELL_SORT_ORDER_HIDDEN),i&&(a.textContent=i.toString()))}static removeColumnSort(e,t){const s=n._getHeaderCellByIndex(e,t);s.removeAttribute("aria-sort"),s.classList.contains(o.classes.TABLE_HEAD_CELL_SORTED_ASCENDING)&&s.classList.remove(o.classes.TABLE_HEAD_CELL_SORTED_ASCENDING),s.classList.contains(o.classes.TABLE_HEAD_CELL_SORTED_DESCENDING)&&s.classList.remove(o.classes.TABLE_HEAD_CELL_SORTED_DESCENDING);const i=n._getSortIconElementFromHeaderCell(s);i&&i.classList.contains(o.classes.TABLE_HEAD_CELL_SORT_ICON_ACTIVE)&&i.classList.remove(o.classes.TABLE_HEAD_CELL_SORT_ICON_ACTIVE)}static _getHeaderCellByIndex(e,t){if(!e.tHead)throw new Error("Table head element cannot be null.");return e.tHead.rows.item(0).cells.item(t)}static _getSortIconElementFromHeaderCell(e){return e.querySelector(`.${o.classes.TABLE_HEAD_CELL_SORT_ICON}`)}static setSelectColumnVisibility(e,t,s,i,l,r,a,d,c){const _=e.tHead,E=e.tBodies[0];!_||!E||(t?n._addSelectColumn(_,E,s,i,l,r,a,d,c):n._hasSelectColumn(_,E)&&(s&&n._detachRowSelectListeners(E,s),i&&n._detachSelectAllListener(_,i),n._destroySelectColumn(_,E)))}static _addSelectColumn(e,t,s,i,l,r,a,d,c){n._createSelectColumn(e,t,!!i,l,()=>{i&&n._tryAttachSelectAllTemplateListener(e,i)},r,a,d,c),s&&n._attachRowSelectListeners(t,s),i&&!l&&n._tryAttachSelectAllTemplateListener(e,i)}static setDenseState(e,t){e.classList.contains(o.classes.TABLE_DENSE)&&e.classList.remove(o.classes.TABLE_DENSE),t&&e.classList.add(o.classes.TABLE_DENSE)}static setRoomyState(e,t){e.classList.contains(o.classes.TABLE_ROOMY)&&e.classList.remove(o.classes.TABLE_ROOMY),t&&e.classList.add(o.classes.TABLE_ROOMY)}static setResizable(e){const t=e.tableElement.tHead;e.resizable?(e.tableElement.classList.add(o.classes.TABLE_RESIZABLE),n._addResizeHandles(t,e)):(e.tableElement.classList.remove(o.classes.TABLE_RESIZABLE),n._removeResizeHandles(t,e))}static _addResizeHandles(e,t){if(!e)return;const s=e.rows.item(0);if(s){let i=Array.from(s.cells);t.selectListener&&(i=i.slice(1));for(const l of i){const r=i.indexOf(l);if(t.columnConfigurations[r].resizable!==!1){const d=document.createElement("div");d.classList.add(o.classes.TABLE_RESIZE_HANDLE),l.appendChild(d)}}}}static _removeResizeHandles(e,t){if(!e)return;const s=e.rows.item(0);if(s){let i=Array.from(s.cells);t.selectListener&&(i=i.slice(1));for(const l of i){const r=document.querySelector(`.${o.classes.TABLE_RESIZE_HANDLE}`);r&&l.removeChild(r)}}}static setWrapContentState(e,t){t?e.classList.remove(o.classes.TABLE_NO_WRAP_CONTENT):e.classList.add(o.classes.TABLE_NO_WRAP_CONTENT)}static setSelectAllVisibility(e,t,s,i,l,r){const a=e.tHead;if(!a)return;!t&&s&&n._detachSelectAllListener(a,s);const c=a.rows[a.rows.length-1].cells.item(0);t?c.childElementCount||(c.classList.add(o.classes.TABLE_CELL_SELECT),i?n._renderSelectAllTemplate(i,a).then(()=>{s&&n._tryAttachSelectAllTemplateListener(a,s)}):c.appendChild(n._createCheckboxElement(!0,l||null,null,null,null,r)),s&&!i&&n._attachSelectAllListener(a,s)):(s&&n._detachSelectAllListener(a,s),B(c))}static setFilterRow(e){if(!e.tableElement.tHead)return;const t=n._getFilterRowElement(e.tableElement.tHead);let s;if(e.filter?e.tableElement.classList.add(o.classes.TABLE_FILTER_VISIBLE):e.tableElement.classList.remove(o.classes.TABLE_FILTER_VISIBLE),e.filter&&!t){if(e.columnConfigurations.every(l=>!l.filter))return;e.selectListener&&e.selectAllListener&&(s=e.tableElement.tHead.rows[e.tableElement.tHead.rows.length-1].cells.item(0));const i=n._createFilterRowElement(e);i&&s&&Array.from(s.children).forEach(l=>{i.cells.item(0)?.appendChild(l)})}else if(!e.filter&&t){if(e.selectListener&&e.selectAllListener){s=t.cells.item(0);const i=Array.from(e.tableElement.tHead.rows).indexOf(t)-1,l=e.tableElement.tHead.rows.item(i);l&&Array.from(s.children).forEach(r=>{l.cells.item(0)?.appendChild(r)})}N(t)}}static _createFilterRowElement(e){if(!e.tableElement.tHead)throw new Error("Table head element cannot be null.");const t=e.tableElement.tHead.insertRow();if(p([o.classes.TABLE_ROW,o.classes.TABLE_HEAD_ROW_FILTER],t),e.selectListener){const s=document.createElement("th");p([o.classes.TABLE_CELL,o.classes.TABLE_HEAD_CELL],s),t.insertBefore(s,t.cells[0]),s.classList.add(o.classes.TABLE_CELL_SELECT)}return e.columnConfigurations.forEach((s,i)=>{const l=document.createElement("th");if(p([o.classes.TABLE_CELL,o.classes.TABLE_HEAD_CELL],l),s.filter&&R(s.filterDelegate)){const r=document.createElement("div");r.classList.add(o.classes.TABLE_HEAD_CELL_CONTAINER),s.align&&n._setCellAlignmentClass(r,s.align);const a=n._createFilterElement(s,i,e.filterListener);r.appendChild(a),l.appendChild(r)}t.appendChild(l)}),t}static _createFilterElement(e,t,s){let i;if(y(e.filterDelegate))i=e.filterDelegate();else if(e.filterDelegate instanceof M||e.filterDelegate instanceof F)i=e.filterDelegate;else throw new Error("Invalid filter delegate.");if(s&&i instanceof M&&y(i.onChange))if(!R(e.filterDebounceTime)||W(e.filterDebounceTime)){const l=R(e.filterDebounceTime)?e.filterDebounceTime:o.numbers.DEFAULT_FILTER_DEBOUNCE_TIME;i.onChange(q(r=>s(r,t),l))}else i.onChange(l=>s(l,t));return i.element}static _getFilterRowElement(e){if(e)return Array.from(e.rows).find(t=>t.classList.contains(o.classes.TABLE_HEAD_ROW_FILTER))}static async expandRow(e,t,s){const i=e.tableElement.tBodies[0],r=n._getNonExpandedRows(i.rows)[t];r.classList.add(o.classes.TABLE_ROW_EXPANDED);const a=Array.from(i.rows).indexOf(r),d=i.insertRow(a+1);p([o.classes.TABLE_ROW,o.classes.TABLE_BODY_ROW,o.classes.TABLE_ROW_EXPANDABLE_CONTENT],d);const c=d.insertCell();c.setAttribute("colspan",r.cells.length.toString()),c.classList.add(o.classes.TABLE_ROW_EXPANDABLE_CONTENT_CELL);const _=document.createElement("div"),E=document.createElement(D.elementName);E.appendChild(_),c.appendChild(E);let f=s;if(y(s)){const K=e.data[t]?e.data[t].data:void 0,X=s(t,_,K);try{const w=await Promise.resolve(X);f=v(w)?w.content:w}catch(w){console.error("Failed to load row template "+w.message),f=""}}f&&n._setRowTemplate(_,f),window.requestAnimationFrame(()=>E.open=!0)}static _setRowTemplate(e,t){V(t)?e.innerHTML=t:e.appendChild(t)}static collapseRow(e,t){if(!e.tableElement||!e.tableElement.tBodies.length||!e.tableElement.tBodies[0].rows.length)return Promise.resolve();const s=e.tableElement.tBodies[0],l=n._getNonExpandedRows(s.rows)[t],r=Array.from(s.rows).indexOf(l);if(l&&l.classList.contains(o.classes.TABLE_ROW_EXPANDED)){const a=s.rows[r+1],d=a.querySelector(D.elementName);if(d&&d.open){const c=new Promise(_=>{d.addEventListener(D.events.ANIMATION_COMPLETE,()=>{l.classList.remove(o.classes.TABLE_ROW_EXPANDED),N(a),_()},{once:!0})});return d.open=!1,c}}return Promise.resolve()}static isRowExpanded(e,t){const s=e.tableElement.tBodies[0],l=n._getNonExpandedRows(s.rows)[t];return l&&l.classList.contains(o.classes.TABLE_ROW_EXPANDED)}static setFixedHeaders(e){e.fixedHeaders?e.tableElement.classList.add(o.classes.TABLE_FIXED):e.tableElement.classList.remove(o.classes.TABLE_FIXED)}static setLayoutType(e){e.layoutType==="fixed"?e.tableElement.classList.add(o.classes.TABLE_LAYOUT_FIXED):e.tableElement.classList.remove(o.classes.TABLE_LAYOUT_FIXED)}static normalizeColumnWidths(e){const t=e.tableElement;if(t.tHead&&t.tHead.rows.length){const s=Array.from(t.tHead.rows[0].cells);for(const i of s){const l=getComputedStyle(i).width;i.style.width&&i.style.width!==l&&(i.style.width=l)}}}static setColumnResizeIndicatorVisibility(e,t,s){const i=e.tableElement;if(i.tHead&&i.tHead.rows.length){const l=Array.from(i.tHead.rows);for(const r of l){const a=r.cells[t];a&&(s?a.classList.add(o.classes.TABLE_CELL_RESIZABLE):a.classList.remove(o.classes.TABLE_CELL_RESIZABLE))}}if(i.tBodies.length){const l=Array.from(i.tBodies[0].rows);for(const r of l){const a=r.cells[t];a&&(s?a.classList.add(o.classes.TABLE_CELL_RESIZABLE):a.classList.remove(o.classes.TABLE_CELL_RESIZABLE))}}}static setRowClickListeners(e,t,s,i){const l=e.tBodies[0];l&&(t?n._attachRowClickListeners(l,s,i):n._detachRowClickListeners(l,s,i))}static setRowClickAttributes(e,t){const s=e.tBodies[0];s&&(t?n._addRowClickAttributes(s):n._removeRowClickAttributes(s))}static getOwnerDocument(e){return e.ownerDocument||document}static _prepend(e,t){const s=t.childNodes.item(0);s?t.insertBefore(e,s):t.appendChild(e)}static _isMac(){return!!(navigator&&navigator.platform&&navigator.platform.substr(0,3)==="Mac")}static _renderSelectAllTemplate(e,t){return Promise.resolve(e()).then(s=>{const i=t.rows.item(t.rows.length-1);if(!i)return;const l=i.cells.item(0);s&&l&&(typeof s=="string"?l.innerHTML=s:s instanceof HTMLElement&&l.appendChild(s),l.setAttribute(o.attributes.CUSTOM_CELL_TEMPLATE,""))})}}class Ce extends ${constructor(e){super(e)}initialize(){this._tableElement||(this._tableElement=document.createElement("table"),this._tableElement.classList.add(o.classes.TABLE),this._component.children.length&&B(this._component),this._component.appendChild(this._tableElement))}getTableElement(){return this._tableElement||this.initialize(),this._tableElement}createTable(e){return n.createTable(e)}recreateTableBody(e){n.recreateTableBody(e)}setSelectedRows(e,t,s,i,l=!1){n.setSelectedRows(e,t,s,i,l)}clearSelectedRows(e){n.clearSelectedRows(e)}updateSelectedState(e,t){n.updateSelectedState(e,t)}updateSelectAllState(e,t,s){n.updateSelectAllState(e,t,s)}setSortedColumn(e,t,s){n.setSortedColumn(e,t,s)}removeColumnSort(e,t){n.removeColumnSort(e,t)}setSortDirection(e,t,s){n.setSortDirection(e,t,s)}setSelectColumnVisibility(e,t,s,i,l,r,a,d,c){n.setSelectColumnVisibility(e,t,s,i||null,l||null,r||null,a||[],d||null,c||null)}setDense(e,t){n.setDenseState(e,t)}setRoomy(e,t){n.setRoomyState(e,t)}setResizable(e){n.setResizable(e)}setSelectAllVisibility(e,t,s,i,l,r=null){n.setSelectAllVisibility(e,t,s,i,l||null,r||null)}setFilterRow(e){n.setFilterRow(e)}expandRow(e,t,s){return n.expandRow(e,t,s)}collapseRow(e,t){return n.collapseRow(e,t)}isRowExpanded(e,t){return n.isRowExpanded(e,t)}setFixedHeaders(e){n.setFixedHeaders(e)}setTableLayoutType(e){n.setLayoutType(e)}setWrapContentState(e){n.setWrapContentState(e.tableElement,e.wrapContent)}addDocumentListener(e,t){n.getOwnerDocument(this._component).addEventListener(e,t)}removeDocumentListener(e,t){n.getOwnerDocument(this._component).removeEventListener(e,t)}normalizeColumnWidths(e){n.normalizeColumnWidths(e)}setResizeColumnVisibility(e,t,s){n.setColumnResizeIndicatorVisibility(e,t,s)}addTableClass(e){p(e,this._tableElement)}removeTableClass(e){P(e,this._tableElement)}setRowClickListeners(e,t,s,i){n.setRowClickListeners(e,t,s,i)}setRowClickAttributes(e,t){n.setRowClickAttributes(e,t)}}class Le{constructor(){this._sortedColumns=[]}get sortedColumns(){return[...this._sortedColumns.map(e=>({...e}))]}addSortColumn(e){this._sortedColumns.push({...e}),this._updateSortNumbers()}updateSortColumn(e){const t=this._sortedColumns.find(s=>s.columnIndex===e.columnIndex);if(t)switch(t.direction){case u.Ascending:this.removeSortColumn(e);break;case u.Descending:t.direction=u.Ascending;break;case u.Unset:t.direction=u.Descending;break}}setSortColumns(e){this._sortedColumns=[...e.map(t=>({...t}))]}removeSortColumn(e){typeof e=="number"?this._sortedColumns.splice(e,1):this._sortedColumns.splice(this._sortedColumns.indexOf(e),1),this._updateSortNumbers()}isSortColumn(e){return typeof e=="number"?this._sortedColumns.some(t=>t.columnIndex===e):this._sortedColumns.includes(e)}clearMultiSort(){this._sortedColumns=[]}getSortColumn(e){return this._sortedColumns.find(t=>t.columnIndex===e)}_updateSortNumbers(){this._sortedColumns.every(e=>typeof e.sortOrder=="number")&&this._sortedColumns.sort((e,t)=>e.sortOrder-t.sortOrder),this._sortedColumns.forEach((e,t)=>e.sortOrder=t+1)}}class ue{constructor(e,t=!1){this.data=e,this.selected=t}}class pe{constructor(e){this._adapter=e,this._tableRows=[],this._data=[],this._columnConfigurations=[],this._select=!1,this._multiselect=!0,this._dense=!1,this._roomy=!1,this._filter=!1,this._fixedHeaders=!1,this._layoutType=o.strings.DEFAULT_LAYOUT_TYPE,this._wrapContent=!0,this._resizable=!1,this._minResizeWidth=o.numbers.MIN_RESIZE_WIDTH,this._multiColumnSort=!1,this._selectCheckboxAlignment=T.Center,this._isAllSelected=!1,this._sortedColumnIndex=-1,this._rendered=!1,this._allowRowClick=!1,this._multiSortManager=new Le,this._rowClickListener=t=>this._onRowClick(t),this._rowDoubleClickListener=t=>this._onRowDoubleClick(t),this._selectRowListener=t=>this._onRowSelected(t),this._selectAllListener=t=>this._onSelectAll(t),this._sortableHeadCellKeydownListener=t=>this._onSortableHeadCellKeydown(t),this._headRowMouseDownListener=t=>this._onHeadRowMouseDown(t),this._headRowContextMenuListener=t=>this._onHeadRowContextMenu(t),this._documentMouseMoveListener=t=>this._onMouseMove(t),this._documentMouseUpListener=t=>this._onMouseUp(t),this._filterListener=(t,s)=>this._onFilter(t,s),this._selectionManager=new k(this._selectKey),this._hiddenColumnManager=new k}initialize(){this._adapter.initialize(),this._adapter.setHostAttribute(o.attributes.SELECT,this._select.toString()),this._adapter.setHostAttribute(o.attributes.MULTISELECT,this._multiselect.toString()),this._adapter.setHostAttribute(o.attributes.DENSE,this._dense.toString()),this._adapter.setHostAttribute(o.attributes.ROOMY,this._roomy.toString()),this._adapter.setHostAttribute(o.attributes.FILTER,this._filter.toString()),this._adapter.emitHostEvent(o.events.INITIALIZED,void 0,!1)}destroy(){this._resizeDescriptor=void 0,this._adapter.removeDocumentListener("mousemove",this._documentMouseMoveListener),this._adapter.removeDocumentListener("mouseup",this._documentMouseUpListener)}set data(e){Array.isArray(e)&&e.length>0?O(e[0])?this._data=e.map(t=>({...t})):this._data=[...e]:this._data=[],this._tableRows=this._data.map(t=>new ue(t,this._selectionManager.exists(t))),this._renderBody()}get data(){return this._data.map(e=>({...e}))}set columnConfigurations(e){this._columnConfigurations=e.map(t=>({...t})),this._hiddenColumnManager.clear(),this._columnConfigurations.forEach(t=>{t.hidden&&this._hiddenColumnManager.add(t)}),this._refreshTableSort(),this.render()}get columnConfigurations(){return this._columnConfigurations.map(e=>({...e}))}get _visibleColumnConfigurations(){return this._columnConfigurations.filter(e=>!this._hiddenColumnManager.exists(e))}get _tableConfiguration(){return{tableElement:this._adapter.getTableElement(),columnConfigurations:this._visibleColumnConfigurations,data:this._tableRows,clickListener:this._allowRowClick?this._rowClickListener:null,doubleClickListener:this._allowRowClick?this._rowDoubleClickListener:null,selectListener:this._select?this._selectRowListener:null,selectAllListener:this._multiselect?this._selectAllListener:null,sortableHeadCellKeydownListener:this._sortableHeadCellKeydownListener,headRowMouseDownListener:this._headRowMouseDownListener,headRowContextMenuListener:this._headRowContextMenuListener,filterListener:this._filter?this._filterListener:null,sortDirection:this._sortDirection,sortedColumn:this._sortedColumnIndex,multiColumnSort:this._multiColumnSort,filter:this._filter,wrapContent:this._wrapContent,fixedHeaders:this._fixedHeaders,layoutType:this._layoutType,dense:this._dense,resizable:this._resizable,rowCreatedCallback:this._rowCreatedCallback,cellCreatedCallback:this._cellCreatedCallback,selectAllTemplate:this._selectAllTemplate,selectCheckboxAlignment:this._selectCheckboxAlignment,tooltipSelect:this._tooltipSelect,tooltipSelectAll:this._tooltipSelectAll}}set select(e){this._select!==e&&(this._select=e,this._adapter.setSelectColumnVisibility(this._adapter.getTableElement(),this._select,this._selectRowListener,this._multiselect?this._selectAllListener:void 0,this._multiselect?this._selectAllTemplate:null,this._selectCheckboxAlignment,this._tableRows,this._tooltipSelect,this._tooltipSelectAll),this._updateSelections(!0),this._select?this._adapter.setHostAttribute(o.attributes.SELECT,this._select.toString()):this._adapter.removeHostAttribute(o.attributes.SELECT))}get select(){return this._select}set multiselect(e){this._multiselect!==e&&(this._multiselect=e,this._select&&(this._adapter.setSelectAllVisibility(this._adapter.getTableElement(),this._multiselect,this._multiselect?this._selectAllListener:null,this._multiselect?this.selectAllTemplate:null,this._selectCheckboxAlignment,this._tooltipSelectAll),this._updateSelections(!0)),this._adapter.setHostAttribute(o.attributes.MULTISELECT,this._multiselect.toString()))}get multiselect(){return this._multiselect}get selectKey(){return Array.isArray(this._selectKey)?[...this._selectKey]:this._selectKey}set selectKey(e){this._originalSelectKey!==e&&(Array.isArray(e)?(this._originalSelectKey=[...e],this._selectKey=[...e]):(this._originalSelectKey=e,this._selectKey=[e]),this._selectionManager.setKey(this._selectKey),this._updateSelections(!1))}get dense(){return this._dense}set dense(e){this._dense!==e&&(this._dense=e,this._adapter.setDense(this._adapter.getTableElement(),this._dense),this._adapter.setHostAttribute(o.attributes.DENSE,this._dense.toString()))}get roomy(){return this._roomy}set roomy(e){e!==this._roomy&&(this._roomy=e,this._applyRoomy())}set filter(e){this._filter!==e&&(this._filter=e,this._adapter.setFilterRow(this._tableConfiguration),this._adapter.setHostAttribute(o.attributes.FILTER,this._filter.toString()))}get filter(){return this._filter}set fixedHeaders(e){this._fixedHeaders!==e&&(this._fixedHeaders=e,this._adapter.setFixedHeaders(this._tableConfiguration))}get fixedHeaders(){return this._fixedHeaders}get layoutType(){return this._layoutType}set layoutType(e){this._layoutType!==e&&(this._layoutType=e,this._adapter.setTableLayoutType(this._tableConfiguration))}get wrapContent(){return this._wrapContent}set wrapContent(e){this._wrapContent!==e&&(this._wrapContent=e,this._adapter.setWrapContentState(this._tableConfiguration))}get resizable(){return this._resizable}set resizable(e){this._resizable!==e&&(this._resizable=e,this._adapter.setResizable(this._tableConfiguration))}get minResizeWidth(){return this._minResizeWidth}set minResizeWidth(e){this._minResizeWidth!==e&&(this._minResizeWidth=e,W(this._minResizeWidth)?this._minResizeWidth<0&&(this._minResizeWidth=0):this._minResizeWidth=o.numbers.MIN_RESIZE_WIDTH)}get allowRowClick(){return this._allowRowClick}set allowRowClick(e){this._allowRowClick!==e&&(this._allowRowClick=e,this._rendered&&(this._adapter.setRowClickListeners(this._adapter.getTableElement(),this._allowRowClick,this._rowClickListener,this._rowDoubleClickListener),this._adapter.setRowClickAttributes(this._adapter.getTableElement(),this._allowRowClick)))}get multiColumnSort(){return this._multiColumnSort}set multiColumnSort(e){e!==this._multiColumnSort&&(this._multiColumnSort=e,this._refreshTableSort(),this.render())}get selectCheckboxAlignment(){return this._selectCheckboxAlignment}set selectCheckboxAlignment(e){e!==this._selectCheckboxAlignment&&(this._selectCheckboxAlignment=e,this._adapter.setHostAttribute(o.attributes.SELECT_CHECKBOX_ALIGNMENT,e),this.render())}get tooltipSelect(){return this._tooltipSelect}set tooltipSelect(e){e!==this._tooltipSelect&&(this._tooltipSelect=e,typeof e=="string"&&this._adapter.setHostAttribute(o.attributes.TOOLTIP_SELECT,e),this.render())}get tooltipSelectAll(){return this._tooltipSelectAll}set tooltipSelectAll(e){e!==this._tooltipSelectAll&&(this._tooltipSelectAll=e,this._adapter.setHostAttribute(o.attributes.TOOLTIP_SELECT_ALL,e),this.render())}get selectAllTemplate(){return this._selectAllTemplate}set selectAllTemplate(e){e!==this._selectAllTemplate&&(this._selectAllTemplate=e,this.render())}get rowCreated(){return this._rowCreatedCallback}set rowCreated(e){this._rowCreatedCallback=e}get cellCreated(){return this._cellCreatedCallback}set cellCreated(e){this._cellCreatedCallback=e}isRowSelected(e){const t=g(Array.isArray(this._selectKey)?this._selectKey:[this._selectKey],e);return this.selectKey?!!this._selectionManager.getItems().find(s=>H(s,t)):this._selectionManager.exists(e)}getSelectedRows(){return this._selectionManager.getItems()}selectRows(e,t){if(!this._selectKey)throw new Error("You must set a selectKey to select rows.");(!this._multiselect||t)&&this.clearSelections(),e&&e.length&&(this._selectionManager.add(e),this._updateSelections(!t))}deselectRows(e){e&&e.length&&(this._selectionManager.remove(e),this._updateSelections(!1))}clearSelections(){const e=this._adapter.getTableElement();this._selectionManager.clear(),this._tableRows.forEach(t=>t.selected=!1),this._isAllSelected=!1,this._adapter.clearSelectedRows(e),this._select&&this._multiselect&&this._adapter.updateSelectAllState(e,!1)}hideColumn(e){const t=this._columnConfigurations[e];this._sortedColumnIndex===e&&(this._sortedColumnIndex=-1),this._hiddenColumnManager.exists(t)||(this._hiddenColumnManager.add(t),this.render())}showColumn(e){const t=this._columnConfigurations[e];this._hiddenColumnManager.exists(t)&&(this._hiddenColumnManager.remove(t),this.render())}isColumnHidden(e){const t=this._columnConfigurations[e];return!!t&&this._hiddenColumnManager.exists(t)}render(){this._adapter.emitHostEvent(o.events.BEFORE_BODY_RENDERED,void 0,!1),this._adapter.createTable(this._tableConfiguration),this._renderSelections(),this._rendered=!0,this._adapter.emitHostEvent(o.events.BODY_RENDERED,void 0,!1)}_renderBody(){this._rendered&&(this._adapter.emitHostEvent(o.events.BEFORE_BODY_RENDERED,void 0,!1),this._adapter.recreateTableBody(this._tableConfiguration),this._renderSelections(),this._adapter.emitHostEvent(o.events.BODY_RENDERED,void 0,!1))}_renderSelections(){this.select&&(this._isAllSelected=this._getSelectAllState(),this._multiselect&&this._adapter.updateSelectAllState(this._adapter.getTableElement(),this._isAllSelected,this._isIndeterminate(this._isAllSelected)));const e=this._selectionManager.getItems();e.length&&this._adapter.setSelectedRows(this._adapter.getTableElement(),this._selectKey,this._data,e,!1)}expandRow(e,t){if(!this._rendered)throw new Error("Cannot expand a row before the table has rendered.");if(e<0||e>this._tableRows.length)throw new Error(`Invalid row index: ${e}.`);return this._adapter.expandRow(this._tableConfiguration,e,t)}collapseRow(e){return!this._rendered||e<0||e>this._tableRows.length?Promise.resolve():this._adapter.collapseRow(this._tableConfiguration,e)}isRowExpanded(e){return this._adapter.isRowExpanded(this._tableConfiguration,e)}selectRowsByIndex(e,t){const s=e.map(i=>this._data[i]).filter(i=>!!i);this.selectRows(s,!t)}deselectRowsByIndex(e){const t=e.map(s=>this._data[s]).filter(s=>!!s);this.deselectRows(t)}_getSelectAllState(){return this._tableRows.length>0&&this._tableRows.every(e=>e.selected)}_updateSelections(e){this._tableRows.forEach(s=>s.selected=this._selectionManager.exists(s.data));const t=this._getSelectAllState();this._adapter.setSelectedRows(this._adapter.getTableElement(),this._selectKey,this._data,this._selectionManager.getItems(),e),(t!==this._isAllSelected||this._isIndeterminate(t))&&(this._isAllSelected=t,this._multiselect&&this._adapter.updateSelectAllState(this._adapter.getTableElement(),this._isAllSelected,this._isIndeterminate(this._isAllSelected)))}_onRowClick(e){if(e.stopImmediatePropagation(),e.target.matches(`[${o.attributes.SELECT_CHECKBOX}]`))return;const i=b(e).filter(c=>c.nodeType===1).find(c=>c.hasAttribute(o.attributes.CUSTOM_CELL_TEMPLATE));if(i&&i.hasAttribute(o.attributes.CUSTOM_CELL_TEMPLATE_STOP_PROPAGATION))return;const{index:r,data:a}=this._getSelectedRowFromEvent(e),d={index:r,data:a};this._adapter.emitHostEvent(o.events.ROW_CLICK,d,!0,!1)}_onRowDoubleClick(e){if(e.stopPropagation(),e.target.matches(`[${o.attributes.SELECT_CHECKBOX}]`))return;const t=this._getSelectedRowFromEvent(e),s={index:t.index,data:t.data};this._adapter.emitHostEvent(o.events.SELECT_DOUBLE,s,!0,!1)}_onRowSelected(e){if(e.type==="change"){e.preventDefault();return}if(e.type==="keydown"&&e.key!==" ")return;const t=this._getSelectedRowFromEvent(e);this._multiselect||this._tableRows.filter(a=>a.selected).forEach(a=>{H(a.data,g(this._selectKey,t.data))||this.deselectRows([a.data])});const s=!this._selectionManager.exists(t.data);this._adapter.updateSelectedState(t.rowElement,s),s?this._selectionManager.add(t.data):this._selectionManager.remove(t.data),this._tableRows[t.index].selected=s;let i=[t.index],l=!1;if(this._multiselect){if(e.shiftKey&&this._previouslyClickedRow&&(document.getSelection()?.removeAllRanges(),i=this._shiftSelectRows(t),i.includes(this._previouslyClickedRow.index))){const a=i.indexOf(this._previouslyClickedRow.index);i.splice(a,1)}l=this._getSelectAllState(),this._adapter.updateSelectAllState(this._adapter.getTableElement(),l,this._isIndeterminate(l))}for(const r of i){const a=this._tableRows[r].data,c={selected:this._selectionManager.exists(a),index:r,data:a};this._adapter.emitHostEvent(o.events.SELECT,c,!0,!1)}if(this._isAllSelected!==l){this._isAllSelected=l;const r={status:this._isAllSelected,count:this._tableRows.filter(a=>a.selected).length,data:[...this._data],targetType:"row"};this._adapter.emitHostEvent(o.events.SELECT_ALL,r,!0,!1)}this._previouslyClickedRow={...t}}_getSelectedRowFromEvent(e){const s=b(e).find(a=>a.tagName==="TR"),i=s.parentElement,l=this._getNonExpandedRows(i).findIndex(a=>a===s),r=this._tableRows[l].data;return{rowElement:s,index:l,data:r}}_getNonExpandedRows(e){return Array.from(e.rows).filter(t=>!t.classList.contains(o.classes.TABLE_ROW_EXPANDABLE_CONTENT))}_onSelectAll(e){e.stopPropagation(),this._isAllSelected=!this._isAllSelected;const t=this._adapter.getTableElement();this._adapter.updateSelectAllState(t,this._isAllSelected),this._tableRows.forEach((i,l)=>{i.selected=this._isAllSelected,this._isAllSelected?this._selectionManager.add(i.data):this._selectionManager.remove(i.data);const r=n.getRowByIndex(t,l);r&&this._adapter.updateSelectedState(r,this._isAllSelected)});const s={status:this._isAllSelected,count:this._tableRows.filter(i=>i.selected).length,data:[...this._data],targetType:"select-all"};this._adapter.emitHostEvent(o.events.SELECT_ALL,s,!0,!1)}_onHeadRowContextMenu(e){e.ctrlKey&&e.preventDefault()}_onHeadRowMouseDown(e){if(e.button!==0)return;const t=b(e),s=e.target,i=t.find(a=>a.tagName==="TR"),l=t.find(a=>a.tagName==="TH"),r=Array.from(i.cells).findIndex(a=>a===l);this._headCellMouseDownIndex=r,s!==l&&s.classList.contains(o.classes.TABLE_RESIZE_HANDLE)&&(this._resizeDescriptor={element:l,startWidth:l.offsetWidth,startX:e.pageX,width:l.offsetWidth,index:this._select?r-1:r},this._adapter.addDocumentListener("mousemove",this._documentMouseMoveListener),this._adapter.setResizeColumnVisibility(this._tableConfiguration,r,!0)),this._adapter.addDocumentListener("mouseup",this._documentMouseUpListener)}_onMouseMove(e){if(this._resizeDescriptor){let t=this._resizeDescriptor.startWidth+(e.pageX-this._resizeDescriptor.startX);t<this._minResizeWidth&&(t=this._minResizeWidth),this._resizeDescriptor.width=t,this._resizeDescriptor.element.style.width=`${t}px`,this._adapter.addTableClass(o.classes.TABLE_RESIZING)}}_onMouseUp(e){if(this._adapter.removeDocumentListener("mousemove",this._documentMouseMoveListener),this._adapter.removeDocumentListener("mouseup",this._documentMouseUpListener),this._adapter.removeTableClass(o.classes.TABLE_RESIZING),this._headCellMouseDownIndex!==void 0){if(this._resizeDescriptor){this._adapter.normalizeColumnWidths(this._tableConfiguration),this._adapter.setResizeColumnVisibility(this._tableConfiguration,this._headCellMouseDownIndex,!1);const t={index:this._resizeDescriptor.index,width:this._resizeDescriptor.width};this._adapter.emitHostEvent(o.events.COLUMN_RESIZE,t),this._resizeDescriptor=void 0}else this._tableConfiguration.tableElement.tHead.contains(e.target)&&(this._multiColumnSort?this._onMultiSort(this._headCellMouseDownIndex,e.ctrlKey):this._onSort(this._headCellMouseDownIndex));this._headCellMouseDownIndex=void 0}}_onSortableHeadCellKeydown(e){if(e.key===" "||e.key==="Enter"){const t=b(e),s=t.find(r=>r.tagName==="TR"),i=t.find(r=>r.tagName==="TH"),l=Array.from(s.cells).findIndex(r=>r===i);this._onSort(l)}}_onSort(e){const t=this._select?e-1:e,s=t>=0?this._visibleColumnConfigurations[t]:null;if(!s||!s.sortable)return;let i=u.Ascending;const l=t===this._sortedColumnIndex,r=this._sortDirection===u.Ascending||this._sortDirection===void 0,a=l&&this._sortDirection===u.Descending;l&&r&&(i=u.Descending),a&&!s.preventUnsort&&(i=u.Unset);const d={direction:i,columnIndex:t};if(this._adapter.emitHostEvent(o.events.SORT,d,!0,!0)){if(l&&this._sortDirection===u.Descending&&!s.preventUnsort){this._adapter.removeColumnSort(this._adapter.getTableElement(),this._select?this._sortedColumnIndex+1:this._sortedColumnIndex),this._sortedColumnIndex=-1;return}this._sortDirection=i,t===this._sortedColumnIndex?this._adapter.setSortDirection(this._adapter.getTableElement(),e,this._sortDirection):(this._sortedColumnIndex>=0&&this._adapter.removeColumnSort(this._adapter.getTableElement(),this._select?this._sortedColumnIndex+1:this._sortedColumnIndex),this._sortedColumnIndex=t,this._adapter.setSortedColumn(this._adapter.getTableElement(),e,this._sortDirection))}}_onMultiSort(e,t){const s=this._select?e-1:e,i=s>=0?this._visibleColumnConfigurations[s]:null;if(!i||!i.sortable)return;const l=this._multiSortManager.sortedColumns,r=this._multiSortManager.getSortColumn(s);r?this._multiSortManager.updateSortColumn(r):t?this._multiSortManager.addSortColumn({direction:u.Descending,columnIndex:s,propertyName:i.property}):(this._multiSortManager.clearMultiSort(),this._multiSortManager.addSortColumn({direction:u.Descending,columnIndex:s,propertyName:i.property}));const a=this._multiSortManager.sortedColumns.map(_=>({..._}));if(!this._adapter.emitHostEvent(o.events.SORT,a,!0,!0)){this._multiSortManager.setSortColumns(l);return}const c=this._multiSortManager.sortedColumns.length>1;for(let _=0;_<this._visibleColumnConfigurations.length;_++){const E=this._select?_+1:_;if(!this._multiSortManager.isSortColumn(_))this._adapter.removeColumnSort(this._adapter.getTableElement(),E),n.setMultiSortColumnSortNumber(this._adapter.getTableElement(),c,E,null);else{const f=this._multiSortManager.getSortColumn(_);f&&(this._adapter.setSortedColumn(this._adapter.getTableElement(),E,f.direction),n.setMultiSortColumnSortNumber(this._adapter.getTableElement(),c,E,f.sortOrder||null))}}}_onFilter(e,t){const s={value:e,columnIndex:t};this._adapter.emitHostEvent(o.events.FILTER,s,!0,!1)}_shiftSelectRows(e){const t=[];if(this._previouslyClickedRow){const s=this._previouslyClickedRow.index,i=e.index;let l=i>=s?s:i,r=i>=s?i:s;r+=r>l?1:0,l+=l>r?1:0;let a=_=>this.selectRows(_,!1);const d=this._tableRows.find(_=>_.selected&&_.data===e.data),c=this._tableRows.find(_=>_.data===this._previouslyClickedRow?.data&&!_.selected);(!d||c)&&(a=_=>this.deselectRows(_));for(let _=l;_<r;_++)t.push(_);a(this.data.filter((_,E)=>t.includes(E)))}return t}_isIndeterminate(e){return!e&&this.getSelectedRows().length>0&&this._data.length!==this.getSelectedRows().length}_applyRoomy(){this._adapter.setRoomy(this._adapter.getTableElement(),this._roomy),this._adapter.setHostAttribute(o.attributes.ROOMY,this._roomy.toString())}_refreshTableSort(){if(this._sortedColumnIndex=this._visibleColumnConfigurations.findIndex(e=>e.initialSort),this._sortedColumnIndex>=0&&this._sortDirection===void 0){const e=this._visibleColumnConfigurations[this._sortedColumnIndex];e.initialSort===!0&&e.sortDirection?this._sortDirection=e.sortDirection:typeof e.initialSort=="object"&&e.initialSort.direction&&(this._sortDirection=e.initialSort.direction)}if(this._multiColumnSort){const e=[];this._visibleColumnConfigurations.forEach((t,s)=>{typeof t.initialSort=="object"&&e.push({columnIndex:s,direction:t.initialSort.direction,sortOrder:t.initialSort.sortOrder,propertyName:t.property})}),this._multiSortManager.setSortColumns(e)}}}var fe=Object.defineProperty,Se=Object.getOwnPropertyDescriptor,C=(h,e,t,s)=>{for(var i=s>1?void 0:s?Se(e,t):e,l=h.length-1,r;l>=0;l--)(r=h[l])&&(i=(s?r(e,t,i):r(i))||i);return s&&i&&fe(e,t,i),i};let m=class extends Z{static get observedAttributes(){return[o.attributes.SELECT,o.attributes.MULTISELECT,o.attributes.SELECT_KEY,o.attributes.DENSE,o.attributes.ROOMY,o.attributes.FILTER,o.attributes.FIXED_HEADERS,o.attributes.LAYOUT_TYPE,o.attributes.WRAP_CONTENT,o.attributes.RESIZABLE,o.attributes.MIN_RESIZE_WIDTH,o.attributes.ALLOW_ROW_CLICK,o.attributes.MULTI_COLUMN_SORT,o.attributes.SELECT_CHECKBOX_ALIGNMENT,o.attributes.TOOLTIP_SELECT,o.attributes.TOOLTIP_SELECT_ALL]}constructor(){super(),ee.define(te),this._core=new pe(new Ce(this))}initializedCallback(){this._core.initialize()}connectedCallback(){this._core.initialize()}disconnectedCallback(){this._core.destroy()}attributeChangedCallback(h,e,t){switch(h){case o.attributes.SELECT:this.select=A(t);break;case o.attributes.MULTISELECT:this.multiselect=A(t);break;case o.attributes.SELECT_KEY:this.selectKey=t;break;case o.attributes.DENSE:this.dense=A(t);break;case o.attributes.ROOMY:this.roomy=A(t);break;case o.attributes.FILTER:this.filter=A(t);break;case o.attributes.FIXED_HEADERS:this.fixedHeaders=A(t);break;case o.attributes.LAYOUT_TYPE:this.layoutType=t;break;case o.attributes.WRAP_CONTENT:this.wrapContent=A(t);break;case o.attributes.RESIZABLE:this.resizable=A(t);break;case o.attributes.MIN_RESIZE_WIDTH:this.minResizeWidth=J(t);break;case o.attributes.ALLOW_ROW_CLICK:this.allowRowClick=A(t);break;case o.attributes.MULTI_COLUMN_SORT:this.multiColumnSort=A(t);break;case o.attributes.SELECT_CHECKBOX_ALIGNMENT:this.selectCheckboxAlignment=this.getAttribute(o.attributes.SELECT_CHECKBOX_ALIGNMENT)||T.Center;break;case o.attributes.TOOLTIP_SELECT:this.tooltipSelect=t;break;case o.attributes.TOOLTIP_SELECT_ALL:this.tooltipSelectAll=t;break}}hideColumn(h){this._core.hideColumn(h)}showColumn(h){this._core.showColumn(h)}isColumnHidden(h){return this._core.isColumnHidden(h)}getSelectedRows(){return this._core.getSelectedRows()}selectRow(h){this._core.selectRows([h],!1)}selectRows(h,e=!1){this._core.selectRows(h,!e)}deselectRow(h){this._core.deselectRows([h])}deselectRows(h){this._core.deselectRows(h)}clearSelections(){this._core.clearSelections()}render(){this._core.render()}expandRow(h,e){return this._core.expandRow(h,e)}collapseRow(h){return this._core.collapseRow(h)}isRowExpanded(h){return this._core.isRowExpanded(h)}selectRowsByIndex(h,e){typeof h=="number"?this._core.selectRowsByIndex([h],e):Array.isArray(h)&&this._core.selectRowsByIndex(h,e)}deselectRowsByIndex(h){typeof h=="number"?this._core.deselectRowsByIndex([h]):Array.isArray(h)&&this._core.deselectRowsByIndex(h)}isRowSelected(h){return this._core.isRowSelected(h)}};C([L()],m.prototype,"data",2);C([L()],m.prototype,"columnConfigurations",2);C([L()],m.prototype,"select",2);C([L()],m.prototype,"multiselect",2);C([L()],m.prototype,"selectKey",2);C([L()],m.prototype,"tooltipSelect",2);C([L()],m.prototype,"tooltipSelectAll",2);C([L()],m.prototype,"dense",2);C([L()],m.prototype,"roomy",2);C([L()],m.prototype,"filter",2);C([L()],m.prototype,"fixedHeaders",2);C([L()],m.prototype,"layoutType",2);C([L()],m.prototype,"wrapContent",2);C([L()],m.prototype,"resizable",2);C([L()],m.prototype,"minResizeWidth",2);C([L()],m.prototype,"allowRowClick",2);C([L()],m.prototype,"multiColumnSort",2);C([L()],m.prototype,"rowCreated",2);C([L()],m.prototype,"cellCreated",2);C([L()],m.prototype,"selectAllTemplate",2);C([L()],m.prototype,"selectCheckboxAlignment",2);m=C([G({name:o.elementName,dependencies:[se,U,oe,re,ne]})],m);export{M as F,u as S};
