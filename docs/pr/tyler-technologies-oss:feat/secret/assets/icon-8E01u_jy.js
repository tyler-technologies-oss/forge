import{C as A,o as m,j as x,B as E,k as w}from"./constants-DzQy6WDX.js";import{B as I,c as _}from"./base-adapter-C8aSF3nG.js";import"./service-adapter-CffG5Lhq.js";import{c as b}from"./feature-detection-B-sRDmdg.js";import"./index-5CPwzmQS.js";function T(s,e){const t=document.createElement("div");t.innerHTML=s;for(let n=t.childNodes.length-1;n>=0;n--)t.childNodes[n].nodeName.toLowerCase()!=="svg"&&t.removeChild(t.childNodes[n]);const r=t.firstElementChild;return r?.nodeName.toLowerCase()==="svg"&&y(r)?(e&&r.setAttribute("viewBox",e),!r.hasAttribute("viewBox")&&e&&r.setAttribute("viewBox",e),r.removeAttribute("height"),r.removeAttribute("width"),r):null}function y(s){if(s.nodeType!==1)return!0;if(s.nodeName.toLowerCase()==="script"||s.querySelector("script"))return!1;const e=Array.from(s.attributes);for(const r of e)if(typeof r.name=="string"&&r.name.toLowerCase().startsWith("on"))return!1;const t=Array.from(s.childNodes);for(const r of t)if(!y(r))return!1;return!0}const L=`${A}icon`,g={NAME:"name",SRC:"src",LAZY:"lazy",EXTERNAL:"external",EXTERNAL_TYPE:"external-type",VIEWBOX:"viewbox",THEME:"theme"},N={...g},C={LAZY_ROOT_MARGIN:50,DEFAULT_WIDTH:24,DEFAULT_HEIGHT:24},O={DEFAULT_NETWORK_BASE_URL:`${m}v1/icons/svg`,ALL_NETWORK_BASE_URL:`${m}v1/icons/svg/all`},o={elementName:L,observedAttributes:g,attributes:N,numbers:C,strings:O},p="forgeIcons";class z extends I{constructor(e){super(e)}canLazyLoad(){return!!window.IntersectionObserver}observeVisibility(e){this._observer=new IntersectionObserver(t=>{t.some(r=>r.isIntersecting)&&(this.destroyVisibilityObserver(),e())},{rootMargin:`${o.numbers.LAZY_ROOT_MARGIN}px`}),this._observer.observe(this._component)}destroyVisibilityObserver(){this._observer&&(this._observer.disconnect(),this._observer=void 0)}setContent(e){const t=this._component.shadowRoot;t.querySelectorAll(":not(style)").forEach(r=>r.remove()),e&&(this._component.viewbox&&e.setAttribute("viewBox",this._component.viewbox),e.setAttribute("aria-hidden","true"),t.appendChild(e))}setViewBox(e){this._component.shadowRoot?.querySelector("svg")?.setAttribute("viewBox",e)}}const i=class i{static get _icons(){return window[p]||(window[p]=new Map),window[p]}static define(e,t){if(Array.isArray(e))return e.filter(h=>i._isIconObject(h)).forEach(h=>i._register(h.name,h.data));const{name:r,data:n}=i._parseIcon(e,t);i._register(r,n)}static remove(e){const t=i._isIconObject(e)?e.name:e;i._icons.delete(t)}static removeListener(e,t){const r=i._listeners.get(e);Array.isArray(r)&&r.includes(t)&&r.splice(r.indexOf(t),1)}static clear(){i._icons.clear(),i._listeners.clear()}static get(e){return i._icons.get(e)}static setNode(e,t){const r=i.get(e);r&&(r.node=t)}static getIconNames(){return Array.from(i._icons.keys())}static awaitIcon(e,t){if(i._icons.has(e)){t();return}const r=i._listeners.get(e)??[];i._listeners.set(e,[...r,t])}static get size(){return i._icons.size}static _register(e,t){i._icons.set(e,{raw:t,node:void 0}),i._invalidateListeners(e)}static _invalidateListeners(e){const t=i._listeners.get(e);Array.isArray(t)&&t.length&&(t.forEach(r=>r()),i._listeners.delete(e))}static _parseIcon(e,t=""){return i._isIconObject(e)?e:{name:e,data:t}}static _isIconObject(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"name")&&Object.prototype.hasOwnProperty.call(e,"data")}};i._listeners=new Map;let c=i;const f=new Map;function u(s,e,t=!0){if(!s||!s.includes("svg"))return null;!e&&!s.includes("viewBox")&&(e=`0 0 ${o.numbers.DEFAULT_WIDTH} ${o.numbers.DEFAULT_HEIGHT}`);const r=T(s,e);return t&&r&&r.setAttribute("part","svg"),r}function R(s){return c.get(s)}function B(s,e){c.awaitIcon(s,e)}function U(s,e){c.removeListener(s,e)}function S(s,e){let t=f.get(s);if(!t)if(typeof fetch<"u"&&typeof document<"u")t=fetch(s).then(async r=>{if(r.ok){const n=await r.text()||"";return c.define({name:e,data:n}),f.delete(s),n}return c.define({name:e,data:""}),""}),f.set(s,t);else return c.define({name:e,data:""}),Promise.resolve("");return t||Promise.resolve("")}function v(s){return["standard","extended","custom","all"].includes(s)?s:"all"}class H{constructor(e){this._adapter=e,this._lazy=!1,this._external=!1,this._externalType="all",this._lazyListener=this._loadIcon.bind(this)}initialize(){this._applyIcon()}destroy(){this._adapter.destroyVisibilityObserver(),this._clearIconQueue(),this._tryRemoveListener()}_safeApplyIcon(){this._adapter.isConnected&&(this._clearIconQueue(),this._queueIconUpdate())}_tryRemoveListener(){this._registrationListener&&this._name&&U(this._name,this._registrationListener)}_applyIcon(){this._lazy&&this._adapter.canLazyLoad()?this._adapter.observeVisibility(this._lazyListener):this._loadIcon()}_clearIconQueue(){this._applyTimer&&(clearTimeout(this._applyTimer),this._applyTimer=void 0)}_queueIconUpdate(){this._applyTimer=window.setTimeout(()=>{this._applyTimer=void 0,this._applyIcon()})}async _loadIcon(){try{if(this._src){const e=u(this._src,this._viewbox);this._setIconContent(e)}else if(this._name){const e=this._tryGetIcon(this._name);if(e?.node){this._setIconContent(e.node);return}let t=null;if(e)e.raw&&(t=u(e.raw,this._viewbox));else{if(!this._external){this._registrationListener=()=>this._applyIcon(),B(this._name,this._registrationListener),this._adapter.setContent(null);return}this._externalType||(this._externalType="standard");const r=this._getExternalUrl(this._name,this._externalType);if(r){const n=await S(r,this._name);n&&(t=u(n,this._viewbox))}}t&&(e?.node||c.setNode(this._name,t),this._setIconContent(t))}else this._adapter.setContent(null)}catch(e){throw this._adapter.setContent(null),e}}_setIconContent(e){const t=e?e.cloneNode(!0):null;t&&this._adapter.setContent(t)}_tryGetIcon(e){return R(e)}_getExternalUrl(e,t){if(typeof this._externalUrlBuilder=="function")return this._externalUrlBuilder(e,t);const r=v(this._externalType);return["standard","extended","custom"].includes(r)?`${o.strings.DEFAULT_NETWORK_BASE_URL}/${r}/${e}.svg`:`${o.strings.ALL_NETWORK_BASE_URL}/${e}.svg`}get name(){return this._name}set name(e){this._name!==e&&(this._registrationListener&&this._tryRemoveListener(),this._name=(e||"").replace(/\s+/,""),this._safeApplyIcon(),this._adapter.toggleHostAttribute(o.attributes.NAME,!!this._name,this._name))}get src(){return this._src}set src(e){this._src!==e&&(this._src=e,this._adapter.isConnected&&this._applyIcon(),this._adapter.toggleHostAttribute(o.attributes.SRC,!!this._src,this._src))}get lazy(){return this._lazy}set lazy(e){this._lazy!==e&&(this._lazy=e,this._safeApplyIcon(),this._adapter.toggleHostAttribute(o.attributes.LAZY,this._lazy))}get external(){return this._external}set external(e){this._external!==e&&(this._external=e,this._safeApplyIcon(),this._adapter.toggleHostAttribute(o.attributes.EXTERNAL,this._external))}get externalType(){return this._externalType}set externalType(e){e=v(e),this._externalType!==e&&(this._externalType=e,this._safeApplyIcon(),this._adapter.setHostAttribute(o.attributes.EXTERNAL_TYPE,`${this._externalType}`))}get externalUrlBuilder(){return this._externalUrlBuilder}set externalUrlBuilder(e){this._externalUrlBuilder!==e&&(this._externalUrlBuilder=e,this._safeApplyIcon())}get viewbox(){return this._viewbox}set viewbox(e){this._viewbox!==e&&(this._viewbox=e,this._adapter.setViewBox(this._viewbox),this._adapter.setHostAttribute(o.attributes.VIEWBOX,`${this.viewbox}`))}get theme(){return this._theme}set theme(e){this._theme!==e&&(this._theme=e,this._adapter.setHostAttribute(o.attributes.THEME,this._theme))}layout(){this._adapter.isConnected&&this._applyIcon()}}const M=`<template></template>
`,P=":host{--_icon-color: var(--forge-icon-color, currentColor);--_icon-size: var(--forge-icon-size, 1em);--_icon-width: var(--forge-icon-width, var(--_icon-size));--_icon-height: var(--forge-icon-height, var(--_icon-size));--_icon-font-size: var(--forge-icon-font-size, calc(var(--forge-typography-font-size, 1rem) * 1.5))}:host{display:inline-block;box-sizing:content-box;contain:content;font-size:var(--_icon-font-size)}:host([hidden]){display:none}svg{width:var(--_icon-width);height:var(--_icon-height);display:block;fill:var(--_icon-color);stroke:var(--_icon-color);stroke-width:0}:host([theme=primary]){--_icon-color: var(--forge-icon-color, var(--forge-theme-primary, #3f51b5))}:host([theme=secondary]){--_icon-color: var(--forge-icon-color, var(--forge-theme-secondary, #ffc107))}:host([theme=tertiary]){--_icon-color: var(--forge-icon-color, var(--forge-theme-tertiary, #3d5afe))}:host([theme=success]){--_icon-color: var(--forge-icon-color, var(--forge-theme-success, #2e7d32))}:host([theme=error]){--_icon-color: var(--forge-icon-color, var(--forge-theme-error, #b00020))}:host([theme=warning]){--_icon-color: var(--forge-icon-color, var(--forge-theme-warning, #d14900))}:host([theme=text-medium]){--_icon-color: var(--forge-icon-color, var(--forge-theme-text-medium, rgba(0, 0, 0, .6)))}:host([theme=text-low]){--_icon-color: var(--forge-icon-color, var(--forge-theme-text-low, rgba(0, 0, 0, .38)))}";var $=Object.defineProperty,D=Object.getOwnPropertyDescriptor,l=(s,e,t,r)=>{for(var n=r>1?void 0:r?D(e,t):e,h=s.length-1,d;h>=0;h--)(d=s[h])&&(n=(r?d(e,t,n):d(n))||n);return r&&n&&$(e,t,n),n};let a=class extends E{static get observedAttributes(){return Object.values(o.observedAttributes)}constructor(){super(),w(this,M,P),this._core=new H(new z(this))}connectedCallback(){this._core.initialize()}disconnectedCallback(){this._core.destroy()}attributeChangedCallback(s,e,t){switch(s){case o.observedAttributes.NAME:this.name=t;break;case o.observedAttributes.SRC:this.src=t;break;case o.observedAttributes.LAZY:this.lazy=b(t);break;case o.observedAttributes.EXTERNAL:this.external=b(t);break;case o.observedAttributes.EXTERNAL_TYPE:this.externalType=t;break;case o.observedAttributes.VIEWBOX:this.viewbox=t;break;case o.observedAttributes.THEME:this.theme=t;break}}layout(){this._core.layout()}};l([_()],a.prototype,"name",2);l([_()],a.prototype,"src",2);l([_()],a.prototype,"lazy",2);l([_()],a.prototype,"external",2);l([_()],a.prototype,"externalType",2);l([_()],a.prototype,"externalUrlBuilder",2);l([_()],a.prototype,"viewbox",2);l([_()],a.prototype,"theme",2);a=l([x({name:o.elementName})],a);export{c as I,a,o as b};
