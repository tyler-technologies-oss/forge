import{C as f,p as y,q as b,v as N,n as g,B as u,o as E,d as D}from"./constants-ngK8be3i.js";import{B as C,c as I}from"./base-adapter-uOfGA2wD.js";const O=`${f}view-switcher`,w={ROOT:"forge-view-switcher",VIEW_HIDDEN:"forge-view-switcher__view--hidden",VIEW_SWITCHER_SLIDE:"forge-view-switcher--slide",VIEW_SWITCHER_FADE:"forge-view-switcher--fade"},A={ROOT:`.${w.ROOT}`,DEFAULT_SLOT:"slot:not([name])",VIEW_HIDDEN:`.${w.VIEW_HIDDEN}`},H={INDEX:"index",ANIMATION_TYPE:"animation-type"},S={DEFAULT_TRANSITION_DURATION:500},n={elementName:O,attributes:H,classes:w,selectors:A,numbers:S};var d=(r=>(r.Left="left",r.Right="right",r))(d||{}),o=(r=>(r.None="none",r.Slide="slide",r.Fade="fade",r))(o||{});class L extends C{constructor(e){super(e),this._rootElement=y(e,n.selectors.ROOT),this._slotElement=y(e,n.selectors.DEFAULT_SLOT)}getViewCount(){return this._getViews().length}startViewObserver(e){this._viewObserver=new MutationObserver(e),this._viewObserver.observe(this._component,{childList:!0})}stopViewObserver(){this._viewObserver&&this._viewObserver.disconnect()}initializeSlideViews(e){let i=this._getViews();i.forEach((t,s)=>{if(t.style.removeProperty("opacity"),t.style.removeProperty("display"),s===e){i[e].classList.remove(n.classes.VIEW_HIDDEN),t.style.removeProperty("visibility");return}t.style.transition="none",t.classList.add(n.classes.VIEW_HIDDEN),t.style.visibility="hidden",s>e?t.style.transform="translate3d(100%, 0, 0)":t.style.transform="translate3d(-100%, 0, 0)"}),window.requestAnimationFrame(()=>{i=this._getViews(),i.forEach((t,s)=>{s!==e&&t.style.removeProperty("transition")})})}initializeFadeViews(e){const i=this._getViews();i.forEach((t,s)=>{if(t.style.removeProperty("transform"),t.style.removeProperty("display"),s===e){t.classList.remove(n.classes.VIEW_HIDDEN),t.style.removeProperty("visibility");return}t.classList.add(n.classes.VIEW_HIDDEN),t.style.visibility="hidden"}),i[e]&&(i[e].style.opacity="1")}setActiveView(e){const i=this._getViews();i.forEach((t,s)=>{s!==e&&(t.classList.add(n.classes.VIEW_HIDDEN),t.style.display="none")}),i[e]&&(i[e].classList.remove(n.classes.VIEW_HIDDEN),i[e].style.removeProperty("display"))}hideInactiveViews(e){this._getViews().forEach((t,s)=>{if(t.style.removeProperty("opacity"),t.style.removeProperty("transform"),t.style.removeProperty("visibility"),s===e){t.classList.remove(n.classes.VIEW_HIDDEN);return}t.classList.add(n.classes.VIEW_HIDDEN),t.style.display="none"})}async transitionToView(e,i,t,s){const h=this._getViews(),a=h[e],l=h[i];return new Promise(T=>{l.style.removeProperty("visibility"),window.requestAnimationFrame(()=>{let _;switch(t){case o.Slide:this._slideToView(a,l,s),_="transform";break;case o.Fade:this._fadeToView(a,l),_="opacity";break;default:return}this._animateHeight(a,l),a?a.addEventListener("transitionend",v):l.classList.remove(n.classes.VIEW_HIDDEN);function v(V){V.propertyName===_&&(a.removeEventListener("transitionend",v),l.classList.remove(n.classes.VIEW_HIDDEN),T())}})})}_slideToView(e,i,t){t===d.Left?(e&&(e.style.transform="translate3d(-100%, 0, 0)"),i.style.transform="translate3d(0, 0, 0)"):(e&&(e.style.transform="translate3d(100%, 0, 0)"),i.style.transform="translate3d(0, 0, 0)")}_fadeToView(e,i){e&&(e.style.opacity="0"),i.style.opacity="1"}_animateHeight(e,i){const t=e?this._getViewHeight(e):0,s=this._getViewHeight(i);t!==s&&(this._rootElement.addEventListener("transitionend",this._onRootTransitionEnd.bind(this)),this._setHeight(t),window.requestAnimationFrame(()=>{window.requestAnimationFrame(()=>{this._setHeight(s)})}))}_onRootTransitionEnd(e){e.propertyName==="height"&&(this._rootElement.removeEventListener("transitionend",this._onRootTransitionEnd),this._rootElement.style.removeProperty("height"))}setAnimationType(e){switch(b([n.classes.VIEW_SWITCHER_SLIDE,n.classes.VIEW_SWITCHER_FADE],this._component),e){case o.Slide:this._component.classList.add(n.classes.VIEW_SWITCHER_SLIDE);break;case o.Fade:this._component.classList.add(n.classes.VIEW_SWITCHER_FADE);break}}_getViews(){return this._slotElement.assignedNodes().filter(e=>e.nodeType===1)}_setHeight(e){this._rootElement.style.height=`${e}px`}_getViewHeight(e){let i=0;const t=e.children.length?Array.from(e.children):[e];for(const s of t){const h=window.getComputedStyle(s),a=parseFloat(h.marginTop)+parseFloat(h.marginBottom);i+=Math.ceil(s.offsetHeight+a)}return i}}class P{constructor(e){this._adapter=e,this._viewCount=0,this._viewIndex=0,this._animationType=o.None,this._viewsChangedListener=()=>this._onViewsChanged()}initialize(){this._viewCount=this._adapter.getViewCount(),this._adapter.startViewObserver(this._viewsChangedListener),this._adapter.setAnimationType(this._animationType),this._viewCount&&this._initializeAnimationType()}disconnect(){this._adapter.stopViewObserver()}_initializeAnimationType(){switch(this._animationType){case o.Slide:this._adapter.initializeSlideViews(this._viewIndex);break;case o.Fade:this._adapter.initializeFadeViews(this._viewIndex);break;case o.None:default:this._adapter.hideInactiveViews(this._viewIndex);break}}_onViewsChanged(){if(this._viewCount=this._adapter.getViewCount(),this._viewCount===0&&(this._viewIndex=0),this._viewCount&&this._initializeAnimationType(),this._viewCount>0&&this._viewIndex>=this._viewCount){const e=this._viewIndex;this._viewIndex=this._viewCount>0?this._viewCount-1:0,this._goToView(e,this._viewCount)}}async _goToView(e,i){if(this._viewCount=N(i)?i:this._adapter.getViewCount(),!(!(this._viewIndex>=0&&this._viewIndex<=this._viewCount-1)||e===this._clampedViewIndex(this._viewIndex,this._viewCount)))switch(this._animationType){case o.Slide:const s=this._viewIndex>e?d.Left:d.Right;await this._adapter.transitionToView(e,this._viewIndex,o.Slide,s),this._adapter.initializeSlideViews(this._viewIndex);break;case o.Fade:await this._adapter.transitionToView(e,this._viewIndex,o.Fade),this._adapter.initializeFadeViews(this._viewIndex);break;case o.None:default:this._adapter.setActiveView(this._viewIndex);break}}_clampedViewIndex(e,i){return e<0?e=0:e>i-1&&(e=i>0?i-1:0),e}next(){this.index++}previous(){this.index--}goToStart(){this.index=0}goToEnd(){this.index=this._viewCount-1}get index(){return this._viewIndex}set index(e){if(this._viewIndex!==e){const i=this._viewIndex;this._viewIndex=e,this._goToView(i),this._adapter.setHostAttribute(n.attributes.INDEX,this._viewIndex.toString())}}get animationType(){return this._animationType}set animationType(e){this._animationType!==e&&(this._animationType=e,this._initializeAnimationType(),this._adapter.setAnimationType(this._animationType),this._adapter.setHostAttribute(n.attributes.ANIMATION_TYPE,this._animationType))}}const x=`${f}view`,W={elementName:x},F=`<template>
  <slot></slot>
</template>
`,R=":host{display:block}:host([hidden]){display:none}";var z=Object.defineProperty,$=Object.getOwnPropertyDescriptor,M=(r,e,i,t)=>{for(var s=t>1?void 0:t?$(e,i):e,h=r.length-1,a;h>=0;h--)(a=r[h])&&(s=(t?a(e,i,s):a(s))||s);return t&&s&&z(e,i,s),s};let p=class extends u{constructor(){super(),E(this,F,R)}};p=M([g({name:W.elementName})],p);const k=`<template>
  <div class="forge-view-switcher" part="root">
    <slot></slot>
  </div>
</template>
`,q=".forge-view-switcher{height:var(--forge-view-switcher-height, auto);width:var(--forge-view-switcher-width, auto);position:relative;overflow:hidden;transition:height var(--forge-animation-duration-medium2, .3s) cubic-bezier(.35,0,.25,1)}.forge-view-switcher ::slotted(.forge-view-switcher__view--hidden){position:absolute;top:0;right:0;bottom:0;left:0}:host{height:var(--forge-view-switcher-height, auto);width:var(--forge-view-switcher-width, auto);display:block}:host([hidden]){display:none}:host(.forge-view-switcher--slide) ::slotted(forge-view){transition:transform var(--forge-animation-duration-medium2, .3s) cubic-bezier(.35,0,.25,1);will-change:transform}:host(.forge-view-switcher--fade) ::slotted(forge-view){transition:opacity var(--forge-animation-duration-medium2, .3s) cubic-bezier(.35,0,.25,1);will-change:opacity}:host(.forge-view-switcher--fade) ::slotted(.forge-view-switcher__view--hidden){opacity:0}";var B=Object.defineProperty,X=Object.getOwnPropertyDescriptor,m=(r,e,i,t)=>{for(var s=t>1?void 0:t?X(e,i):e,h=r.length-1,a;h>=0;h--)(a=r[h])&&(s=(t?a(e,i,s):a(s))||s);return t&&s&&B(e,i,s),s};let c=class extends u{static get observedAttributes(){return[n.attributes.INDEX,n.attributes.ANIMATION_TYPE]}constructor(){super(),E(this,k,q),this._core=new P(new L(this))}connectedCallback(){this._core.initialize()}disconnectedCallback(){this._core.disconnect()}attributeChangedCallback(r,e,i){switch(r){case n.attributes.INDEX:this.index=D(i);break;case n.attributes.ANIMATION_TYPE:this.animationType=i;break}}next(){this._core.next()}previous(){this._core.previous()}goToStart(){this._core.goToStart()}goToEnd(){this._core.goToEnd()}};m([I()],c.prototype,"index",2);m([I()],c.prototype,"animationType",2);c=m([g({name:n.elementName,dependencies:[p]})],c);
