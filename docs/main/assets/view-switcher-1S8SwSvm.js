import{C as y,q as m,v as V,x as b,o as g,B as f,p as u,d as D}from"./constants-CFf81ck9.js";import{B as N,c as E}from"./base-adapter-Dh44vCkH.js";const C=`${y}view-switcher`,c={ROOT:"forge-view-switcher",VIEW_HIDDEN:"forge-view-switcher__view--hidden",VIEW_SWITCHER_SLIDE:"slide",VIEW_SWITCHER_FADE:"fade"},A={ROOT:`.${c.ROOT}`,DEFAULT_SLOT:"slot:not([name])",VIEW_HIDDEN:`.${c.VIEW_HIDDEN}`},O={INDEX:"index",ANIMATION_TYPE:"animation-type"},H={DEFAULT_TRANSITION_DURATION:500},n={elementName:C,attributes:O,classes:c,selectors:A,numbers:H};var l=(r=>(r.Left="left",r.Right="right",r))(l||{});class x extends N{constructor(e){super(e),this._rootElement=m(e,n.selectors.ROOT),this._slotElement=m(e,n.selectors.DEFAULT_SLOT)}getViewCount(){return this._getViews().length}startViewObserver(e){this._viewObserver=new MutationObserver(e),this._viewObserver.observe(this._component,{childList:!0})}stopViewObserver(){var e;(e=this._viewObserver)==null||e.disconnect()}initializeSlideViews(e){let i=this._getViews();i.forEach((t,s)=>{if(t.style.removeProperty("opacity"),t.style.removeProperty("display"),s===e){i[e].classList.remove(n.classes.VIEW_HIDDEN),t.style.removeProperty("visibility");return}t.style.transition="none",t.classList.add(n.classes.VIEW_HIDDEN),t.style.visibility="hidden",s>e?t.style.transform="translate3d(100%, 0, 0)":t.style.transform="translate3d(-100%, 0, 0)"}),window.requestAnimationFrame(()=>{i=this._getViews(),i.forEach((t,s)=>{s!==e&&t.style.removeProperty("transition")})})}initializeFadeViews(e){const i=this._getViews();i.forEach((t,s)=>{if(t.style.removeProperty("transform"),t.style.removeProperty("display"),s===e){t.classList.remove(n.classes.VIEW_HIDDEN),t.style.removeProperty("visibility");return}t.classList.add(n.classes.VIEW_HIDDEN),t.style.visibility="hidden"}),i[e]&&(i[e].style.opacity="1")}setActiveView(e){const i=this._getViews();i.forEach((t,s)=>{s!==e&&(t.classList.add(n.classes.VIEW_HIDDEN),t.style.display="none")}),i[e]&&(i[e].classList.remove(n.classes.VIEW_HIDDEN),i[e].style.removeProperty("display"))}hideInactiveViews(e){this._getViews().forEach((t,s)=>{if(t.style.removeProperty("opacity"),t.style.removeProperty("transform"),t.style.removeProperty("visibility"),s===e){t.classList.remove(n.classes.VIEW_HIDDEN);return}t.classList.add(n.classes.VIEW_HIDDEN),t.style.display="none"})}async transitionToView(e,i,t,s){const o=this._getViews(),a=o[e],h=o[i];return new Promise(I=>{h.style.removeProperty("visibility"),window.requestAnimationFrame(()=>{let d;switch(t){case"slide":this._slideToView(a,h,s),d="transform";break;case"fade":this._fadeToView(a,h),d="opacity";break;default:return}this._animateHeight(a,h),a?a.addEventListener("transitionend",p):h.classList.remove(n.classes.VIEW_HIDDEN);function p(T){T.propertyName===d&&(a.removeEventListener("transitionend",p),h.classList.remove(n.classes.VIEW_HIDDEN),I())}})})}_slideToView(e,i,t){t===l.Left?(e&&(e.style.transform="translate3d(-100%, 0, 0)"),i.style.transform="translate3d(0, 0, 0)"):(e&&(e.style.transform="translate3d(100%, 0, 0)"),i.style.transform="translate3d(0, 0, 0)")}_fadeToView(e,i){e&&(e.style.opacity="0"),i.style.opacity="1"}_animateHeight(e,i){const t=e?this._getViewHeight(e):0,s=this._getViewHeight(i);t!==s&&(this._rootElement.addEventListener("transitionend",this._onRootTransitionEnd.bind(this)),this._setHeight(t),window.requestAnimationFrame(()=>{window.requestAnimationFrame(()=>{this._setHeight(s)})}))}_onRootTransitionEnd(e){e.propertyName==="height"&&(this._rootElement.removeEventListener("transitionend",this._onRootTransitionEnd),this._rootElement.style.removeProperty("height"))}setAnimationType(e){switch(V([n.classes.VIEW_SWITCHER_SLIDE,n.classes.VIEW_SWITCHER_FADE],this._component),e){case"slide":this._component.classList.add(n.classes.VIEW_SWITCHER_SLIDE);break;case"fade":this._component.classList.add(n.classes.VIEW_SWITCHER_FADE);break}}_getViews(){return this._slotElement.assignedNodes().filter(e=>e.nodeType===1)}_setHeight(e){this._rootElement.style.height=`${e}px`}_getViewHeight(e){let i=0;const t=e.children.length?Array.from(e.children):[e];for(const s of t){const o=window.getComputedStyle(s),a=parseFloat(o.marginTop)+parseFloat(o.marginBottom);i+=Math.ceil(s.offsetHeight+a)}return i}}class L{constructor(e){this._adapter=e,this._viewCount=0,this._viewIndex=0,this._animationType="none",this._viewsChangedListener=()=>this._onViewsChanged()}initialize(){this._viewCount=this._adapter.getViewCount(),this._adapter.startViewObserver(this._viewsChangedListener),this._adapter.setAnimationType(this._animationType),this._viewCount&&this._initializeAnimationType()}destroy(){this._adapter.stopViewObserver()}_initializeAnimationType(){switch(this._animationType){case"slide":this._adapter.initializeSlideViews(this._viewIndex);break;case"fade":this._adapter.initializeFadeViews(this._viewIndex);break;case"none":default:this._adapter.hideInactiveViews(this._viewIndex);break}}_onViewsChanged(){if(this._viewCount=this._adapter.getViewCount(),this._viewCount===0&&(this._viewIndex=0),this._viewCount&&this._initializeAnimationType(),this._viewCount>0&&this._viewIndex>=this._viewCount){const e=this._viewIndex;this._viewIndex=this._viewCount>0?this._viewCount-1:0,this._goToView(e,this._viewCount)}}async _goToView(e,i){if(this._viewCount=b(i)?i:this._adapter.getViewCount(),!(!(this._viewIndex>=0&&this._viewIndex<=this._viewCount-1)||e===this._clampedViewIndex(this._viewIndex,this._viewCount)))switch(this._animationType){case"slide":const s=this._viewIndex>e?l.Left:l.Right;await this._adapter.transitionToView(e,this._viewIndex,"slide",s),this._adapter.initializeSlideViews(this._viewIndex);break;case"fade":await this._adapter.transitionToView(e,this._viewIndex,"fade"),this._adapter.initializeFadeViews(this._viewIndex);break;case"none":default:this._adapter.setActiveView(this._viewIndex);break}}_clampedViewIndex(e,i){return e<0?e=0:e>i-1&&(e=i>0?i-1:0),e}next(){this.index++}previous(){this.index--}goToStart(){this.index=0}goToEnd(){this.index=this._viewCount-1}get index(){return this._viewIndex}set index(e){if(this._viewIndex!==e){const i=this._viewIndex;this._viewIndex=e,this._goToView(i),this._adapter.setHostAttribute(n.attributes.INDEX,this._viewIndex.toString())}}get animationType(){return this._animationType}set animationType(e){this._animationType!==e&&(this._animationType=e,this._initializeAnimationType(),this._adapter.setAnimationType(this._animationType),this._adapter.setHostAttribute(n.attributes.ANIMATION_TYPE,this._animationType))}}const P=`${y}view`,S={elementName:P},W=`<template>
  <slot></slot>
</template>
`,R=":host{display:block}:host([hidden]){display:none}";var F=Object.defineProperty,z=Object.getOwnPropertyDescriptor,$=(r,e,i,t)=>{for(var s=t>1?void 0:t?z(e,i):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(s=(t?a(e,i,s):a(s))||s);return t&&s&&F(e,i,s),s};let w=class extends f{constructor(){super(),u(this,W,R)}};w=$([g({name:S.elementName})],w);const M=`<template>
  <div class="forge-view-switcher" part="root">
    <slot></slot>
  </div>
</template>
`,k=":host{height:var(--_view-switcher-height);width:var(--_view-switcher-width);display:block}:host([hidden]){display:none}.forge-view-switcher{--_view-switcher-height: var(--forge-view-switcher-height, auto);--_view-switcher-width: var(--forge-view-switcher-width, auto);--_view-switcher-animation-duration: var(--forge-view-switcher-animation-duration, var(--forge-animation-duration-medium2, .3s));--_view-switcher-animation-easing: var(--forge-view-switcher-animation-easing, var(--forge-animation-easing-standard, cubic-bezier(.2, 0, 0, 1)))}.forge-view-switcher{height:var(--_view-switcher-height);width:var(--_view-switcher-width);position:relative;overflow:hidden;transition-property:height;transition-duration:var(--_view-switcher-animation-duration);transition-timing-function:var(--_view-switcher-animation-easing)}.forge-view-switcher ::slotted(.forge-view-switcher__view--hidden){position:absolute;top:0;right:0;bottom:0;left:0}:host(.slide) ::slotted(forge-view){transition-property:transform;transition-duration:var(--_view-switcher-animation-duration);transition-timing-function:var(--_view-switcher-animation-easing);will-change:transform}:host(.fade) ::slotted(forge-view){transition-property:opacity;transition-duration:var(--_view-switcher-animation-duration);transition-timing-function:var(--_view-switcher-animation-easing);will-change:opacity}:host(.fade) ::slotted(.forge-view-switcher__view--hidden){opacity:0}";var q=Object.defineProperty,B=Object.getOwnPropertyDescriptor,v=(r,e,i,t)=>{for(var s=t>1?void 0:t?B(e,i):e,o=r.length-1,a;o>=0;o--)(a=r[o])&&(s=(t?a(e,i,s):a(s))||s);return t&&s&&q(e,i,s),s};let _=class extends f{static get observedAttributes(){return[n.attributes.INDEX,n.attributes.ANIMATION_TYPE]}constructor(){super(),u(this,M,k),this._core=new L(new x(this))}connectedCallback(){this._core.initialize()}disconnectedCallback(){this._core.destroy()}attributeChangedCallback(r,e,i){switch(r){case n.attributes.INDEX:this.index=D(i);break;case n.attributes.ANIMATION_TYPE:this.animationType=i;break}}next(){this._core.next()}previous(){this._core.previous()}goToStart(){this._core.goToStart()}goToEnd(){this._core.goToEnd()}};v([E()],_.prototype,"index",2);v([E()],_.prototype,"animationType",2);_=v([g({name:n.elementName,dependencies:[w]})],_);
