import{C as _,p as h,t as g,z as v,n as E,o as y,b as L}from"./constants-CmaEVTEu.js";import{c as C}from"./base-adapter-Y8TBBZEm.js";import{B as M,l as A,a as k}from"./base-field-core-BhW0eMnQ.js";import{F as d,a as w,B as O,b as B}from"./base-field-DVx6gGpT.js";import{L as D}from"./label-BsLwoMJm.js";import"./index-Dh0vMUMR.js";import{C as R}from"./chip-set-XjnNJye7.js";import"./focus-indicator-CexacDHl.js";import"./state-layer-DjEoH8hN.js";import"./button-DqH9YfaW.js";import"./button-toggle-group-CSWkQPk2.js";import"./checkbox-DJehbw3q.js";import"./icon-button-Cqg7QjNu.js";import"./icon-DdNu5rAq.js";import"./switch-DYQgudGV.js";const c=`${_}chip-field`,m={ADD_ON_BLUR:"add-on-blur"},I={...m},N={CONTAINER:".container",INPUT:"input",MEMBER_SLOT:"slot[name=member]",MEMBER:"[slot=member]"},x={HAS_MEMBERS:"has-members"},S={MEMBER_ADDED:`${c}-member-added`,MEMBER_REMOVED:`${c}-member-removed`},T=["disabled","placeholder"],F={TEXTAREA:"TEXTAREA",LABEL:"LABEL"},i={elementName:c,observedAttributes:m,attributes:I,selectors:N,classes:x,events:S,observedInputAttributes:T,tagNames:F};class V extends M{get hasValue(){return!!this._component.querySelector(i.selectors.MEMBER)||this.hasInputValue}get hasPlaceholder(){var e;return!!((e=this._inputElement)!=null&&e.placeholder)}get hasInputValue(){var e;return!!((e=this._inputElement)!=null&&e.value)}get inputHasFocus(){var e;return!!((e=this._inputElement)!=null&&e.matches(":focus"))}get popoverTargetElement(){return this._popoverTargetElement||(this._popoverTargetElement=h(this._fieldElement,d.selectors.POPOVER_TARGET)),this._popoverTargetElement}constructor(e){super(e),this._fieldElement=h(e,d.elementName),this._containerElement=h(e,i.selectors.CONTAINER),this._memberSlot=h(e,i.selectors.MEMBER_SLOT),this._fieldElement.setAttribute("exportparts",Object.values(d.parts).join(", "))}initialize(){this._inputElement=this._component.querySelector("input:not([type=checkbox]):not([type=radio])")}addRootListener(e,t,r){this._fieldElement.addEventListener(e,t,r)}removeRootListener(e,t,r){this._fieldElement.removeEventListener(e,t,r)}addInputListener(e,t){var r;(r=this._inputElement)==null||r.addEventListener(e,t)}removeInputListener(e,t){var r;(r=this._inputElement)==null||r.removeEventListener(e,t)}clickInput(){var e;(e=this._inputElement)==null||e.click()}tryAddValueChangeListener(e,t){var r;(r=this._destroyValueChangerListener)==null||r.call(this),this._inputElement&&(this._destroyValueChangerListener=A(e,this._inputElement,"value",t))}removeValueChangeListener(){var e;(e=this._destroyValueChangerListener)==null||e.call(this)}focusInput(){var e;(e=this._inputElement)==null||e.focus()}getSlottedMemberElements(){return this._memberSlot.assignedElements()}click(){this.focusInput()}applyLabel(e){this._inputElement&&g(this._inputElement,!!e,"aria-label",e??"")}tryFloatLabel(e){if(e!==void 0){this._component.floatLabel=e;return}this._component.floatLabel=this.hasValue||this.hasPlaceholder}handleDefaultSlotChange(e,t){var s,a;(s=this._inputMutationObserver)==null||s.disconnect();const r=e.assignedElements();this._inputElement=r.find(n=>n.matches(i.selectors.INPUT)),this._inputElement&&(this._component.disabled&&(this._inputElement.disabled=!0),this._inputMutationObserver=new MutationObserver(n=>{n.forEach(l=>{if(l.attributeName){const f=l.target.getAttribute(l.attributeName),b=l.attributeName;t(b,f)}})}),(a=this._inputMutationObserver)==null||a.observe(this._inputElement,{attributes:!0,attributeFilter:[...i.observedInputAttributes]}),Object.values(i.observedInputAttributes).forEach(n=>{const l=n;this._inputElement&&t(l,this._inputElement.getAttribute(l))}))}tryConnectSlottedLabel(e){if(!this._inputElement)return;const t=e.assignedElements({flatten:!0}),r=t.find(n=>n.matches(D.elementName));if(r){r.forElement=this._component,r.clickTarget=this._inputElement;return}const s=t.find(n=>n.tagName===i.tagNames.LABEL);if(!s||s.control)return;const a=this._inputElement.id||`forge-input-${v()}`;this._inputElement.id=a,s.htmlFor=a}toggleContainerClass(e,t){this._containerElement.classList.toggle(e,t)}setDisabled(e){this._inputElement&&(this._inputElement.disabled=e)}}class P extends k{constructor(e){super(e),this._addOnBlur=!1,this._mouseDownListener=this._onMouseDown.bind(this),this._clickListener=this._onClick.bind(this),this._rootKeyDownListener=this._onRootKeyDown.bind(this),this._inputKeyDownListener=this._onKeyDown.bind(this),this._slotChangeListener=this._onSlotChange.bind(this),this._inputAttributeListener=this._onInputAttributeChange.bind(this),this._valueChangeListener=this._onValueChange.bind(this),this._inputListener=this._onValueChange.bind(this),this._blurListener=this._onBlur.bind(this)}initialize(){this._adapter.initialize(),this._adapter.addRootListener("mousedown",this._mouseDownListener,{capture:!0}),this._adapter.addRootListener("click",this._clickListener),this._adapter.addRootListener("keydown",this._rootKeyDownListener),this._adapter.addInputListener("keydown",this._inputKeyDownListener),this._adapter.addRootListener("slotchange",this._slotChangeListener),this._adapter.addRootListener("input",this._inputListener),this._adapter.tryAddValueChangeListener(this,this._valueChangeListener),this._addOnBlur&&this._adapter.addInputListener("blur",this._blurListener)}destroy(){this._adapter.removeRootListener("mousedown",this._mouseDownListener,{capture:!0}),this._adapter.removeRootListener("click",this._clickListener),this._adapter.removeRootListener("keydown",this._rootKeyDownListener),this._adapter.removeInputListener("keydown",this._inputKeyDownListener),this._adapter.removeRootListener("slotchange",this._slotChangeListener),this._adapter.removeRootListener("input",this._inputListener),this._adapter.removeInputListener("blur",this._blurListener),this._adapter.removeValueChangeListener()}_onBlur(e){const t=e.target;this._addOnBlur&&this._addMember(t),t.value=""}_onMouseDown(e){if(this._disabled||this._adapter.inputHasFocus){e.preventDefault(),e.stopPropagation();return}}_onClick(e){this._disabled||(this._adapter.focusInput(),this._adapter.clickInput())}_onValueChange(){this._tryFloatLabel()}_onSlotChange(e){const t=e.target;switch(t.name){case"label":this._adapter.tryConnectSlottedLabel(t);break;case"member":this._adapter.toggleContainerClass(i.classes.HAS_MEMBERS,t.assignedElements().length>0),this._adapter.tryFloatLabel(),this._adapter.getSlottedMemberElements().forEach(r=>r.tabIndex=-1);break;case"":this._adapter.handleDefaultSlotChange(t,this._inputAttributeListener),this._adapter.tryAddValueChangeListener(this,this._valueChangeListener),this._tryFloatLabel();break}}_onInputAttributeChange(e,t){switch(e){case"disabled":this.disabled=t!==null;break;case"placeholder":this._tryFloatLabel();break}}_onRootKeyDown({key:e}){if(!this._adapter.hasInputValue)switch(e){case"ArrowRight":this._focusNextMember();break;case"ArrowLeft":this._focusPreviousMember();break;case"Backspace":case"Delete":this._removeMember();break}}_onKeyDown({target:e,key:t}){const r=e;switch(t){case"Enter":this._addMember(r);break;case"Escape":r.value="";break;case"Tab":this._addOnBlur||(r.value="");break}}_focusNextMember(){const e=this._adapter.getSlottedMemberElements();if(!(!e.length||this._adapter.inputHasFocus))for(let t=0;t<e.length;t++){const r=e.at(t),s=e.at(t+1);if(r&&this._isMemberActive(r))if(s){s.focus();break}else this._adapter.focusInput()}}_focusPreviousMember(){const e=this._adapter.getSlottedMemberElements();if(e.length){if(this._adapter.inputHasFocus){e[e.length-1].focus();return}for(let t=0;t<e.length;t++){const r=e.at(t-1),s=e.at(t);if(s&&this._isMemberActive(s)&&r){r.focus();break}}}}_isMemberActive(e){return e.matches(":focus-within")}_getActiveMember(){return this._adapter.getSlottedMemberElements().find(t=>this._isMemberActive(t))??null}_addMember(e){const t=e.value.trim();t.length>0&&this._adapter.emitHostEvent(i.events.MEMBER_ADDED,t),e.value=""}_removeMember(){let e=this._getActiveMember();e||(e=this._adapter.getSlottedMemberElements().at(-1)),e&&(this._focusNextMember(),this._adapter.emitHostEvent(i.events.MEMBER_REMOVED,e))}get addOnBlur(){return this._addOnBlur}set addOnBlur(e){e=!!e,this._addOnBlur!==e&&(this._addOnBlur=e,this._adapter.isConnected&&(this._addOnBlur?this._adapter.addInputListener("blur",this._blurListener):this._adapter.removeInputListener("blur",this._blurListener)),this._adapter.toggleHostAttribute(i.attributes.ADD_ON_BLUR,this._addOnBlur))}get popoverTargetElement(){return this._adapter.popoverTargetElement}get disabled(){return super.disabled}set disabled(e){this.disabled!==e&&(super.disabled=e,this._adapter.setDisabled(e))}}const z=`<template>
  <forge-field id="field" multiline>
    <slot slot="label" name="label"></slot>
    <slot slot="start" name="start"></slot>
    <div class="container" data-forge-field-input>
      <slot name="member"></slot>
      <slot></slot>
    </div>
    <slot slot="end" name="end"></slot>
    <slot slot="accessory" name="accessory"></slot>
    <slot slot="support-text" name="support-text"></slot>
    <slot slot="support-text-end" name="support-text-end"></slot>

    <!-- Include deprecated leading alias -->
    <slot slot="start" name="leading"></slot>
    <!-- Include deprecated trailing alias -->
    <slot slot="end" name="trailing"></slot>
    <!-- Include deprecated addon-end alias -->
    <slot slot="accessory" name="addon-end"></slot>
    <!-- Include deprecated helper-text alias -->
    <slot slot="support-text" name="helper-text"></slot>
  </forge-field>
</template>
`,H="@keyframes float-in-label-animation{0%{translate:0;opacity:40%}to{translate:var(--_field-floating-label-translation);opacity:100%}}@keyframes float-out-label-animation{0%{translate:var(--_field-floating-label-translation);opacity:40%}to{translate:0;opacity:100%}}@keyframes float-in-input-animation{0%{translate:0}to{translate:0 calc(calc(max(var(--forge-typography-body2-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-body-line-height-scale, 1.375))),var(--forge-typography-label2-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-label-line-height-scale, 1.25))))/2) + calc((var(--_field-height) - 56px) / 8))}}@keyframes float-out-input-animation{0%{translate:0 calc(calc(max(var(--forge-typography-body2-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-body-line-height-scale, 1.375))),var(--forge-typography-label2-line-height, calc(var(--forge-typography-font-size, 1rem) * var(--forge-typography-label-line-height-scale, 1.25))))/2) + calc((var(--_field-height) - 56px) / 8))}to{translate:0}}@keyframes multiline-inset-label-background-animation{0%{opacity:0%}to{opacity:100%}}:host{display:block}:host([hidden]){display:none}forge-field{--_chip-field-member-spacing: var(--forge-chip-field-member-spacing, var(--forge-spacing-xsmall, 8px));--_chip-field-content-spacing: var(--forge-chip-field-content-spacing, var(--forge-spacing-xxsmall, 4px))}.container{display:flex;flex-wrap:wrap;align-items:center;gap:var(--_chip-field-member-spacing);block-size:auto}.container.has-members{margin-block:var(--_chip-field-content-spacing)}.container.has-members ::slotted(input){block-size:auto;inline-size:auto}::slotted(input){flex-grow:1;cursor:inherit;box-sizing:border-box;margin:0;outline:none;border:none;background-color:transparent;padding-block:0;padding-inline:0;inline-size:100%;block-size:100%;color:inherit;font:inherit;text-overflow:ellipsis}forge-field{display:contents;--forge-field-multiline-resize: none}forge-field::part(label):after{content:none}:host([theme=primary]) ::slotted([slot=member]){--forge-chip-field-background: var(--forge-theme-primary, #3f51b5);--forge-chip-field-color: var(--forge-theme-on-primary, #ffffff)}:host([theme=secondary]) ::slotted([slot=member]){--forge-chip-field-background: var(--forge-theme-secondary, #ffc107);--forge-chip-field-color: var(--forge-theme-on-secondary, #000000)}:host([theme=tertiary]) ::slotted([slot=member]){--forge-chip-field-background: var(--forge-theme-tertiary, #3d5afe);--forge-chip-field-color: var(--forge-theme-on-tertiary, #ffffff)}:host([theme=success]) ::slotted([slot=member]){--forge-chip-field-background: var(--forge-theme-success, #2e7d32);--forge-chip-field-color: var(--forge-theme-on-success, #ffffff)}:host([theme=warning]) ::slotted([slot=member]){--forge-chip-field-background: var(--forge-theme-warning, #d14900);--forge-chip-field-color: var(--forge-theme-on-warning, #ffffff)}:host([theme=error]) ::slotted([slot=member]){--forge-chip-field-background: var(--forge-theme-error, #b00020);--forge-chip-field-color: var(--forge-theme-on-error, #ffffff)}:host([theme=info]) ::slotted([slot=member]){--forge-chip-field-background: var(--forge-theme-info, #1565c0);--forge-chip-field-color: var(--forge-theme-on-info, #ffffff)}";var K=Object.defineProperty,j=Object.getOwnPropertyDescriptor,u=(o,e,t,r)=>{for(var s=r>1?void 0:r?j(e,t):e,a=o.length-1,n;a>=0;a--)(n=o[a])&&(s=(r?n(e,t,s):n(s))||s);return r&&s&&K(e,t,s),s};let p=class extends w{static get observedAttributes(){return[...Object.values(O.observedAttributes),...Object.values(i.observedAttributes)]}constructor(){super(),y(this,z,H),this._core=new P(new V(this))}connectedCallback(){this._core.initialize()}disconnectedCallback(){this._core.destroy()}attributeChangedCallback(o,e,t){switch(super.attributeChangedCallback(o,e,t),o){case i.attributes.ADD_ON_BLUR:this.addOnBlur=L(t);return}}get popoverTargetElement(){return this._core.popoverTargetElement}click(){this._core.click()}};u([C()],p.prototype,"addOnBlur",2);p=u([E({name:i.elementName,dependencies:[B,R]})],p);export{i as C};
