import{C as g,l as y,j as E,B as L,k as v}from"./base-component-DDNjpQtJ.js";import{B as A,c as u}from"./base-adapter-j11ZPrFD.js";import"./service-adapter-CffG5Lhq.js";import{c as T}from"./feature-detection-DBWkqjAp.js";import{e as I,l as C}from"./utils-DU-9AqTO.js";const S=`${g}state-layer`,b={TARGET:"target",DISABLED:"disabled"},D={...b},x={SURFACE:".forge-state-layer"},N={HOVERED:"forge-state-layer--hovered",PRESSED:"forge-state-layer--pressed"},d={elementName:S,attributes:D,selectors:x,classes:N};class c{constructor(t,e){this.x=t,this.y=e}static fromPointerEvent(t){return new c(t.pageX,t.pageY)}}const O=150,R=450,m=225,P=.2,w=10,H=75,B=.35,k="::after",G="forwards",M="cubic-bezier(0.2, 0, 0, 1)";var o=(r=>(r[r.INACTIVE=0]="INACTIVE",r[r.TOUCH_DELAY=1]="TOUCH_DELAY",r[r.HOLDING=2]="HOLDING",r[r.WAITING_FOR_CLICK=3]="WAITING_FOR_CLICK",r))(o||{});function U(r){const{height:t,width:e}=r.getBoundingClientRect(),s=Math.max(t,e),i=Math.max(B*s,H),n=Math.floor(s*P),_=`${(Math.sqrt(e**2+t**2)+w+i)/n}`,f=`${n}px`;return{rippleScale:_,rippleSize:f,initialSize:n}}function z(r,t,e){const{height:s,width:i}=r.getBoundingClientRect(),n={x:(i-t)/2,y:(s-t)/2};let a;return Y(e)?a=F(r,e):a={x:i/2,y:s/2},a={x:a.x-t/2,y:a.y-t/2},{startPoint:a,endPoint:n}}function F(r,t){const{scrollX:e,scrollY:s}=window,{left:i,top:n}=r.getBoundingClientRect(),a=e+i,l=s+n,{x:_,y:f}=t;return{x:_-a,y:f-l}}function V(r,t,e){const{height:s,width:i}=r.getBoundingClientRect();return t>=0&&t<=i&&e>=0&&e<=s}function Y(r){return r&&(r instanceof c||["x","y"].every(t=>t in r))}class $ extends A{constructor(t){super(t),this._targetElement=null,this._surfaceElement=y(t,d.selectors.SURFACE)}destroy(){typeof this._destroyDeferListener=="function"&&(this._destroyDeferListener(),this._destroyDeferListener=void 0),this._targetElement=null}async deferInitialization(t){if(!this._targetElement)return;const{userInteraction:e,destroy:s}=I(this._targetElement);this._destroyDeferListener=s;const i=await e;t(i.type==="pointerenter"?i:void 0)}addTargetListener(t,e){this._targetElement?.addEventListener(t,e)}removeTargetListener(t,e){this._targetElement?.removeEventListener(t,e)}setHovered(t){this._surfaceElement.classList.toggle(d.classes.HOVERED,t)}setPressed(t){this._surfaceElement.classList.toggle(d.classes.PRESSED,t)}getTargetElement(){return this._targetElement}setTargetElement(t){this._targetElement=t}trySetTarget(t){this._targetElement=C(this._component,t)}startAnimation(t){if(!this._surfaceElement)return;this.setPressed(!0),this._rippleAnimation?.cancel();const{rippleSize:e,rippleScale:s,initialSize:i}=U(this._component);if(s==="Infinity")return;const{startPoint:n,endPoint:a}=z(this._component,i,t),l=`${n.x}px, ${n.y}px`,_=`${a.x}px, ${a.y}px`;this._rippleAnimation=this._surfaceElement.animate({top:[0,0],left:[0,0],height:[e,e],width:[e,e],transform:[`translate(${l}) scale(1)`,`translate(${_}) scale(${s})`]},{pseudoElement:k,duration:R,easing:M,fill:G})}async endAnimation(){const t=this._rippleAnimation,e=t?.currentTime??1/0;if(e>=m){this.setPressed(!1);return}await new Promise(s=>{setTimeout(s,m-e)}),this._rippleAnimation===t&&this.setPressed(!1)}inBounds(t,e){return V(this._component,t,e)}}class W{constructor(t){this._adapter=t,this._target=null,this._disabled=!1,this._attached=!1,this._deferred=!0,this._pointerState=o.INACTIVE,this._checkBoundsAfterContextMenu=!1,this._pointerEnterListener=e=>this._onPointerEnter(e),this._pointerLeaveListener=e=>this._onPointerLeave(e),this._pointerDownListener=e=>this._onPointerDown(e),this._pointerUpListener=e=>this._onPointerUp(e),this._pointerCancelListener=e=>this._onPointerCancel(e),this._clickListener=()=>this._onClick(),this._contextmenuListener=()=>this._onContextmenu()}initialize(){this._adapter.trySetTarget(this._target),this._adapter.addTargetListener("click",this._clickListener),this._deferInitialization()}destroy(){this._pointerStartEvent=void 0,this._pointerState=o.INACTIVE,this._adapter.setHovered(!1),this._adapter.setPressed(!1),this._removeListeners(),this._adapter.destroy()}playAnimation(t){this._adapter.startAnimation(t),this._endAnimation()}_deferInitialization(){this._adapter.deferInitialization(this._onDeferredInitialize.bind(this))}_applyListeners(){this._disabled||(this._adapter.addTargetListener("pointerenter",this._pointerEnterListener),this._adapter.addTargetListener("pointerleave",this._pointerLeaveListener),this._adapter.addTargetListener("pointerdown",this._pointerDownListener),this._adapter.addTargetListener("pointerup",this._pointerUpListener),this._adapter.addTargetListener("pointercancel",this._pointerCancelListener),this._adapter.addTargetListener("contextmenu",this._contextmenuListener),this._attached=!0)}_removeListeners(){this._adapter.removeTargetListener("pointerenter",this._pointerEnterListener),this._adapter.removeTargetListener("pointerleave",this._pointerLeaveListener),this._adapter.removeTargetListener("pointerdown",this._pointerDownListener),this._adapter.removeTargetListener("pointerup",this._pointerUpListener),this._adapter.removeTargetListener("pointercancel",this._pointerCancelListener),this._adapter.removeTargetListener("click",this._clickListener),this._adapter.removeTargetListener("contextmenu",this._contextmenuListener),this._attached=!1}_onDeferredInitialize(t){this._adapter.isConnected&&(this._applyListeners(),t?.type==="pointerenter"&&this._pointerEnterListener(t),this._deferred=!1)}_onPointerEnter(t){this._canHandleEvent(t)&&this._adapter.setHovered(!0)}_onPointerLeave(t){this._canHandleEvent(t)&&(this._adapter.setHovered(!1),this._pointerState!==o.INACTIVE&&this._adapter.endAnimation())}async _onPointerDown(t){if(this._pointerStartEvent=t,!!this._canHandleEvent(t)){if(!this._isTouch(t.pointerType)){this._pointerState=o.WAITING_FOR_CLICK,this._startAnimation(t);return}this._checkBoundsAfterContextMenu&&!this._adapter.inBounds(t.x,t.y)||(this._checkBoundsAfterContextMenu=!1,this._pointerState=o.TOUCH_DELAY,await new Promise(e=>setTimeout(e,O)),this._pointerState===o.TOUCH_DELAY&&(this._pointerState=o.HOLDING,this._startAnimation(t)))}}_onPointerUp(t){if(this._canHandleEvent(t)){if(this._pointerState===o.HOLDING){this._pointerState=o.WAITING_FOR_CLICK;return}if(this._pointerState===o.TOUCH_DELAY){this._pointerState=o.WAITING_FOR_CLICK,this._startAnimation(this._pointerStartEvent);return}}}_onClick(){if(!this._disabled){if(this._pointerState===o.WAITING_FOR_CLICK){this._endAnimation();return}this._pointerState===o.INACTIVE&&(this._startAnimation(this._pointerStartEvent),this._endAnimation())}}_onPointerCancel(t){this._canHandleEvent(t)&&this._endAnimation()}_onContextmenu(){this._disabled||(this._checkBoundsAfterContextMenu=!0,this._adapter.endAnimation())}_startAnimation(t){const e=t?c.fromPointerEvent(t):void 0;this._adapter.startAnimation(e)}_endAnimation(){this._pointerState=o.INACTIVE,this._adapter.endAnimation(),this._pointerStartEvent=void 0}_canHandleEvent({type:t,isPrimary:e,buttons:s,pointerType:i,pointerId:n}){if(this._disabled||!e||this._pointerStartEvent&&this._pointerStartEvent.pointerId!==n)return!1;if(t==="pointerenter"||t==="pointerleave")return!this._isTouch(i);const a=s===1;return this._isTouch(i)||a}_isTouch(t){return t==="touch"}get isAttached(){return this._attached}get targetElement(){return this._adapter.getTargetElement()}set targetElement(t){this._removeListeners(),this._attached||(this._adapter.destroy(),this._deferred=!1),this._adapter.setTargetElement(t),this._adapter.addTargetListener("click",this._clickListener),this._deferred||this._deferInitialization()}get target(){return this._adapter.getHostAttribute(d.attributes.TARGET)}set target(t){this._target!==t&&(this._target=t,this._adapter.isConnected&&(this._removeListeners(),this._attached||(this._adapter.destroy(),this._deferred=!1),this._adapter.trySetTarget(t),this._adapter.addTargetListener("click",this._clickListener),this._deferred||this._deferInitialization()),this._adapter.toggleHostAttribute(d.attributes.TARGET,!!this._target,this._target))}get disabled(){return this._disabled}set disabled(t){t=!!t,this._disabled!==t&&(this._disabled=t,this._adapter.isConnected&&(this._disabled?this._removeListeners():this._deferred||this._deferInitialization()),this._adapter.toggleHostAttribute(d.attributes.DISABLED,this._disabled))}}const K=`<template>
  <div class="forge-state-layer" part="surface"></div>
</template>
`,X=':host{--_state-layer-display: var(--forge-state-layer-display, flex)}:host{border-radius:inherit;position:absolute;inset:0;overflow:hidden;display:var(--_state-layer-display);margin:auto;pointer-events:none;-webkit-tap-highlight-color:transparent}:host([hidden]){display:none}:host([disabled]){display:none}.forge-state-layer{--_state-layer-color: var(--forge-state-layer-color, var(--forge-theme-on-surface, #000000));--_state-layer-hover-color: var(--forge-state-layer-hover-color, var(--_state-layer-color));--_state-layer-hover-opacity: var(--forge-state-layer-hover-opacity, .08);--_state-layer-pressed-color: var(--forge-state-layer-pressed-color, var(--_state-layer-color));--_state-layer-pressed-opacity: var(--forge-state-layer-pressed-opacity, .12);--_state-layer-hover-duration: var(--forge-state-layer-hover-duration, 15ms);--_state-layer-pressed-duration: var(--forge-state-layer-pressed-duration, 105ms);--_state-layer-animation-duration: var(--forge-state-layer-animation-duration, 375ms)}.forge-state-layer:before,.forge-state-layer:after{content:"";opacity:0;position:absolute;backface-visibility:hidden;transform:translateZ(0)}.forge-state-layer:before{background-color:var(--_state-layer-hover-color);inset:0;transition:opacity var(--_state-layer-hover-duration) linear,background-color var(--_state-layer-hover-duration) linear}.forge-state-layer:after{background:radial-gradient(closest-side,var(--_state-layer-pressed-color) max(100% - 70px,65%),transparent 100%);transform-origin:center center;transition:opacity var(--_state-layer-animation-duration) linear}.forge-state-layer--hovered:before{background-color:var(--_state-layer-hover-color);opacity:var(--_state-layer-hover-opacity)}.forge-state-layer--pressed:after{opacity:var(--_state-layer-pressed-opacity);transition-duration:var(--_state-layer-pressed-duration)}@media screen and (forced-colors:active){:host{display:none}}';var j=Object.defineProperty,Z=Object.getOwnPropertyDescriptor,p=(r,t,e,s)=>{for(var i=s>1?void 0:s?Z(t,e):t,n=r.length-1,a;n>=0;n--)(a=r[n])&&(i=(s?a(t,e,i):a(i))||i);return s&&i&&j(t,e,i),i};let h=class extends L{static get observedAttributes(){return[d.attributes.TARGET,d.attributes.DISABLED]}constructor(){super(),v(this,K,X),this._core=new W(new $(this))}connectedCallback(){this._core.initialize()}disconnectedCallback(){this._core.destroy()}attributeChangedCallback(r,t,e){switch(r){case d.attributes.TARGET:this.target=e;break;case d.attributes.DISABLED:this.disabled=T(e);break}}playAnimation(r){this._core.playAnimation(r)}};p([u()],h.prototype,"targetElement",2);p([u()],h.prototype,"target",2);p([u()],h.prototype,"disabled",2);h=p([E({name:d.elementName})],h);export{h as S,d as a};
