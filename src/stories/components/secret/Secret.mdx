import { Meta, Title, Canvas } from '@storybook/addon-docs/blocks';
import * as SecretStories from './Secret.stories';

<Meta of={SecretStories} />

<Title />

The Secret component conceals inline content with a visual effect (blur or dots), revealing it on user interaction. It's designed for sensitive information that should be hidden by default.

## Features

- **Two visual variants**: Blur or dots effect for concealing content
- **Accessible**: Full keyboard support and screen reader announcements
- **Interactive feedback**: Uses Forge state-layer and focus-indicator
- **Hover reveal**: Optional reveal on hover/focus
- **Radio group behavior**: Multiple secrets with the same name act as a group
- **Inline display**: Wraps content inline with surrounding text
- **Customizable**: Slots for custom icons and labels

## Basic Usage

<Canvas of={SecretStories.Demo} />

```html
<forge-secret icon>Secret content</forge-secret>
```

## Variants

### Blur Variant

The default variant applies a blur effect to conceal the content.

<Canvas of={SecretStories.BlurVariant} />

```html
<forge-secret variant="blur" icon>This content is blurred when hidden</forge-secret>
```

### Dots Variant

The dots variant replaces the content with a dot pattern.

<Canvas of={SecretStories.DotsVariant} />

```html
<forge-secret variant="dots" icon>This content is replaced by dots when hidden</forge-secret>
```

## With Label

Use the `label` slot to add a label before the secret content.

<Canvas of={SecretStories.WithLabel} />

```html
<forge-secret icon>
  <span slot="label">Password: </span>
  my_secret_password
</forge-secret>
```

## Show on Hover

Enable `show-on-hover` to reveal content on hover or focus in addition to click.

<Canvas of={SecretStories.ShowOnHover} />

```html
<forge-secret show-on-hover icon>Hover over me to reveal</forge-secret>
```

## Custom Icons

Override the default eye/eye_off icons using the `visible-icon` and `hidden-icon` slots.

<Canvas of={SecretStories.CustomIcons} />

```html
<forge-secret icon>
  <span slot="hidden-icon">ðŸ”’</span>
  <span slot="visible-icon">ðŸ”“</span>
  Secret with custom icons
</forge-secret>
```

## Without Icon

The icon is optional. Without it, the entire surface is still clickable.

<Canvas of={SecretStories.NoIcon} />

```html
<forge-secret>Secret without visible icon</forge-secret>
```

## Programmatic Control

Control visibility programmatically using the `visible` property.

<Canvas of={SecretStories.ProgrammaticControl} />

```javascript
const secret = document.querySelector('forge-secret');
secret.visible = true; // Reveal
secret.visible = false; // Conceal
```

## Radio Group Behavior

Multiple secrets with the same `name` act as a radio group - only one can be visible at a time.

<Canvas of={SecretStories.RadioGroup} />

```html
<forge-secret name="credentials" icon>john_doe</forge-secret>
<forge-secret name="credentials" icon>my_secret_password</forge-secret>
<forge-secret name="credentials" icon>sk_test_1234567890abcdef</forge-secret>
```

## Inline Usage

The component is designed to work inline with surrounding text.

<Canvas of={SecretStories.InlineUsage} />

```html
<p>
  The user's email is <forge-secret icon>user@example.com</forge-secret>
  and their phone number is <forge-secret icon variant="dots">555-1234</forge-secret>.
</p>
```

## Properties

| Property | Type | Default | Description |
|----------|------|---------|-------------|
| `visible` | `boolean` | `false` | Whether the secret content is currently visible |
| `variant` | `'blur' \| 'dots'` | `'blur'` | The visual effect variant to apply when content is hidden |
| `showOnHover` | `boolean` | `false` | Whether to reveal content on hover/focus in addition to click |
| `noLabel` | `boolean` | `false` | Whether to hide the label |
| `name` | `string` | `''` | Group name for radio-like behavior. Only one secret with the same name can be visible at a time |

## Events

| Event | Detail | Description |
|-------|--------|-------------|
| `forge-secret-change` | `{ visible: boolean }` | Dispatched when the visible state changes |

## Slots

| Slot | Description |
|------|-------------|
| (default) | The secret content (displayed inline after label) |
| `label` | Optional label displayed inline before the secret content |
| `visible-icon` | Custom icon to show when content is visible (replaces default eye_off) |
| `hidden-icon` | Custom icon to show when content is hidden (replaces default eye) |

## CSS Custom Properties

The component uses the following design tokens which can be customized:

| Token | Default | Description |
|-------|---------|-------------|
| `--forge-secret-blur` | `spacing.variable(xsmall)` | The blur intensity for the blur variant |
| `--forge-secret-button-shape` | `shape.variable(medium)` | The shape of the button |
| `--forge-secret-label-background` | `theme.variable(surface-inverse)` | Background color of the label |
| `--forge-secret-label-color` | `theme.variable(on-surface-inverse)` | Text color of the label |
| `--forge-secret-label-padding` | `spacing.variable(xxxsmall) spacing.variable(xsmall)` | Padding around the label |
| `--forge-secret-label-shape` | `shape.variable(full)` | The shape of the label |
| `--forge-secret-icon-size` | `typography.font-size-relative('1000')` | Size of the icon |
| `--forge-secret-transition-duration` | `animation.variable(duration-short4)` | Animation duration for reveal/conceal transitions |

## CSS Parts

| Part | Description |
|------|-------------|
| `root` | The root container span |
| `content` | The content container |
| `button` | The overlay button |
| `label` | The label container |
| `icon` | The icon container |

## CSS States

| State | Description |
|-------|-------------|
| `:state(visible)` | Applied when the content is visible |

## Accessibility

The Secret component follows accessibility best practices:

- Uses a `<button>` overlay with proper ARIA attributes
- `aria-expanded` reflects the visible state
- Content is marked `inert` when hidden to prevent interaction
- Screen reader announcements via `aria-live` region when content is revealed
- Full keyboard support (Enter/Space to toggle)
- Forge focus-indicator provides clear focus styling
- Forge state-layer provides interaction feedback

## Use Cases

- **Sensitive Information**: Passwords, API keys, tokens, personal data
- **Privacy Protection**: Email addresses, phone numbers, account numbers
- **Form Fields**: Credit card numbers, SSN, security codes
- **Documentation**: Example credentials, test data
- **Educational Content**: Spoilers, quiz answers, hidden hints

## Best Practices

1. **Always use meaningful context**: Provide labels or surrounding text so users understand what's hidden
2. **Consider icon usage**: Show icons for better discoverability, especially for first-time users
3. **Use radio groups wisely**: Group related secrets to prevent multiple sensitive items being visible simultaneously
4. **Test with screen readers**: Ensure announcements are clear and helpful
5. **Don't overuse**: Reserve for truly sensitive content to avoid "alert fatigue"
6. **Provide visual hints**: Use icons or styling to indicate interactive elements
7. **Consider hover behavior**: Use `show-on-hover` for quick peeks, but ensure click still works for mobile

## Examples

### Credential Display

```html
<div>
  <strong>Username:</strong>
  <forge-secret name="creds" icon>john_doe</forge-secret>
</div>
<div>
  <strong>Password:</strong>
  <forge-secret name="creds" icon>my_secret_password</forge-secret>
</div>
```

### API Key with Copy

```html
<div>
  <forge-secret icon>
    <span slot="label">API Key: </span>
    sk_test_1234567890abcdef
  </forge-secret>
  <button onclick="copyToClipboard()">Copy</button>
</div>
```

### Conditional Styling

```css
/* Style based on visible state */
forge-secret:state(visible) {
  background-color: var(--mdc-theme-surface-variant);
  padding: 2px 4px;
  border-radius: 4px;
}
```

### Custom Blur Intensity

```html
<forge-secret icon style="--forge-secret-blur-amount: 16px;">
  Very sensitive content
</forge-secret>
```
