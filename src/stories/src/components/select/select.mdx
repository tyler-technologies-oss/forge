import { Default as SelectDemo } from './select.stories';
import { SelectDefaultHtml } from './code/select-default';
import { SelectAlwaysFloatHtml } from './code/select-always-float';
import { SelectHelperTextHtml } from './code/select-helper-text';
import { SelectMultipleHtml } from './code/select-multiple';
import { SelectLeadingIconHtml } from './code/select-leading-icon';
import { SelectRoomyHtml } from './code/select-roomy';

<PageSection>

# Select

The select component is a form field that provides the user the ability to choose a value from a pre-defined set of options via a dropdown list.

This component works best when you have a finite set of options. If you need to load options dynamically, or provide filtering, you should opt
for the [autocomplete component](?path=/story/components-autocomplete--default) instead (the two look the same and are very closely related).

Options can be configured via HTML or JavaScript. When setting up the options via HTML, you can use the `<forge-option>` element to configure the label
and value for each option as well as many other configuration properties.

> **Note:** the option elements within the dropdown will automatically receive generated `id` attributes to help with uniquely identifying these elements. Keep in
> mind though that these values will be different every time the page is rendered, but the identifier is how the options are tied back to the underlying `<forge-select>`
> that triggered the dropdown to open.

</PageSection>

---

<PageSection>

## Example

### Basic

<LiveDemo fullWidth codeHtml={SelectDefaultHtml()}>
  <SelectDemo />
</LiveDemo>

### Roomy

Use the `roomy` variant on mobile to allow for a larger touch target.

<LiveDemo fullWidth codeHtml={SelectRoomyHtml()}>
  <SelectDemo density="roomy" />
</LiveDemo>

### Always float

The component can be configured to keep the label floating at all times by setting the `float-label-type` attribute (or `floatLabelType` property in JavaScript) to `always`.

<LiveDemo fullWidth  codeHtml={SelectAlwaysFloatHtml()}>
  <SelectDemo floatLabelType="always" />
</LiveDemo>

### Leading icon

The component supports the ability to provide a custom leading icon via the `leading` slot:

<LiveDemo fullWidth codeHtml={SelectLeadingIconHtml()}>
  <SelectDemo hasLeadingIcon={true} />
</LiveDemo>

### Multiple

You can configure the component to allow for specifying multiple selections by adding the `multiple` attribute:

<LiveDemo fullWidth codeHtml={SelectMultipleHtml()}>
  <SelectDemo multiple={true} />
</LiveDemo>

### Helper text

If you need to provide helper text to add more information or show an error message, you can use the `helper-text` slot:

<LiveDemo fullWidth codeHtml={SelectHelperTextHtml()}>
  <SelectDemo hasHelperText={true} />
</LiveDemo>

</PageSection>

---

<PageSection>

## Properties/Attributes

<PropertyDef name="value" type="string | string[]" defaultValue="undefined">

Gets/set the selected value

</PropertyDef>

<PropertyDef name="selectedIndex" type="number | number[]" attr={false} defaultValue="undefined">

Gets/set the selected index.

</PropertyDef>

<PropertyDef name="options" type="ISelectOption[] | ISelectOptionGroup[]" attr={false} defaultValue="undefined">

Sets the options programatically if not using the template-based syntax.

</PropertyDef>

<PropertyDef name="multiple" type="boolean" defaultValue="false">

Gets/sets multi-select state.

</PropertyDef>

<PropertyDef name="open" type="boolean" attr={false} defaultValue="false">

Gets the open status of the dropdown.

</PropertyDef>

<PropertyDef name="optionBuilder" type="SelectOptionBuilder" attr={false} defaultValue="undefined">

Sets the option builder callback that will be executed when building the option list in the dropdown.

</PropertyDef>

<PropertyDef name="selectedTextBuilder" type="SelectSelectedTextBuilder" attr={false} defaultValue="undefined">

Sets the option builder callback that will be executed when building the option list in the dropdown.

</PropertyDef>

<PropertyDef name="popupElement" type="IPopupComponent | undefined" defaultValue="undefined">

Gets the popup element when open.

</PropertyDef>

<PropertyDef name="beforeValueChange" type="SelectBeforeValueChangeCallback<any>" defaultValue="undefined">

Sets the callback that will be executed when a user selects an option. This will allow you to cancel or validate the selection prior to the UI being updated.

</PropertyDef>

<PropertyDef name="label" type="string" defaultValue="undefined">

Gets/sets the label text.

</PropertyDef>

<PropertyDef name="disabled" type="boolean" defaultValue="false">

Gets/sets the disabled state.

</PropertyDef>

<PropertyDef name="invalid" type="boolean" defaultValue="false">

Gets/sets the invalid state. Setting this to `true` will style the component using its error theme.

</PropertyDef>

<PropertyDef name="required" type="boolean" defaultValue="false">

Gets/sets whether this component is marked as required or not. Setting to `true` will display an asterisk in the label.

</PropertyDef>

<PropertyDef name="density" type="SelectDensityType" defaultValue="&quot;default&quot;">

Controls the density type. Valid values: `default`, `roomy`, `dense`.

> **Note:** Use `roomy` for mobile, and do not use the `label` attribute with the `dense` type.

</PropertyDef>

<PropertyDef name="floatLabelType" type="SelectFloatLabelType" defaultValue="&quot;auto&quot;">

The type of floating label to use. Valid values: `auto` (default), `always`.

</PropertyDef>

<PropertyDef name="placeholder" type="string" defaultValue="undefined">

Gets/sets the placeholder text for when no values are selected. This only applies when no label is provided.

</PropertyDef>

<PropertyDef name="popupClasses" type="string | string[]" defaultValue="[]">

Gets/sets the list of classes to apply to the popup element.

</PropertyDef>

<PropertyDef name="popupHeaderBuilder" type="ListDropdownHeaderBuilder" defaultValue="undefined">

Gets/sets the callback function for generating header content within the popup.

</PropertyDef>

<PropertyDef name="popupFooterBuilder" type="ListDropdownFooterBuilder" defaultValue="undefined">

Gets/sets the callback function for generating footer content within the popup.

</PropertyDef>

<PropertyDef name="syncPopupWidth" type="boolean" defaultValue="false">

Gets/sets whether the popup width is synchronized with the popup target width.

</PropertyDef>

<PropertyDef name="constrainPopupWidth" type="boolean" defaultValue="true">

Gets/sets whether the popup width will be constrained to a max width of the viewport width (default: `100vw`).

</PropertyDef>

<PropertyDef name="wrapOptionText" type="boolean" defaultValue="false">

Gets/sets whether the options will wrap their text or not.

This only applies if `constrainPopupWidth` is `true`, if there is an explicit width set via CSS.

</PropertyDef>

</PageSection>

---

<PageSection>

## Methods

<MethodDef name="appendOptions(options: ISelectOption[] | ISelectOptionGroup[]): void">

Adds additional options to the end of the select options.

</MethodDef>

<MethodDef name="selectAll(): void">

Selects all options.

</MethodDef>

<MethodDef name="deselectAll(): void">

Deselects all options.

</MethodDef>

<MethodDef name="focus(): void">

Sets focus to the internal button element.

</MethodDef>

</PageSection>

---

<PageSection>

## Events

| Name                                    | Values
| :---------------------------------------| :-----------------
| `change`                                | Emits when the user chooses a different value. This is a `CustomEvent` that contains the selected value in the events' `detail` property.
| `forge-select-scrolled-bottom`            | Emits when the user scrolls to the bottom of the options.

</PageSection>

<PageSection>

## Keyboard shortcuts

| Name                                | Description
| :-----------------------------------| :----------------
| **Select Opened**                   |
| `escape / space`                    | Closes the select.
| `tab / enter`                       | Selects the focused option and closes the select.
| `arrow down`                        | Highlights the next option if an option is selected, otherwise highlights the first option.
| `arrow up`                          | Highlights the previous option if an option is selected, otherwise highlights the first option.
| `home`                              | Highlights the first option that is not disabled.
| `end`                               | Highlights the last option that is not disabled.
| **Select Closed**                   |
| `space / enter`                     | Opens the select.
| `arrow down`                        | Selects the next option if an option is selected, otherwise selects the first option.
| `arrow up`                          | Selects the previous option if an option is selected, otherwise selects the first option.
| **Select Closed and Multiple**      |
| `arrow down / arrow up`             | Opens the select and selects the first option

</PageSection>

<PageSection>

## Slots

| Name                 | Values
| :--------------------| :-----------------
| `leading`            | Places content such as icons before the text.
| `addon-end`          | Places content such as icon buttons after the text with a divider.
| `helper-text`        | Places content below the component with the proper typography.

</PageSection>

<PageSection>

## CSS parts

| Name                                    | Description
| :---------------------------------------| :----------------
| `root`                                  | The root element.
| `container`                             | The layout container element.
| `leading-container`                     | The container element around the `leading` slot.
| `label-input-container`                 | The container element around the selected text and label elements.
| `text`                                  | The selected text element.
| `label`                                 | The `<label>` element.
| `icon`                                  | The dropdown icon `<forge-icon>` element.
| `addon-end-container`                   | The container element around the `addon-end` slot.

</PageSection>

<PageSection>

## CSS custom properties

| Name                                                      | Description
| :---------------------------------------------------------| :----------------
| **Field**                                                 |
| `--forge-theme-form-field-disabled-on-background`         | Controls the disabled background-color of the field element.
| `--forge-select-height`                                   | Controls the height of the field element. Default value is `3.5rem`.
| `--forge-select-margin-top`                               | Controls the margin-top of the field element. Default value is `0`.
| **Outline**                                               |
| `--forge-select-theme-background`                         | Controls the background-color of the outline element.
| `--forge-theme-form-field-disabled-on-background`         | Controls the disabled background-color of the outline element.
| `--mdc-theme-text-icon-on-background`                     | Controls the border-color of the outline element.
| `--mdc-theme-text-primary-on-background`                  | Controls the hover border-color for the outline element.
| `--mdc-theme-primary`                                     | Controls the focused and focused-hover border-color for the outline element.
| `--mdc-theme-error`                                       | Controls the invalid border-color for the outline element.
| `--forge-theme-error-hover`                               | Controls the invalid-hover border-color for the outline element.
| `--mdc-theme-text-disabled-on-background`                 | Controls the disabled border-color of the outline element.
| **Label**                                                 |
| `--forge-theme-form-field-label-on-background`            | Controls the color of the label element.
| `--mdc-theme-primary`                                     | Controls the focused color of the label element.
| `--mdc-theme-error`                                       | Controls the invalid color of the label element.
| `--forge-theme-label-disabled-on-background`              | Controls the disabled color of the label element.
| **Required Asterisk**                                     |
| `--mdc-theme-error`                                       | Controls the error color for the required asterisk element.
| **Floating Label**                                        |
| `--forge-theme-form-field-label-on-background`            | Controls the color of the floating label element.
| `--mdc-theme-primary`                                     | Controls the focused color of the floating label element.
| `--mdc-theme-error`                                       | Controls the invalid color of the floating label element.
| `--forge-theme-form-field-text-disabled-on-background`    | Controls the disabled color of the floating label element.
| **Selected Text**                                                 |
| `--forge-select-font-size`                                | Controls the font-size of the selected text element. Default value is `1rem`.
| `--mdc-theme-text-primary-on-background`                  | Controls the color of the selected text element.
| `--forge-theme-form-field-text-disabled-on-background`    | Controls the disabled color of the selected text element.
| **Helper Text**                                           |
| `--mdc-theme-text-secondary-on-background`                | Controls the color of the helper text element.
| `--mdc-theme-error`                                       | Controls the invalid color of the helper text element.
| **Icons**                                                 |
| `--mdc-theme-text-secondary-on-background`                | Controls the color for the icon elements.
| `--mdc-theme-error`                                       | Controls the invalid color of the icon elements.
| `--mdc-theme-text-disabled-on-light`                      | Controls the disabled color of the icon elements.
| **Placeholder**                                           |
| `--mdc-theme-text-secondary-on-background`                | Controls the color of the placeholder element.

> **Note:** To hide the border, add the following CSS declaration: `--forge-select-border-display: none;`

</PageSection>

<PageSection>

## Accessibility

- Ensure that all of the controls that are accessible by mouse are also accessible by keyboard.
  - Ensure the controls are reachable by the tab key.
  - Ensure each control can be updated or activated by the keyboard.
- Verify that the select list can be toggled open or closed by pressing the space or enter key.
- Verify that each active item in the select list can be reached by the up-arrow and down-arrow keys.
- Verify that in multiple-select mode, the Enter key can toggle an item as selected or un-selected.

</PageSection>

---

<PageSection>

## Types

### IOption

```ts
interface IOption<T = any> {
  value: T;
  label: string;
  disabled?: boolean;
  divider?: boolean;
  optionClass?: string | string[];
  leadingIcon?: string;
  leadingIconClass?: string;
  leadingIconType?: ListDropdownIconType;
  trailingIcon?: string;
  trailingIconClass?: string;
  trailingIconType?: ListDropdownIconType;
  leadingBuilder?: () => HTMLElement;
  trailingBuilder?: () => HTMLElement;
  options?: Array<IListDropdownOption | IListDropdownOptionGroup>;
  elementAttributes?: Map<string, string>;
}
```

### IOptionGroup

```ts
interface IOptionGroup {
  options: IListDropdownOption[];
  text?: string;
  builder?: ListDropdownOptionGroupBuilder;
}
```

### ListDropdownOptionBuilder

```ts
type ListDropdownOptionBuilder<T = HTMLElement> = (option: IListDropdownOption, parentElement: T) => HTMLElement | string | void;
```

### ListDropdownIconType

```ts
export type ListDropdownIconType = 'font' | 'component';
```

### SelectDensityType

```ts
type SelectDensityType = 'default' | 'roomy' | 'dense';
```

### SelectFloatLabelType

```ts
type SelectFloatLabelType = 'default' | 'always';
```

### SelectBeforeValueChangeCallback

```ts
type SelectBeforeValueChangeCallback<T> = (value: T | T[]) => boolean | Promise<boolean>;
```

### ListDropdownHeaderBuilder

```ts
type ListDropdownHeaderBuilder = () => HTMLElement;
```

### ListDropdownFooterBuilder

```ts
type ListDropdownFooterBuilder = () => HTMLElement;
```

</PageSection>
