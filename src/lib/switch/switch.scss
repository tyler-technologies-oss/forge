@use './core';
@use './configuration';
@use '../core/styles/tokens/switch/tokens';
@use '../focus-indicator';
@use '../state-layer';

:host {
  @include core.host;
}

:host([hidden]) {
  display: none;
}

:host([disabled]) {
  @include core.host-disabled;

  .forge-switch {
    pointer-events: none;
  }

  .handle::before {
    box-shadow: none;
  }
}

/// Base styles (defaults to off)
.forge-switch {
  @include configuration.configuration;
  @include core.switch;

  --_current-state-layer-width: var(--_state-layer-width);
  --_current-state-layer-height: var(--_state-layer-height);

  .container {
    @include core.container;
  }

  .input {
    @include core.input;

    /// On styles
    &:checked ~ {
      .track {
        @include core.track-on;
      }
  
      .handle {
        @include core.handle-on;

        .icon {
          &__on {
            @include core.icon-on-shown;
          }
    
          &__off {
            @include core.icon-hidden;
          }
        }

        forge-state-layer {
          @include state-layer.provide-theme((
            color: var(--_state-layer-on-color)
          ));
        }
      }
    }

    /// Active styles
    &:active {
      ~ {
        .track {
          @include core.track-active;
        }

        .handle {
          @include core.handle-active;

          .icon {
            @include core.icon-active;
          }
        }
      }

      /// Active on styles
      &:checked ~ {
        .track {
          @include core.track-active-on;
        }

        .handle {
          @include core.handle-active-on;

          .icon {
            @include core.icon-active-on;
          }
        }
      }
    }
  }

  .track {
    @include core.track;
  }

  .handle {
    @include core.handle;
  }

  .icon {
    @include core.icon;

    &__on {
      @include core.icon-on;
      @include core.icon-hidden;
    }

    &__off {
      @include core.icon-off-shown;
    }
  }

  .label {
    @include core.label;
  }

  .hidden {
    display: none;
  }
}

/// Dense styles
:host([dense]) {
  .forge-switch {
    // Set the state layer width and height for use in calculations of other properties
    --_current-state-layer-width: var(--_state-layer-dense-width);
    --_current-state-layer-height: var(--_state-layer-dense-height);
  }
}

/// Reduced motion styles
@media (prefers-reduced-motion) {
  .switch {
    --_animation-duration: 0s;
  }
}

forge-state-layer {
  @include state-layer.provide-theme((
    color: var(--_state-layer-off-color)
  ));
}

/* stylelint-disable length-zero-no-unit */
forge-focus-indicator {
  @include focus-indicator.provide-theme((
    shape: var(--_track-shape),
    outward-offset: 0px
  ));
}
/* stylelint-enable length-zero-no-unit */
