@use '../core/styles/theme';
@use './animations';
@use './configuration';
@use './core';
@use './token-utils' as *;

//
// Host styles
//

:host {
  @include configuration.host-configuration;
}

:host {
  @include core.container;
}

:host([hidden]) {
  display: none;
}

//
// Base
//

.forge-linear-progress {
  @include configuration.configuration;
}

.forge-linear-progress {
  @include core.progress;
}

.forge-linear-progress,
.track,
.buffer-bar,
.bar,
.bar-inner {
  position: absolute;
}

.bar {
  @include core.bar;
}

.secondary-bar {
  @include core.secondary-bar;
}

.bar-inner {
  @include core.bar-inner;
}

.buffer-bar {
  @include core.buffer-bar;
}

.track {
  @include core.track;
}

/// Indeterminate styles
.forge-linear-progress--indeterminate {
  .bar {
    @include core.indeterminate-bar;
  }

  .primary-bar {
    @include core.indeterminate-primary-bar;
  }

  .secondary-bar {
    @include core.indeterminate-secondary-bar;
  }

  .track {
    @include core.indeterminate-track;
  }

  .primary-bar > .bar-inner {
    @include core.indeterminate-primary-bar-inner;
  }

  .secondary-bar > .bar-inner {
    @include core.indeterminate-secondary-bar-inner;
  }
}

/// RTL styles
$rtl-selectors: (
  ':host-context([dir="rtl"]) .forge-linear-progress',
  ':host([dir="rtl"]) .forge-linear-progress',
  '.forge-linear-progress:dir(rtl)'
);

@each $selector in $rtl-selectors {
  #{$selector} {
    .bar {
      transform-origin: right center;
    }

    .buffer-bar {
      transform-origin: right center;
    }

    .track {
      animation-name: buffering-rtl;
    }

    &.forge-linear-progress--indeterminate .primary-bar {
      animation-name: primary-indeterminate-translate-rtl;
    }

    &.forge-linear-progress--indeterminate .secondary-bar {
      animation-name: secondary-indeterminate-translate-rtl;
    }
  }
}

//
// Theme
//

@mixin theme($theme) {
  :host([theme=#{$theme}]) {
    .forge-linear-progress {
      @include override(indicator-color, theme.variable($theme), value);
      @include override(track-color, theme.variable(#{$theme}-container), value);
    }
  }
}

@include theme(primary);
@include theme(secondary);
@include theme(success);
@include theme(error);
@include theme(warning);
@include theme(info);

@media screen and (forced-colors: active) {
  .forge-linear-progress {
    @include override(indicator-color, CanvasText, value);
    @include override(track-color, GrayText, value);

    border: 1px solid CanvasText;

    &.forge-linear-progress--indeterminate {
      @include override(track-color, Canvas, value);
    }
  }
}

@include animations.keyframes;
